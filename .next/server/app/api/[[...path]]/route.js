/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/[[...path]]/route";
exports.ids = ["app/api/[[...path]]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("pg");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?4c03":
/*!***********************!*\
  !*** debug (ignored) ***!
  \***********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mohitwadhwa_Downloads_writers_pocket_source_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/[[...path]]/route.js */ \"(rsc)/./app/api/[[...path]]/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/[[...path]]/route\",\n        pathname: \"/api/[[...path]]\",\n        filename: \"route\",\n        bundlePath: \"app/api/[[...path]]/route\"\n    },\n    resolvedPagePath: \"/Users/mohitwadhwa/Downloads/writers-pocket-source/app/api/[[...path]]/route.js\",\n    nextConfigOutput,\n    userland: _Users_mohitwadhwa_Downloads_writers_pocket_source_app_api_path_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/[[...path]]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmcGFnZT0lMkZhcGklMkYlNUIlNUIuLi5wYXRoJTVEJTVEJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGJTVCJTVCLi4ucGF0aCU1RCU1RCUyRnJvdXRlLmpzJmFwcERpcj0lMkZVc2VycyUyRm1vaGl0d2FkaHdhJTJGRG93bmxvYWRzJTJGd3JpdGVycy1wb2NrZXQtc291cmNlJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRm1vaGl0d2FkaHdhJTJGRG93bmxvYWRzJTJGd3JpdGVycy1wb2NrZXQtc291cmNlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDK0I7QUFDNUc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtbW9uZ28tdGVtcGxhdGUvPzc1OTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL21vaGl0d2FkaHdhL0Rvd25sb2Fkcy93cml0ZXJzLXBvY2tldC1zb3VyY2UvYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qc1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJzdGFuZGFsb25lXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL1tbLi4ucGF0aF1dL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvW1suLi5wYXRoXV1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL1tbLi4ucGF0aF1dL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL21vaGl0d2FkaHdhL0Rvd25sb2Fkcy93cml0ZXJzLXBvY2tldC1zb3VyY2UvYXBwL2FwaS9bWy4uLnBhdGhdXS9yb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvW1suLi5wYXRoXV0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/[[...path]]/route.js":
/*!**************************************!*\
  !*** ./app/api/[[...path]]/route.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.js\");\n/* harmony import */ var _lib_razorpay__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/razorpay */ \"(rsc)/./lib/razorpay.js\");\n/* harmony import */ var _lib_site_settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/site-settings */ \"(rsc)/./lib/site-settings.js\");\n/* harmony import */ var _lib_google_sheets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/google-sheets */ \"(rsc)/./lib/google-sheets.js\");\n/* harmony import */ var _lib_identity__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/lib/identity */ \"(rsc)/./lib/identity.js\");\n// Writer's Pocket - Main API Routes\n\n\n\n\n\n\n\n\n\n// Helper: Get current session\nasync function getSession(request) {\n    // Simple JWT extraction from Authorization header for API calls\n    const authHeader = request.headers.get(\"authorization\");\n    if (authHeader?.startsWith(\"Bearer \")) {\n    // For API calls, we'll verify the session differently\n    // This is a simplified version - in production use proper JWT verification\n    }\n    return null;\n}\n// Helper: Check role authorization\nfunction checkRole(userRole, allowedRoles) {\n    return allowedRoles.includes(userRole);\n}\n// Helper: Generate order number\nfunction generateOrderNumber() {\n    const timestamp = Date.now().toString(36).toUpperCase();\n    const random = Math.random().toString(36).substring(2, 6).toUpperCase();\n    return `WP-${timestamp}-${random}`;\n}\n// Define publishing stages\nconst PUBLISHING_STAGES = [\n    {\n        type: \"MANUSCRIPT_RECEIVED\",\n        order: 1\n    },\n    {\n        type: \"INITIAL_REVIEW\",\n        order: 2\n    },\n    {\n        type: \"EDITING\",\n        order: 3\n    },\n    {\n        type: \"PROOFREADING\",\n        order: 4\n    },\n    {\n        type: \"COVER_DESIGN\",\n        order: 5\n    },\n    {\n        type: \"INTERIOR_FORMATTING\",\n        order: 6\n    },\n    {\n        type: \"FINAL_REVIEW\",\n        order: 7\n    },\n    {\n        type: \"ISBN_ASSIGNMENT\",\n        order: 8\n    },\n    {\n        type: \"PRINTING\",\n        order: 9\n    },\n    {\n        type: \"DISTRIBUTION\",\n        order: 10\n    },\n    {\n        type: \"COMPLETED\",\n        order: 11\n    }\n];\nasync function GET(request, context) {\n    const params = await context.params;\n    const pathSegments = params?.path || [];\n    const path = \"/\" + pathSegments.join(\"/\");\n    try {\n        // Health check\n        if (path === \"/health\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                status: \"healthy\",\n                timestamp: new Date().toISOString(),\n                database: \"postgresql\",\n                razorpay: (0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.isRazorpayConfigured)() ? \"configured\" : \"not_configured\"\n            });\n        }\n        // Get all books (public)\n        if (path === \"/books\") {\n            const { searchParams } = new URL(request.url);\n            const isPublic = searchParams.get(\"public\") === \"true\";\n            const authorId = searchParams.get(\"authorId\");\n            const where = {};\n            if (isPublic) {\n                where.isPublic = true;\n                where.isAuthorCopy = false;\n            }\n            if (authorId) {\n                where.authorId = authorId;\n            }\n            const books = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                where,\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            publicUrl: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                books\n            });\n        }\n        // Get single book\n        if (path.startsWith(\"/books/\") && pathSegments.length === 2) {\n            const bookId = pathSegments[1];\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                where: {\n                    id: bookId\n                },\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            publicUrl: true,\n                            bio: true\n                        }\n                    },\n                    publishingStages: {\n                        orderBy: {\n                            stageOrder: \"asc\"\n                        },\n                        include: {\n                            files: true\n                        }\n                    },\n                    manuscripts: {\n                        orderBy: {\n                            version: \"desc\"\n                        }\n                    }\n                }\n            });\n            if (!book) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Book not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book\n            });\n        }\n        // Get author's books with full details\n        if (path === \"/author/books\") {\n            const { searchParams } = new URL(request.url);\n            const authorId = searchParams.get(\"authorId\") || request.headers.get(\"x-user-id\");\n            if (!authorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const books = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                where: {\n                    authorId\n                },\n                include: {\n                    publishingStages: {\n                        orderBy: {\n                            stageOrder: \"asc\"\n                        }\n                    },\n                    manuscripts: {\n                        orderBy: {\n                            version: \"desc\"\n                        },\n                        take: 1\n                    },\n                    externalLinks: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                books\n            });\n        }\n        // Get author's sales analytics\n        if (path === \"/author/analytics\") {\n            const { searchParams } = new URL(request.url);\n            const authorId = searchParams.get(\"authorId\");\n            if (!authorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Daily sales (last 30 days)\n            const thirtyDaysAgo = new Date();\n            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n            const royalties = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.findMany({\n                where: {\n                    authorId,\n                    createdAt: {\n                        gte: thirtyDaysAgo\n                    }\n                },\n                include: {\n                    book: {\n                        select: {\n                            title: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            // Monthly summary\n            const monthlySummary = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.groupBy({\n                by: [\n                    \"period\"\n                ],\n                where: {\n                    authorId\n                },\n                _sum: {\n                    amount: true,\n                    saleAmount: true\n                },\n                _count: true\n            });\n            // Total unpaid royalties\n            const unpaidRoyalties = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                where: {\n                    authorId,\n                    isPaid: false\n                },\n                _sum: {\n                    amount: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                recentRoyalties: royalties,\n                monthlySummary,\n                unpaidTotal: unpaidRoyalties._sum.amount || 0\n            });\n        }\n        // Get author's orders\n        if (path === \"/author/orders\") {\n            const { searchParams } = new URL(request.url);\n            const authorId = searchParams.get(\"authorId\");\n            if (!authorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const orders = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.findMany({\n                where: {\n                    userId: authorId\n                },\n                include: {\n                    items: {\n                        include: {\n                            book: {\n                                select: {\n                                    title: true,\n                                    coverImage: true\n                                }\n                            }\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                orders\n            });\n        }\n        // Get queries for author\n        if (path === \"/author/queries\") {\n            const { searchParams } = new URL(request.url);\n            const authorId = searchParams.get(\"authorId\");\n            if (!authorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const queries = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.findMany({\n                where: {\n                    authorId\n                },\n                include: {\n                    book: {\n                        select: {\n                            title: true\n                        }\n                    },\n                    stage: {\n                        select: {\n                            stageType: true\n                        }\n                    },\n                    comments: {\n                        orderBy: {\n                            createdAt: \"asc\"\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                queries\n            });\n        }\n        // Get notifications\n        if (path === \"/notifications\") {\n            const { searchParams } = new URL(request.url);\n            const userId = searchParams.get(\"userId\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const notifications = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.findMany({\n                where: {\n                    userId\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                take: 50\n            });\n            const unreadCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.count({\n                where: {\n                    userId,\n                    isRead: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                notifications,\n                unreadCount\n            });\n        }\n        // Get user profile\n        if (path === \"/profile\") {\n            const { searchParams } = new URL(request.url);\n            const userId = searchParams.get(\"userId\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    id: userId\n                },\n                select: {\n                    id: true,\n                    email: true,\n                    name: true,\n                    phone: true,\n                    role: true,\n                    profileImage: true,\n                    bio: true,\n                    website: true,\n                    socialLinks: true,\n                    publicUrl: true,\n                    createdAt: true\n                }\n            });\n            const bankDetails = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bankDetails.findUnique({\n                where: {\n                    userId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user,\n                bankDetails\n            });\n        }\n        // Public author profile\n        if (path.startsWith(\"/authors/\") && pathSegments.length === 2) {\n            const publicUrl = pathSegments[1];\n            const author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    publicUrl\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    bio: true,\n                    profileImage: true,\n                    website: true,\n                    socialLinks: true,\n                    publicUrl: true,\n                    books: {\n                        where: {\n                            isPublic: true\n                        },\n                        select: {\n                            id: true,\n                            title: true,\n                            coverImage: true,\n                            description: true,\n                            price: true\n                        }\n                    }\n                }\n            });\n            if (!author) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                author\n            });\n        }\n        // GET /api/store/books - Get all publicly listed books for the store\n        if (path === \"/store/books\") {\n            const books = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                where: {\n                    isPublic: true,\n                    status: \"PUBLISHED\"\n                },\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    }\n                },\n                orderBy: {\n                    publishedDate: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                books\n            });\n        }\n        // GET /api/store/books/[id] - Get single book for store\n        if (path.startsWith(\"/store/books/\") && pathSegments.length === 3) {\n            const bookId = pathSegments[2];\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                where: {\n                    id: bookId\n                },\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            publicUrl: true\n                        }\n                    }\n                }\n            });\n            if (!book || !book.isPublic) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Book not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book\n            });\n        }\n        // Admin: Get all users\n        // Admin: Get all books with stages\n        if (path === \"/admin/books\") {\n            const books = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true,\n                            authorUid: true\n                        }\n                    },\n                    publishingStages: {\n                        orderBy: {\n                            stageOrder: \"asc\"\n                        },\n                        include: {\n                            assignedTo: {\n                                select: {\n                                    name: true\n                                }\n                            }\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                books\n            });\n        }\n        // GET /api/admin/books/[id] - Get single book with full project details\n        if (path.startsWith(\"/admin/books/\") && pathSegments.length === 3 && !path.includes(\"/stages\")) {\n            const bookId = pathSegments[2];\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                where: {\n                    id: bookId\n                },\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true,\n                            phone: true,\n                            authorUid: true,\n                            createdAt: true\n                        }\n                    },\n                    publishingStages: {\n                        orderBy: {\n                            stageOrder: \"asc\"\n                        },\n                        include: {\n                            assignedTo: {\n                                select: {\n                                    id: true,\n                                    name: true,\n                                    email: true\n                                }\n                            },\n                            history: {\n                                orderBy: {\n                                    createdAt: \"desc\"\n                                },\n                                take: 10,\n                                include: {\n                                    changedBy: {\n                                        select: {\n                                            id: true,\n                                            name: true\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    },\n                    queries: {\n                        orderBy: {\n                            createdAt: \"desc\"\n                        },\n                        take: 10,\n                        include: {\n                            author: {\n                                select: {\n                                    name: true\n                                }\n                            },\n                            assignedTo: {\n                                select: {\n                                    name: true\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            if (!book) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Book not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Calculate ISBN status\n            const isbnStatus = book.isbnPaperback ? \"ALLOTTED\" : \"PENDING\";\n            // Calculate overall progress\n            const totalStages = book.publishingStages.length;\n            const completedStages = book.publishingStages.filter((s)=>s.status === \"COMPLETED\" || s.status === \"APPROVED\").length;\n            const progressPercent = totalStages > 0 ? Math.round(completedStages / totalStages * 100) : 0;\n            // Get current stage\n            const currentStage = book.publishingStages.find((s)=>s.status === \"IN_PROGRESS\" || s.status === \"AWAITING_APPROVAL\") || book.publishingStages.find((s)=>s.status === \"PENDING\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book,\n                meta: {\n                    isbnStatus,\n                    progressPercent,\n                    completedStages,\n                    totalStages,\n                    currentStage: currentStage?.stageType || null\n                }\n            });\n        }\n        // GET /api/admin/team - Get team members for assignment\n        if (path === \"/admin/team\") {\n            const team = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findMany({\n                where: {\n                    role: {\n                        in: [\n                            \"ADMIN\",\n                            \"TEAM\"\n                        ]\n                    },\n                    isActive: true\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    role: true\n                },\n                orderBy: {\n                    name: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                team\n            });\n        }\n        // GET /api/admin/stage-templates - Get all stage templates\n        if (path === \"/admin/stage-templates\") {\n            let templates = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.findMany({\n                orderBy: {\n                    sortOrder: \"asc\"\n                }\n            });\n            // If no templates exist, create defaults (all OFF except INITIAL_REVIEW)\n            if (templates.length === 0) {\n                const defaultStages = [\n                    {\n                        stageType: \"MANUSCRIPT_RECEIVED\",\n                        name: \"Manuscript Received\",\n                        sortOrder: 1,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"INITIAL_REVIEW\",\n                        name: \"Initial Review\",\n                        sortOrder: 2,\n                        isDefault: true\n                    },\n                    {\n                        stageType: \"EDITING\",\n                        name: \"Editing\",\n                        sortOrder: 3,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"PROOFREADING\",\n                        name: \"Proofreading\",\n                        sortOrder: 4,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"COVER_DESIGN\",\n                        name: \"Cover Design\",\n                        sortOrder: 5,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"INTERIOR_FORMATTING\",\n                        name: \"Interior Formatting\",\n                        sortOrder: 6,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"FINAL_REVIEW\",\n                        name: \"Final Review\",\n                        sortOrder: 7,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"ISBN_ASSIGNMENT\",\n                        name: \"ISBN Assignment\",\n                        sortOrder: 8,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"PRINTING\",\n                        name: \"Printing\",\n                        sortOrder: 9,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"DISTRIBUTION\",\n                        name: \"Distribution\",\n                        sortOrder: 10,\n                        isDefault: false\n                    },\n                    {\n                        stageType: \"COMPLETED\",\n                        name: \"Completed\",\n                        sortOrder: 11,\n                        isDefault: false\n                    }\n                ];\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.createMany({\n                    data: defaultStages\n                });\n                templates = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.findMany({\n                    orderBy: {\n                        sortOrder: \"asc\"\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                templates\n            });\n        }\n        // Admin: Get all queries\n        if (path === \"/admin/queries\") {\n            const queries = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.findMany({\n                include: {\n                    author: {\n                        select: {\n                            name: true,\n                            email: true\n                        }\n                    },\n                    book: {\n                        select: {\n                            title: true\n                        }\n                    },\n                    assignedTo: {\n                        select: {\n                            name: true\n                        }\n                    },\n                    comments: {\n                        orderBy: {\n                            createdAt: \"asc\"\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                queries\n            });\n        }\n        // Admin: Get CRM leads\n        if (path === \"/admin/leads\") {\n            const url = new URL(request.url);\n            const statusFilter = url.searchParams.get(\"status\");\n            const dateFrom = url.searchParams.get(\"dateFrom\");\n            const dateTo = url.searchParams.get(\"dateTo\");\n            const assignedToId = url.searchParams.get(\"assignedToId\");\n            const where = {};\n            // Status filter (Converted, Lost, Open)\n            if (statusFilter && statusFilter !== \"all\") {\n                if (statusFilter === \"OPEN\") {\n                    where.status = {\n                        notIn: [\n                            \"CONVERTED\",\n                            \"LOST\"\n                        ]\n                    };\n                } else {\n                    where.status = statusFilter;\n                }\n            }\n            // Date range filter\n            if (dateFrom || dateTo) {\n                where.createdAt = {};\n                if (dateFrom) where.createdAt.gte = new Date(dateFrom);\n                if (dateTo) where.createdAt.lte = new Date(dateTo + \"T23:59:59\");\n            }\n            // Assigned to filter\n            if (assignedToId && assignedToId !== \"all\") {\n                where.assignedToId = assignedToId;\n            }\n            const leads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.findMany({\n                where,\n                include: {\n                    assignedTo: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    },\n                    activities: {\n                        orderBy: {\n                            createdAt: \"desc\"\n                        },\n                        take: 5\n                    },\n                    notes: {\n                        orderBy: {\n                            createdAt: \"desc\"\n                        }\n                    },\n                    stageHistory: {\n                        orderBy: {\n                            movedAt: \"desc\"\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            // Map status to stage for frontend compatibility\n            const mappedLeads = leads.map((lead)=>({\n                    ...lead,\n                    stage: lead.status\n                }));\n            // Calculate summary\n            const allLeads = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.findMany();\n            const summary = {\n                total: allLeads.length,\n                new: allLeads.filter((l)=>l.status === \"NEW\").length,\n                contacted: allLeads.filter((l)=>l.status === \"CONTACTED\").length,\n                interested: allLeads.filter((l)=>l.status === \"INTERESTED\").length,\n                negotiating: allLeads.filter((l)=>l.status === \"NEGOTIATING\").length,\n                converted: allLeads.filter((l)=>l.status === \"CONVERTED\").length,\n                lost: allLeads.filter((l)=>l.status === \"LOST\").length\n            };\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                leads: mappedLeads,\n                summary\n            });\n        }\n        // GET /api/admin/lead-stages - Get custom lead stages\n        if (path === \"/admin/lead-stages\") {\n            const stagesSetting = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteSetting.findUnique({\n                where: {\n                    key: \"leadStages\"\n                }\n            });\n            const defaultStages = [\n                {\n                    id: \"NEW\",\n                    name: \"New\",\n                    color: \"blue\"\n                },\n                {\n                    id: \"CONTACTED\",\n                    name: \"Contacted\",\n                    color: \"yellow\"\n                },\n                {\n                    id: \"INTERESTED\",\n                    name: \"Interested\",\n                    color: \"green\"\n                },\n                {\n                    id: \"NEGOTIATING\",\n                    name: \"Negotiating\",\n                    color: \"purple\"\n                },\n                {\n                    id: \"CONVERTED\",\n                    name: \"Converted\",\n                    color: \"emerald\"\n                },\n                {\n                    id: \"LOST\",\n                    name: \"Lost\",\n                    color: \"red\"\n                }\n            ];\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stages: stagesSetting?.value || defaultStages\n            });\n        }\n        // GET /api/admin/notifications - Get all notifications sent\n        if (path === \"/admin/notifications\") {\n            const notifications = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.findMany({\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                take: 100,\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            name: true,\n                            authorUid: true\n                        }\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                notifications\n            });\n        }\n        // GET /api/admin/site-settings - Get all site settings\n        if (path === \"/admin/site-settings\") {\n            const allSettings = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteSetting.findMany();\n            const settings = {};\n            for (const s of allSettings){\n                settings[s.key] = s.value;\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                settings\n            });\n        }\n        // Admin: Get all categories (with book count)\n        if (path === \"/admin/categories\") {\n            const categories = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].category.findMany({\n                orderBy: {\n                    sortOrder: \"asc\"\n                },\n                include: {\n                    children: {\n                        orderBy: {\n                            sortOrder: \"asc\"\n                        },\n                        include: {\n                            _count: {\n                                select: {\n                                    books: true\n                                }\n                            }\n                        }\n                    },\n                    _count: {\n                        select: {\n                            books: true\n                        }\n                    }\n                }\n            });\n            const topLevel = categories.filter((c)=>!c.parentId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                categories: topLevel\n            });\n        }\n        // Admin: Dashboard stats\n        if (path === \"/admin/stats\") {\n            const [totalBooks, totalAuthors, totalOrders, pendingQueries, newLeads] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.count(),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.count({\n                    where: {\n                        role: \"AUTHOR\"\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.count({\n                    where: {\n                        status: \"PAID\"\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.count({\n                    where: {\n                        status: {\n                            in: [\n                                \"OPEN\",\n                                \"IN_PROGRESS\"\n                            ]\n                        }\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.count({\n                    where: {\n                        status: \"NEW\"\n                    }\n                })\n            ]);\n            // Books by status\n            const booksByStatus = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.groupBy({\n                by: [\n                    \"status\"\n                ],\n                _count: true\n            });\n            // Recent orders\n            const recentOrders = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.findMany({\n                take: 10,\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                include: {\n                    user: {\n                        select: {\n                            name: true\n                        }\n                    },\n                    items: {\n                        select: {\n                            book: {\n                                select: {\n                                    title: true\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                totalBooks,\n                totalAuthors,\n                totalOrders,\n                pendingQueries,\n                newLeads,\n                booksByStatus,\n                recentOrders\n            });\n        }\n        // ==================== ADMIN USERS API ====================\n        // GET /api/admin/users - List all users with filters\n        if (path === \"/admin/users\") {\n            const url = new URL(request.url);\n            const role = url.searchParams.get(\"role\");\n            const search = url.searchParams.get(\"search\");\n            const page = parseInt(url.searchParams.get(\"page\") || \"1\");\n            const limit = parseInt(url.searchParams.get(\"limit\") || \"50\");\n            const skip = (page - 1) * limit;\n            const where = {};\n            if (role && role !== \"all\") where.role = role;\n            if (search) {\n                where.OR = [\n                    {\n                        name: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        email: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        authorUid: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    }\n                ];\n            }\n            const [users, total] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findMany({\n                    where,\n                    skip,\n                    take: limit,\n                    orderBy: {\n                        createdAt: \"desc\"\n                    },\n                    select: {\n                        id: true,\n                        authorUid: true,\n                        email: true,\n                        name: true,\n                        phone: true,\n                        role: true,\n                        isActive: true,\n                        isBlogWriter: true,\n                        importSource: true,\n                        createdAt: true,\n                        _count: {\n                            select: {\n                                books: true,\n                                bookAuthorships: true,\n                                royalties: true\n                            }\n                        }\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.count({\n                    where\n                })\n            ]);\n            // Calculate total royalties per user\n            const usersWithRoyalties = await Promise.all(users.map(async (user)=>{\n                const royaltyAgg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                    where: {\n                        authorId: user.id\n                    },\n                    _sum: {\n                        amount: true\n                    }\n                });\n                const paidAgg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                    where: {\n                        authorId: user.id,\n                        isPaid: true\n                    },\n                    _sum: {\n                        amount: true\n                    }\n                });\n                return {\n                    ...user,\n                    totalRoyalty: royaltyAgg._sum.amount || 0,\n                    paidRoyalty: paidAgg._sum.amount || 0,\n                    unpaidRoyalty: (royaltyAgg._sum.amount || 0) - (paidAgg._sum.amount || 0)\n                };\n            }));\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                users: usersWithRoyalties,\n                pagination: {\n                    page,\n                    limit,\n                    total,\n                    totalPages: Math.ceil(total / limit)\n                }\n            });\n        }\n        // GET /api/admin/users/[id] - Single user details\n        if (path.startsWith(\"/admin/users/\") && pathSegments.length === 3 && pathSegments[2] !== \"import\") {\n            const userId = pathSegments[2];\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    id: userId\n                },\n                include: {\n                    books: {\n                        select: {\n                            id: true,\n                            title: true,\n                            status: true,\n                            isbnPaperback: true\n                        }\n                    },\n                    bookAuthorships: {\n                        include: {\n                            book: {\n                                select: {\n                                    id: true,\n                                    title: true,\n                                    status: true,\n                                    isbnPaperback: true\n                                }\n                            }\n                        }\n                    },\n                    royalties: {\n                        orderBy: {\n                            createdAt: \"desc\"\n                        },\n                        take: 20,\n                        include: {\n                            book: {\n                                select: {\n                                    id: true,\n                                    title: true\n                                }\n                            }\n                        }\n                    },\n                    bankDetails: true\n                }\n            });\n            if (!user) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Calculate royalty summary\n            const royaltyAgg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                where: {\n                    authorId: userId\n                },\n                _sum: {\n                    amount: true\n                }\n            });\n            const paidAgg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                where: {\n                    authorId: userId,\n                    isPaid: true\n                },\n                _sum: {\n                    amount: true\n                }\n            });\n            const { password: _, ...userWithoutPassword } = user;\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user: {\n                    ...userWithoutPassword,\n                    totalRoyalty: royaltyAgg._sum.amount || 0,\n                    paidRoyalty: paidAgg._sum.amount || 0,\n                    unpaidRoyalty: (royaltyAgg._sum.amount || 0) - (paidAgg._sum.amount || 0)\n                }\n            });\n        }\n        // ==================== ADMIN ORDERS API ====================\n        // GET /api/admin/orders - List all orders\n        if (path === \"/admin/orders\") {\n            const url = new URL(request.url);\n            const status = url.searchParams.get(\"status\");\n            const search = url.searchParams.get(\"search\");\n            const page = parseInt(url.searchParams.get(\"page\") || \"1\");\n            const limit = parseInt(url.searchParams.get(\"limit\") || \"50\");\n            const skip = (page - 1) * limit;\n            const where = {};\n            if (status && status !== \"all\") where.status = status;\n            if (search) {\n                where.OR = [\n                    {\n                        orderNumber: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        shippingName: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        shippingEmail: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    }\n                ];\n            }\n            const [orders, total] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.findMany({\n                    where,\n                    skip,\n                    take: limit,\n                    orderBy: {\n                        createdAt: \"desc\"\n                    },\n                    include: {\n                        user: {\n                            select: {\n                                id: true,\n                                name: true,\n                                email: true,\n                                authorUid: true\n                            }\n                        },\n                        items: {\n                            include: {\n                                book: {\n                                    select: {\n                                        id: true,\n                                        title: true,\n                                        coverImage: true\n                                    }\n                                }\n                            }\n                        },\n                        currentStage: true,\n                        stageHistory: {\n                            orderBy: {\n                                movedAt: \"desc\"\n                            },\n                            take: 5,\n                            include: {\n                                stage: true\n                            }\n                        }\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.count({\n                    where\n                })\n            ]);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                orders,\n                pagination: {\n                    page,\n                    limit,\n                    total,\n                    totalPages: Math.ceil(total / limit)\n                }\n            });\n        }\n        // GET /api/admin/orders/stages - Get order stages\n        if (path === \"/admin/orders/stages\") {\n            const stages = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].orderStage.findMany({\n                where: {\n                    isActive: true\n                },\n                orderBy: {\n                    sortOrder: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stages\n            });\n        }\n        // GET /api/admin/orders/[id] - Single order details\n        if (path.startsWith(\"/admin/orders/\") && pathSegments.length === 3 && pathSegments[2] !== \"stages\") {\n            const orderId = pathSegments[2];\n            const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.findUnique({\n                where: {\n                    id: orderId\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true,\n                            authorUid: true,\n                            phone: true\n                        }\n                    },\n                    items: {\n                        include: {\n                            book: true\n                        }\n                    },\n                    currentStage: true,\n                    stageHistory: {\n                        orderBy: {\n                            movedAt: \"desc\"\n                        },\n                        include: {\n                            stage: true\n                        }\n                    }\n                }\n            });\n            if (!order) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Order not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                order\n            });\n        }\n        // ==================== ADMIN ROYALTIES API ====================\n        // GET /api/admin/royalties - List royalties with filters\n        if (path === \"/admin/royalties\") {\n            const url = new URL(request.url);\n            const authorUid = url.searchParams.get(\"authorUid\");\n            const authorId = url.searchParams.get(\"authorId\");\n            const bookId = url.searchParams.get(\"bookId\");\n            const period = url.searchParams.get(\"period\");\n            const isPaid = url.searchParams.get(\"isPaid\");\n            const bucket = url.searchParams.get(\"bucket\");\n            const page = parseInt(url.searchParams.get(\"page\") || \"1\");\n            const limit = parseInt(url.searchParams.get(\"limit\") || \"50\");\n            const skip = (page - 1) * limit;\n            const where = {};\n            if (authorUid) where.authorUid = authorUid;\n            if (authorId) where.authorId = authorId;\n            if (bookId) where.bookId = bookId;\n            if (period) where.period = period;\n            if (isPaid === \"true\") where.isPaid = true;\n            if (isPaid === \"false\") where.isPaid = false;\n            if (bucket) where.bucket = bucket;\n            const [royalties, total, aggregates] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.findMany({\n                    where,\n                    skip,\n                    take: limit,\n                    orderBy: {\n                        createdAt: \"desc\"\n                    },\n                    include: {\n                        author: {\n                            select: {\n                                id: true,\n                                name: true,\n                                email: true,\n                                authorUid: true,\n                                bankDetails: {\n                                    select: {\n                                        accountNumber: true,\n                                        ifscCode: true,\n                                        accountName: true,\n                                        bankName: true\n                                    }\n                                }\n                            }\n                        },\n                        book: {\n                            select: {\n                                id: true,\n                                title: true,\n                                isbn: true,\n                                isbnPaperback: true,\n                                isbnHardcover: true\n                            }\n                        }\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.count({\n                    where\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                    where,\n                    _sum: {\n                        amount: true,\n                        saleAmount: true\n                    }\n                })\n            ]);\n            // Get paid vs unpaid breakdown\n            const paidAgg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.aggregate({\n                where: {\n                    ...where,\n                    isPaid: true\n                },\n                _sum: {\n                    amount: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                royalties,\n                pagination: {\n                    page,\n                    limit,\n                    total,\n                    totalPages: Math.ceil(total / limit)\n                },\n                summary: {\n                    totalAmount: aggregates._sum.amount || 0,\n                    totalSales: aggregates._sum.saleAmount || 0,\n                    paidAmount: paidAgg._sum.amount || 0,\n                    pendingAmount: (aggregates._sum.amount || 0) - (paidAgg._sum.amount || 0)\n                }\n            });\n        }\n        // GET /api/admin/royalties/periods - Get available periods\n        if (path === \"/admin/royalties/periods\") {\n            const periods = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.groupBy({\n                by: [\n                    \"period\"\n                ],\n                _sum: {\n                    amount: true\n                },\n                orderBy: {\n                    period: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                periods: periods.filter((p)=>p.period).map((p)=>({\n                        period: p.period,\n                        totalAmount: p._sum.amount || 0\n                    }))\n            });\n        }\n        // GET /api/admin/royalties/by-author - Royalties grouped by author\n        if (path === \"/admin/royalties/by-author\") {\n            const url = new URL(request.url);\n            const period = url.searchParams.get(\"period\");\n            const where = period ? {\n                period\n            } : {};\n            const royalties = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.groupBy({\n                by: [\n                    \"authorId\",\n                    \"authorUid\"\n                ],\n                where,\n                _sum: {\n                    amount: true,\n                    saleAmount: true\n                },\n                _count: true\n            });\n            // Get author details\n            const authorIds = royalties.map((r)=>r.authorId);\n            const authors = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findMany({\n                where: {\n                    id: {\n                        in: authorIds\n                    }\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    authorUid: true\n                }\n            });\n            const authorsMap = new Map(authors.map((a)=>[\n                    a.id,\n                    a\n                ]));\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                royaltiesByAuthor: royalties.map((r)=>({\n                        author: authorsMap.get(r.authorId),\n                        totalAmount: r._sum.amount || 0,\n                        totalSales: r._sum.saleAmount || 0,\n                        count: r._count\n                    }))\n            });\n        }\n        // ==================== ADMIN PACKAGES API ====================\n        // GET /api/admin/packages - List all packages (including inactive)\n        if (path === \"/admin/packages\") {\n            const packages = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingPackage.findMany({\n                orderBy: {\n                    sortOrder: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                packages\n            });\n        }\n        // GET /api/admin/packages/[id] - Single package\n        if (path.startsWith(\"/admin/packages/\") && pathSegments.length === 3) {\n            const packageId = pathSegments[2];\n            const pkg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingPackage.findUnique({\n                where: {\n                    id: packageId\n                }\n            });\n            if (!pkg) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Package not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                package: pkg\n            });\n        }\n        // Get publishing packages\n        if (path === \"/packages\") {\n            const packages = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingPackage.findMany({\n                where: {\n                    isActive: true\n                },\n                orderBy: {\n                    sortOrder: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                packages\n            });\n        }\n        // Get blog posts\n        if (path === \"/blog\") {\n            const { searchParams } = new URL(request.url);\n            const category = searchParams.get(\"category\");\n            const where = {\n                isPublished: true\n            };\n            if (category) where.category = category;\n            const posts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findMany({\n                where,\n                orderBy: {\n                    publishedAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                posts\n            });\n        }\n        // Payment status check\n        if (path === \"/payment/status\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                configured: (0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.isRazorpayConfigured)(),\n                message: (0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.isRazorpayConfigured)() ? \"Razorpay is configured and ready\" : \"Razorpay is not configured. Add RAZORPAY_KEY_ID and RAZORPAY_KEY_SECRET to enable payments.\"\n            });\n        }\n        // ==================== NEW API ROUTES ====================\n        // GET /api/settings\n        if (path === \"/settings\") {\n            const { searchParams } = new URL(request.url);\n            const category = searchParams.get(\"category\");\n            const key = searchParams.get(\"key\");\n            if (key) {\n                const value = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSetting)(key);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    key,\n                    value\n                });\n            }\n            if (category) {\n                const settings = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSettingsByCategory)(category);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    settings\n                });\n            }\n            const allSettings = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteSetting.findMany();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                settings: allSettings\n            });\n        }\n        // GET /api/addons\n        if (path === \"/addons\") {\n            const { searchParams } = new URL(request.url);\n            const serviceType = searchParams.get(\"serviceType\");\n            const where = {\n                isActive: true\n            };\n            if (serviceType) {\n                where.serviceType = serviceType;\n            }\n            const addOns = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].serviceAddOn.findMany({\n                where,\n                orderBy: {\n                    sortOrder: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                addOns\n            });\n        }\n        // GET /api/reviews\n        if (path === \"/reviews\") {\n            const { searchParams } = new URL(request.url);\n            const displayOn = searchParams.get(\"displayOn\");\n            const bookId = searchParams.get(\"bookId\");\n            const featured = searchParams.get(\"featured\");\n            const where = {\n                isApproved: true\n            };\n            if (bookId) where.bookId = bookId;\n            if (featured === \"true\") where.isFeatured = true;\n            let reviews = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].review.findMany({\n                where,\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                take: 20\n            });\n            if (displayOn) {\n                reviews = reviews.filter((r)=>{\n                    const displays = r.displayOn || [];\n                    return displays.includes(displayOn);\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reviews\n            });\n        }\n        // GET /api/categories\n        if (path === \"/categories\") {\n            const categories = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].category.findMany({\n                where: {\n                    isActive: true\n                },\n                orderBy: {\n                    sortOrder: \"asc\"\n                },\n                include: {\n                    children: {\n                        where: {\n                            isActive: true\n                        },\n                        orderBy: {\n                            sortOrder: \"asc\"\n                        }\n                    }\n                }\n            });\n            const topLevel = categories.filter((c)=>!c.parentId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                categories: topLevel\n            });\n        }\n        // GET /api/anthology/count\n        if (path === \"/anthology/count\") {\n            const twentyFourHoursAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\n            const count = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].anthologySubmission.count({\n                where: {\n                    createdAt: {\n                        gte: twentyFourHoursAgo\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                count,\n                period: \"24h\"\n            });\n        }\n        // GET /api/discounts\n        if (path === \"/discounts\") {\n            const { searchParams } = new URL(request.url);\n            const code = searchParams.get(\"code\");\n            const appliesTo = searchParams.get(\"appliesTo\");\n            if (code) {\n                const discount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].discount.findUnique({\n                    where: {\n                        code\n                    }\n                });\n                if (!discount || !discount.isActive) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        valid: false,\n                        error: \"Invalid or expired code\"\n                    });\n                }\n                if (discount.expiresAt && new Date() > discount.expiresAt) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        valid: false,\n                        error: \"Code has expired\"\n                    });\n                }\n                if (discount.maxUses && discount.usedCount >= discount.maxUses) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        valid: false,\n                        error: \"Code usage limit reached\"\n                    });\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    valid: true,\n                    discount\n                });\n            }\n            const where = {\n                isActive: true\n            };\n            if (appliesTo) {\n                where.appliesTo = {\n                    in: [\n                        appliesTo,\n                        \"all\"\n                    ]\n                };\n            }\n            const discounts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].discount.findMany({\n                where,\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                discounts\n            });\n        }\n        // GET /api/homepage - Homepage data\n        if (path === \"/homepage\") {\n            const showRecentReleases = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSetting)(\"homepage.show_recent_releases\");\n            const showBestSellers = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSetting)(\"homepage.show_best_sellers\");\n            const bestSellersMode = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSetting)(\"homepage.best_sellers_mode\");\n            const showLiveCounter = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSetting)(\"homepage.show_live_counter\");\n            const publishingSteps = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.getSetting)(\"homepage.publishing_steps\");\n            const data = {\n                settings: {\n                    showRecentReleases,\n                    showBestSellers,\n                    bestSellersMode,\n                    showLiveCounter,\n                    publishingSteps\n                }\n            };\n            if (showRecentReleases) {\n                data.recentReleases = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                    where: {\n                        isPublic: true,\n                        isAuthorCopy: false,\n                        status: \"PUBLISHED\"\n                    },\n                    orderBy: {\n                        publishedDate: \"desc\"\n                    },\n                    take: 8,\n                    select: {\n                        id: true,\n                        title: true,\n                        coverImage: true,\n                        category: true,\n                        genre: true,\n                        author: {\n                            select: {\n                                name: true\n                            }\n                        }\n                    }\n                });\n            }\n            if (showBestSellers) {\n                if (bestSellersMode === \"manual\") {\n                    data.bestSellers = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                        where: {\n                            isPublic: true,\n                            isAuthorCopy: false,\n                            isBestSeller: true,\n                            bestSellerManual: true\n                        },\n                        take: 8,\n                        select: {\n                            id: true,\n                            title: true,\n                            coverImage: true,\n                            category: true,\n                            genre: true,\n                            author: {\n                                select: {\n                                    name: true\n                                }\n                            }\n                        }\n                    });\n                } else {\n                    data.bestSellers = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                        where: {\n                            isPublic: true,\n                            isAuthorCopy: false\n                        },\n                        orderBy: {\n                            salesCount: \"desc\"\n                        },\n                        take: 8,\n                        select: {\n                            id: true,\n                            title: true,\n                            coverImage: true,\n                            category: true,\n                            genre: true,\n                            author: {\n                                select: {\n                                    name: true\n                                }\n                            }\n                        }\n                    });\n                }\n            }\n            if (showLiveCounter) {\n                data.booksPublished = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.count({\n                    where: {\n                        status: \"PUBLISHED\"\n                    }\n                });\n            }\n            data.reviews = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].review.findMany({\n                where: {\n                    isApproved: true,\n                    isFeatured: true\n                },\n                take: 6\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data);\n        }\n        // ==================== BLOG SYSTEM APIs ====================\n        // GET /api/blog - List published blog posts (public)\n        if (path === \"/blog\") {\n            const url = new URL(request.url);\n            const page = parseInt(url.searchParams.get(\"page\") || \"1\");\n            const limit = parseInt(url.searchParams.get(\"limit\") || \"12\");\n            const category = url.searchParams.get(\"category\");\n            const skip = (page - 1) * limit;\n            const where = {\n                isPublished: true\n            };\n            if (category) where.category = category;\n            const [posts, total] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findMany({\n                    where,\n                    orderBy: {\n                        publishedAt: \"desc\"\n                    },\n                    skip,\n                    take: limit,\n                    select: {\n                        id: true,\n                        title: true,\n                        slug: true,\n                        excerpt: true,\n                        coverImage: true,\n                        authorName: true,\n                        category: true,\n                        tags: true,\n                        views: true,\n                        publishedAt: true,\n                        _count: {\n                            select: {\n                                comments: {\n                                    where: {\n                                        isApproved: true\n                                    }\n                                },\n                                likes: true\n                            }\n                        }\n                    }\n                }),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.count({\n                    where\n                })\n            ]);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                posts,\n                pagination: {\n                    page,\n                    limit,\n                    total,\n                    totalPages: Math.ceil(total / limit)\n                }\n            });\n        }\n        // GET /api/blog/[slug] - Single blog post (public)\n        if (path.startsWith(\"/blog/\") && pathSegments.length === 2 && pathSegments[1] !== \"categories\") {\n            const slug = pathSegments[1];\n            const post = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                where: {\n                    slug\n                },\n                include: {\n                    comments: {\n                        where: {\n                            isApproved: true\n                        },\n                        orderBy: {\n                            createdAt: \"desc\"\n                        }\n                    },\n                    _count: {\n                        select: {\n                            likes: true\n                        }\n                    }\n                }\n            });\n            if (!post || !post.isPublished) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Post not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Increment views\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.update({\n                where: {\n                    id: post.id\n                },\n                data: {\n                    views: {\n                        increment: 1\n                    }\n                }\n            });\n            // Get linked book if exists\n            let linkedBook = null;\n            if (post.linkedBookId) {\n                linkedBook = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                    where: {\n                        id: post.linkedBookId\n                    },\n                    select: {\n                        id: true,\n                        title: true,\n                        coverImage: true,\n                        author: {\n                            select: {\n                                name: true\n                            }\n                        }\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                post: {\n                    ...post,\n                    linkedBook\n                }\n            });\n        }\n        // GET /api/blog/categories - Blog categories\n        if (path === \"/blog/categories\") {\n            const categories = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.groupBy({\n                by: [\n                    \"category\"\n                ],\n                where: {\n                    isPublished: true,\n                    category: {\n                        not: null\n                    }\n                },\n                _count: {\n                    category: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                categories: categories.filter((c)=>c.category).map((c)=>({\n                        name: c.category,\n                        count: c._count.category\n                    }))\n            });\n        }\n        // GET /api/admin/blog - All blog posts (admin)\n        if (path === \"/admin/blog\") {\n            const posts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findMany({\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                include: {\n                    _count: {\n                        select: {\n                            comments: true,\n                            likes: true\n                        }\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                posts\n            });\n        }\n        // GET /api/admin/blog/comments - Pending comments (admin) - MUST BE BEFORE /admin/blog/[id]\n        if (path === \"/admin/blog/comments\") {\n            const url = new URL(request.url);\n            const approved = url.searchParams.get(\"approved\");\n            const where = {};\n            if (approved === \"true\") where.isApproved = true;\n            else if (approved === \"false\") where.isApproved = false;\n            const comments = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogComment.findMany({\n                where,\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                include: {\n                    post: {\n                        select: {\n                            id: true,\n                            title: true,\n                            slug: true\n                        }\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                comments\n            });\n        }\n        // GET /api/admin/blog/[id] - Single blog post for editing (admin)\n        if (path.startsWith(\"/admin/blog/\") && pathSegments.length === 3) {\n            const postId = pathSegments[2];\n            const post = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                where: {\n                    id: postId\n                },\n                include: {\n                    comments: {\n                        orderBy: {\n                            createdAt: \"desc\"\n                        }\n                    }\n                }\n            });\n            if (!post) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Post not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                post\n            });\n        }\n        // GET /api/admin/guest-posts - Guest post submissions (admin)\n        if (path === \"/admin/guest-posts\") {\n            const url = new URL(request.url);\n            const status = url.searchParams.get(\"status\") || \"pending\";\n            const guestPosts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].guestPost.findMany({\n                where: status === \"all\" ? {} : {\n                    status\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                guestPosts\n            });\n        }\n        // GET /api/anthology/stats - Anthology submission stats\n        if (path === \"/anthology/stats\") {\n            const now = new Date();\n            const twentyFourHoursAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n            const [total, today] = await Promise.all([\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].anthologySubmission.count(),\n                _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].anthologySubmission.count({\n                    where: {\n                        createdAt: {\n                            gte: twentyFourHoursAgo\n                        }\n                    }\n                })\n            ]);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                total,\n                today\n            });\n        }\n        // GET /api/admin/anthology - Anthology submissions (admin)\n        if (path === \"/admin/anthology\") {\n            const submissions = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].anthologySubmission.findMany({\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                submissions\n            });\n        }\n        // GET /api/shop/books\n        if (path === \"/shop/books\") {\n            const { searchParams } = new URL(request.url);\n            const search = searchParams.get(\"search\");\n            const category = searchParams.get(\"category\");\n            const userId = searchParams.get(\"userId\"); // For author copies visibility\n            const where = {\n                isPublic: true,\n                status: \"PUBLISHED\"\n            };\n            // Only show author copies to logged-in matching authors\n            if (!userId) {\n                where.isAuthorCopy = false;\n            }\n            if (search) {\n                where.OR = [\n                    {\n                        title: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        isbn: {\n                            contains: search,\n                            mode: \"insensitive\"\n                        }\n                    },\n                    {\n                        author: {\n                            name: {\n                                contains: search,\n                                mode: \"insensitive\"\n                            }\n                        }\n                    }\n                ];\n            }\n            if (category) {\n                where.category = category;\n            }\n            const books = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                where,\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    },\n                    externalLinks: true,\n                    categories: {\n                        include: {\n                            category: true\n                        }\n                    }\n                },\n                orderBy: {\n                    publishedDate: \"desc\"\n                }\n            });\n            // Filter author copies - only show to matching author\n            const filteredBooks = books.filter((book)=>{\n                if (book.isAuthorCopy) {\n                    return book.authorId === userId;\n                }\n                return true;\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                books: filteredBooks\n            });\n        }\n        // ============================================\n        // AUTHOR API ROUTES\n        // ============================================\n        // GET /api/author/manuscripts - Get author's manuscripts\n        if (path === \"/author/manuscripts\") {\n            const url = new URL(request.url);\n            const authorIdParam = url.searchParams.get(\"authorId\");\n            const userId = authorIdParam || request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const manuscripts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].manuscript.findMany({\n                where: {\n                    authorId: userId\n                },\n                include: {\n                    book: {\n                        select: {\n                            id: true,\n                            title: true\n                        }\n                    }\n                },\n                orderBy: {\n                    updatedAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                manuscripts\n            });\n        }\n        // GET /api/author/queries - Get author's queries\n        if (path === \"/author/queries\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const queries = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.findMany({\n                where: {\n                    authorId: userId\n                },\n                include: {\n                    book: {\n                        select: {\n                            id: true,\n                            title: true\n                        }\n                    },\n                    comments: {\n                        orderBy: {\n                            createdAt: \"asc\"\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                queries\n            });\n        }\n        // GET /api/author/orders - Get author's orders\n        if (path === \"/author/orders\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const orders = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.findMany({\n                where: {\n                    userId\n                },\n                include: {\n                    items: {\n                        include: {\n                            book: {\n                                select: {\n                                    id: true,\n                                    title: true,\n                                    coverImage: true\n                                }\n                            }\n                        }\n                    },\n                    currentStage: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                orders\n            });\n        }\n        // GET /api/author/royalties - Get author's royalties with daily breakdown\n        if (path === \"/author/royalties\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const royalties = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.findMany({\n                where: {\n                    authorId: userId\n                },\n                include: {\n                    book: {\n                        select: {\n                            id: true,\n                            title: true,\n                            isbn: true,\n                            isbnPaperback: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            // Group by period for monthly breakdown\n            const byPeriod = royalties.reduce((acc, r)=>{\n                const period = r.period || \"Unknown\";\n                if (!acc[period]) acc[period] = {\n                    total: 0,\n                    paid: 0,\n                    pending: 0,\n                    items: []\n                };\n                acc[period].total += r.amount;\n                if (r.isPaid) acc[period].paid += r.amount;\n                else acc[period].pending += r.amount;\n                acc[period].items.push(r);\n                return acc;\n            }, {});\n            // Group by day for daily breakdown (recent 30 days)\n            const last30Days = new Date();\n            last30Days.setDate(last30Days.getDate() - 30);\n            const recentRoyalties = royalties.filter((r)=>new Date(r.createdAt) >= last30Days);\n            const byDay = recentRoyalties.reduce((acc, r)=>{\n                const day = new Date(r.createdAt).toISOString().split(\"T\")[0];\n                if (!acc[day]) acc[day] = {\n                    total: 0,\n                    items: []\n                };\n                acc[day].total += r.amount;\n                acc[day].items.push(r);\n                return acc;\n            }, {});\n            const summary = {\n                total: royalties.reduce((sum, r)=>sum + r.amount, 0),\n                paid: royalties.filter((r)=>r.isPaid).reduce((sum, r)=>sum + r.amount, 0),\n                pending: royalties.filter((r)=>!r.isPaid).reduce((sum, r)=>sum + r.amount, 0),\n                byBucket: {\n                    WEBSITE: royalties.filter((r)=>r.bucket === \"WEBSITE\").reduce((sum, r)=>sum + r.amount, 0),\n                    EBOOK: royalties.filter((r)=>r.bucket === \"EBOOK\").reduce((sum, r)=>sum + r.amount, 0),\n                    ECOMMERCE: royalties.filter((r)=>r.bucket === \"ECOMMERCE\").reduce((sum, r)=>sum + r.amount, 0)\n                }\n            };\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                royalties,\n                summary,\n                byPeriod,\n                byDay\n            });\n        }\n        // GET /api/author/settings - Get author's settings\n        if (path === \"/author/settings\") {\n            const url = new URL(request.url);\n            const authorIdParam = url.searchParams.get(\"authorId\");\n            const userId = authorIdParam || request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    id: userId\n                },\n                include: {\n                    bankDetails: true\n                }\n            });\n            if (!user) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User not found\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                profile: {\n                    id: user.id,\n                    name: user.name,\n                    email: user.email,\n                    phone: user.phone,\n                    alternateEmail: user.alternateEmail,\n                    alternatePhone: user.alternatePhone,\n                    bio: user.bio,\n                    website: user.website,\n                    publicUrl: user.publicUrl,\n                    socialLinks: user.socialLinks,\n                    authorUid: user.authorUid,\n                    profileImage: user.profileImage\n                },\n                bankDetails: user.bankDetails,\n                notifications: {\n                    emailNotifications: true,\n                    stageUpdates: true,\n                    queryResponses: true,\n                    royaltyAlerts: true,\n                    marketingEmails: false\n                }\n            });\n        }\n        // GET /api/public/authors/[slug] - Public author profile\n        if (path.startsWith(\"/public/authors/\") && pathSegments.length === 3) {\n            const slug = pathSegments[2];\n            const author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findFirst({\n                where: {\n                    OR: [\n                        {\n                            publicUrl: slug\n                        },\n                        {\n                            id: slug\n                        }\n                    ],\n                    role: \"AUTHOR\"\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    bio: true,\n                    profileImage: true,\n                    website: true,\n                    socialLinks: true,\n                    email: true\n                }\n            });\n            if (!author) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author not found\"\n                }, {\n                    status: 404\n                });\n            }\n            const books = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findMany({\n                where: {\n                    authorId: author.id,\n                    isPublic: true,\n                    status: \"PUBLISHED\"\n                },\n                include: {\n                    externalLinks: true\n                },\n                orderBy: {\n                    publishedDate: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                author,\n                books\n            });\n        }\n        // GET /api/admin/sales - Get all sales with enhanced data\n        if (path === \"/admin/sales\") {\n            const sales = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].sale.findMany({\n                include: {\n                    book: {\n                        include: {\n                            author: {\n                                select: {\n                                    id: true,\n                                    name: true,\n                                    authorUid: true\n                                }\n                            },\n                            royaltyConfigs: true\n                        }\n                    }\n                },\n                orderBy: {\n                    saleDate: \"desc\"\n                }\n            });\n            // Fetch all royalties for summary\n            const royalties = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.findMany({\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            authorUid: true\n                        }\n                    },\n                    book: {\n                        select: {\n                            id: true,\n                            title: true,\n                            isbn: true,\n                            isbnPaperback: true,\n                            isbnHardcover: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            const summary = {\n                totalSales: sales.reduce((sum, s)=>sum + s.totalAmount, 0),\n                totalUnits: sales.reduce((sum, s)=>sum + s.quantity, 0),\n                totalRoyalties: royalties.reduce((sum, r)=>sum + r.amount, 0),\n                pendingRoyalties: royalties.filter((r)=>!r.isPaid).reduce((sum, r)=>sum + r.amount, 0),\n                paidRoyalties: royalties.filter((r)=>r.isPaid).reduce((sum, r)=>sum + r.amount, 0)\n            };\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                sales,\n                royalties,\n                summary\n            });\n        }\n        // GET /api/admin/royalties - Get all royalties with full details\n        if (path === \"/admin/royalties\") {\n            const url = new URL(request.url);\n            const isPaidFilter = url.searchParams.get(\"isPaid\");\n            const platform = url.searchParams.get(\"platform\");\n            const period = url.searchParams.get(\"period\");\n            const where = {};\n            if (isPaidFilter !== null && isPaidFilter !== \"all\") {\n                where.isPaid = isPaidFilter === \"true\";\n            }\n            if (platform && platform !== \"all\") {\n                where.OR = [\n                    {\n                        platform\n                    },\n                    {\n                        bucket: platform\n                    }\n                ];\n            }\n            if (period && period !== \"all\") {\n                where.period = period;\n            }\n            const royalties = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.findMany({\n                where,\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true,\n                            authorUid: true\n                        }\n                    },\n                    book: {\n                        select: {\n                            id: true,\n                            title: true,\n                            isbn: true,\n                            isbnPaperback: true,\n                            isbnHardcover: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                royalties\n            });\n        }\n        // GET /api/admin/books/{bookId}/royalty-config - Get royalty configs for a book\n        if (path.match(/^\\/admin\\/books\\/[^/]+\\/royalty-config$/)) {\n            const bookId = pathSegments[2];\n            const configs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bookRoyaltyConfig.findMany({\n                where: {\n                    bookId,\n                    isActive: true\n                },\n                orderBy: {\n                    platform: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                configs\n            });\n        }\n        // GET /api/admin/content - Get site content\n        if (path === \"/admin/content\") {\n            const contents = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteContent.findMany({\n                orderBy: {\n                    key: \"asc\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                contents\n            });\n        }\n        // GET /api/admin/imports - Get import history\n        if (path === \"/admin/imports\") {\n            const imports = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].importBatch.findMany({\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                take: 50\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                imports\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Not found\"\n        }, {\n            status: 404\n        });\n    } catch (error) {\n        console.error(\"API GET Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request, context) {\n    const params = await context.params;\n    const pathSegments = params?.path || [];\n    const path = \"/\" + pathSegments.join(\"/\");\n    try {\n        // Handle FormData routes BEFORE trying to parse JSON\n        // Upload manuscript (with actual file storage)\n        if (path === \"/manuscripts\") {\n            const formData = await request.formData();\n            const file = formData.get(\"file\");\n            const bookId = formData.get(\"bookId\");\n            const authorId = formData.get(\"authorId\");\n            const notes = formData.get(\"notes\");\n            if (!file || !bookId || !authorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"File, book ID, and author ID are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Validate file type for Word documents\n            const validTypes = [\n                \"application/msword\",\n                \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n            ];\n            if (!validTypes.includes(file.type)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Only Word documents (.doc, .docx) are allowed\"\n                }, {\n                    status: 400\n                });\n            }\n            // Validate file size (10MB max)\n            if (file.size > 10 * 1024 * 1024) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"File size cannot exceed 10MB\"\n                }, {\n                    status: 400\n                });\n            }\n            // Get current version\n            const latestManuscript = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].manuscript.findFirst({\n                where: {\n                    bookId\n                },\n                orderBy: {\n                    version: \"desc\"\n                }\n            });\n            const version = (latestManuscript?.version || 0) + 1;\n            // Generate unique filename and store the file\n            const fileId = (0,uuid__WEBPACK_IMPORTED_MODULE_8__[\"default\"])();\n            const ext = file.name.split(\".\").pop();\n            const safeFileName = `${fileId}.${ext}`;\n            const fileUrl = `/uploads/manuscripts/${safeFileName}`;\n            // Write file to disk\n            const fs = __webpack_require__(/*! fs */ \"fs\");\n            const pathModule = __webpack_require__(/*! path */ \"path\");\n            const uploadsDir = pathModule.join(process.cwd(), \"public\", \"uploads\", \"manuscripts\");\n            // Ensure directory exists\n            if (!fs.existsSync(uploadsDir)) {\n                fs.mkdirSync(uploadsDir, {\n                    recursive: true\n                });\n            }\n            // Write the file\n            const buffer = Buffer.from(await file.arrayBuffer());\n            fs.writeFileSync(pathModule.join(uploadsDir, safeFileName), buffer);\n            const manuscript = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].manuscript.create({\n                data: {\n                    bookId,\n                    authorId,\n                    fileName: file.name,\n                    fileUrl,\n                    fileSize: file.size,\n                    fileType: file.type,\n                    version,\n                    status: \"UPLOADED\",\n                    notes,\n                    isWordUpload: true\n                }\n            });\n            // Update book status if first manuscript\n            if (version === 1) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.update({\n                    where: {\n                        id: bookId\n                    },\n                    data: {\n                        status: \"IN_PROGRESS\"\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                manuscript\n            });\n        }\n        // Parse body once for routes that need it\n        let body = {};\n        try {\n            body = await request.json();\n        } catch (e) {\n        // Body might be form data or empty, which is fine\n        }\n        // User registration\n        if (path === \"/auth/register\") {\n            const { email, password, name, phone } = body;\n            if (!email || !password || !name) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Email, password, and name are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check if user exists\n            const existingUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    email\n                }\n            });\n            if (existingUser) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User with this email already exists\"\n                }, {\n                    status: 400\n                });\n            }\n            // Hash password\n            const hashedPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_2__[\"default\"].hash(password, 12);\n            // Generate public URL from name\n            const baseUrl = name.toLowerCase().replace(/[^a-z0-9]/g, \"-\").replace(/-+/g, \"-\");\n            let publicUrl = baseUrl;\n            let counter = 1;\n            while(await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    publicUrl\n                }\n            })){\n                publicUrl = `${baseUrl}-${counter}`;\n                counter++;\n            }\n            // Create user\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.create({\n                data: {\n                    email,\n                    password: hashedPassword,\n                    name,\n                    phone,\n                    role: \"AUTHOR\",\n                    publicUrl\n                },\n                select: {\n                    id: true,\n                    email: true,\n                    name: true,\n                    role: true,\n                    publicUrl: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user,\n                message: \"Registration successful\"\n            });\n        }\n        // Create book\n        if (path === \"/books\") {\n            const { title, subtitle, authorId, description, category, genre } = body;\n            if (!title || !authorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Title and author ID are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Create book with publishing stages\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.create({\n                data: {\n                    title,\n                    subtitle,\n                    authorId,\n                    description,\n                    category,\n                    genre,\n                    status: \"DRAFT\",\n                    publishingStages: {\n                        create: PUBLISHING_STAGES.map((stage)=>({\n                                stageType: stage.type,\n                                stageOrder: stage.order,\n                                status: stage.order === 1 ? \"IN_PROGRESS\" : \"PENDING\"\n                            }))\n                    }\n                },\n                include: {\n                    publishingStages: {\n                        orderBy: {\n                            stageOrder: \"asc\"\n                        }\n                    }\n                }\n            });\n            // Create notification for author\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.create({\n                data: {\n                    userId: authorId,\n                    type: \"SYSTEM\",\n                    title: \"Book Created\",\n                    message: `Your book \"${title}\" has been created. Start by uploading your manuscript.`,\n                    link: `/author/books/${book.id}`\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book\n            });\n        }\n        // Approve stage\n        if (path === \"/stages/approve\") {\n            const { stageId, authorNotes } = body;\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.update({\n                where: {\n                    id: stageId\n                },\n                data: {\n                    status: \"APPROVED\",\n                    authorNotes,\n                    completedAt: new Date()\n                }\n            });\n            // Move to next stage\n            const nextStage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.findFirst({\n                where: {\n                    bookId: stage.bookId,\n                    stageOrder: stage.stageOrder + 1\n                }\n            });\n            if (nextStage) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.update({\n                    where: {\n                        id: nextStage.id\n                    },\n                    data: {\n                        status: \"IN_PROGRESS\",\n                        startedAt: new Date()\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage,\n                message: \"Stage approved\"\n            });\n        }\n        // Raise query\n        if (path === \"/queries\") {\n            const { authorId, bookId, stageId, type, subject, description, priority } = body;\n            if (!authorId || !subject || !description) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author ID, subject, and description are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const query = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.create({\n                data: {\n                    authorId,\n                    bookId,\n                    stageId,\n                    type: type || \"GENERAL\",\n                    priority: priority || \"MEDIUM\",\n                    subject,\n                    description,\n                    status: \"OPEN\"\n                }\n            });\n            // Update stage status if stage-specific query\n            if (stageId) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.update({\n                    where: {\n                        id: stageId\n                    },\n                    data: {\n                        status: \"QUERY_RAISED\"\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                query\n            });\n        }\n        // Add query comment\n        if (path === \"/queries/comment\") {\n            const { queryId, userId, userName, userRole, comment, isInternal } = body;\n            const queryComment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].queryComment.create({\n                data: {\n                    queryId,\n                    userId,\n                    userName,\n                    userRole,\n                    comment,\n                    isInternal: isInternal || false\n                }\n            });\n            // Update query status\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.update({\n                where: {\n                    id: queryId\n                },\n                data: {\n                    status: \"IN_PROGRESS\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                comment: queryComment\n            });\n        }\n        // Create order\n        if (path === \"/orders\") {\n            const { userId, items, shippingName, shippingEmail, shippingPhone, shippingAddress, shippingCity, shippingState, shippingZipCode, shippingCountry } = body;\n            if (!userId || !items || items.length === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User ID and items are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Calculate total\n            let totalAmount = 0;\n            const orderItems = [];\n            for (const item of items){\n                const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                    where: {\n                        id: item.bookId\n                    }\n                });\n                if (!book) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: `Book ${item.bookId} not found`\n                    }, {\n                        status: 400\n                    });\n                }\n                const unitPrice = item.isAuthorCopy && book.authorCopyPrice ? book.authorCopyPrice : book.discountPrice || book.price;\n                const itemTotal = unitPrice * item.quantity;\n                totalAmount += itemTotal;\n                orderItems.push({\n                    bookId: item.bookId,\n                    quantity: item.quantity,\n                    unitPrice,\n                    totalPrice: itemTotal\n                });\n            }\n            // Create order\n            const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.create({\n                data: {\n                    userId,\n                    orderNumber: generateOrderNumber(),\n                    totalAmount,\n                    status: \"PENDING\",\n                    shippingName,\n                    shippingEmail,\n                    shippingPhone,\n                    shippingAddress,\n                    shippingCity,\n                    shippingState,\n                    shippingZipCode,\n                    shippingCountry: shippingCountry || \"India\",\n                    items: {\n                        create: orderItems\n                    }\n                },\n                include: {\n                    items: true\n                }\n            });\n            // Create Razorpay order if configured\n            if ((0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.isRazorpayConfigured)()) {\n                try {\n                    const razorpayOrder = await (0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.createOrder)(totalAmount, \"INR\", order.orderNumber, {\n                        orderId: order.id,\n                        userId\n                    });\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.update({\n                        where: {\n                            id: order.id\n                        },\n                        data: {\n                            razorpayOrderId: razorpayOrder.id,\n                            status: \"PAYMENT_PENDING\"\n                        }\n                    });\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        order,\n                        razorpayOrderId: razorpayOrder.id,\n                        razorpayKeyId: process.env.NEXT_PUBLIC_RAZORPAY_KEY_ID,\n                        amount: totalAmount\n                    });\n                } catch (error) {\n                    console.error(\"Razorpay order creation failed:\", error);\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                order,\n                paymentDisabled: true,\n                message: \"Order created but payment gateway not configured\"\n            });\n        }\n        // Verify payment\n        if (path === \"/payment/verify\") {\n            const { razorpay_order_id, razorpay_payment_id, razorpay_signature, orderId } = body;\n            if (!(0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.isRazorpayConfigured)()) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Payment gateway not configured\"\n                }, {\n                    status: 400\n                });\n            }\n            // Verify signature\n            const isValid = (0,_lib_razorpay__WEBPACK_IMPORTED_MODULE_4__.verifyPaymentSignature)(razorpay_order_id, razorpay_payment_id, razorpay_signature);\n            if (!isValid) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Invalid payment signature\"\n                }, {\n                    status: 400\n                });\n            }\n            // Update order\n            const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.update({\n                where: {\n                    razorpayOrderId: razorpay_order_id\n                },\n                data: {\n                    status: \"PAID\",\n                    razorpayPaymentId: razorpay_payment_id,\n                    razorpaySignature: razorpay_signature,\n                    paidAt: new Date()\n                },\n                include: {\n                    items: {\n                        include: {\n                            book: true\n                        }\n                    },\n                    user: true\n                }\n            });\n            // Create royalty records for each item\n            for (const item of order.items){\n                const royaltyRate = 0.10; // 10%\n                const royaltyAmount = item.totalPrice * royaltyRate;\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.create({\n                    data: {\n                        authorId: item.book.authorId,\n                        bookId: item.bookId,\n                        orderId: order.id,\n                        amount: royaltyAmount,\n                        royaltyRate,\n                        saleAmount: item.totalPrice,\n                        period: new Date().toISOString().substring(0, 7)\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                order\n            });\n        }\n        // CRM: Create lead\n        if (path === \"/leads\") {\n            const { name, email, phone, source, interestArea, notes, createdById } = body;\n            if (!name || !email) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name and email are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const lead = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.create({\n                data: {\n                    name,\n                    email,\n                    phone,\n                    source: source || \"WEBSITE\",\n                    interestArea,\n                    notes,\n                    createdById,\n                    status: \"NEW\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lead\n            });\n        }\n        // Update profile\n        if (path === \"/profile\") {\n            const { userId, name, phone, bio, website, socialLinks, publicUrl } = body;\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check public URL uniqueness\n            if (publicUrl) {\n                const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findFirst({\n                    where: {\n                        publicUrl,\n                        id: {\n                            not: userId\n                        }\n                    }\n                });\n                if (existing) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: \"This profile URL is already taken\"\n                    }, {\n                        status: 400\n                    });\n                }\n            }\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.update({\n                where: {\n                    id: userId\n                },\n                data: {\n                    name,\n                    phone,\n                    bio,\n                    website,\n                    socialLinks,\n                    publicUrl\n                },\n                select: {\n                    id: true,\n                    email: true,\n                    name: true,\n                    phone: true,\n                    bio: true,\n                    website: true,\n                    socialLinks: true,\n                    publicUrl: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user\n            });\n        }\n        // Update bank details\n        if (path === \"/bank-details\") {\n            const { userId, accountName, accountNumber, bankName, ifscCode, branchName } = body;\n            if (!userId || !accountName || !accountNumber || !bankName || !ifscCode) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"All bank details are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const bankDetails = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bankDetails.upsert({\n                where: {\n                    userId\n                },\n                create: {\n                    userId,\n                    accountName,\n                    accountNumber,\n                    bankName,\n                    ifscCode,\n                    branchName\n                },\n                update: {\n                    accountName,\n                    accountNumber,\n                    bankName,\n                    ifscCode,\n                    branchName\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                bankDetails\n            });\n        }\n        // Mark notifications as read\n        if (path === \"/notifications/read\") {\n            const { notificationIds, userId } = body;\n            if (notificationIds && notificationIds.length > 0) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.updateMany({\n                    where: {\n                        id: {\n                            in: notificationIds\n                        }\n                    },\n                    data: {\n                        isRead: true,\n                        readAt: new Date()\n                    }\n                });\n            } else if (userId) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.updateMany({\n                    where: {\n                        userId,\n                        isRead: false\n                    },\n                    data: {\n                        isRead: true,\n                        readAt: new Date()\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // POST /api/admin/notifications - Send notification to authors\n        if (path === \"/admin/notifications\") {\n            const { targetUserIds, targetAll, type, title, message, link, ctaText } = body;\n            if (!title || !message) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"title and message are required\"\n                }, {\n                    status: 400\n                });\n            }\n            let userIds = [];\n            if (targetAll) {\n                // Send to all authors\n                const authors = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findMany({\n                    where: {\n                        role: \"AUTHOR\",\n                        isActive: true\n                    },\n                    select: {\n                        id: true\n                    }\n                });\n                userIds = authors.map((a)=>a.id);\n            } else if (targetUserIds && Array.isArray(targetUserIds)) {\n                userIds = targetUserIds;\n            } else {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"targetUserIds or targetAll required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Create notifications\n            const notifications = [];\n            for (const userId of userIds){\n                const notification = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.create({\n                    data: {\n                        userId,\n                        type: type || \"GENERAL\",\n                        title,\n                        message: ctaText ? `${message}\\n\\n${ctaText}` : message,\n                        link\n                    }\n                });\n                notifications.push(notification);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                count: notifications.length\n            });\n        }\n        // ==================== NEW POST ROUTES ====================\n        // POST /api/settings\n        if (path === \"/settings\") {\n            const { key, value, settings } = body;\n            if (settings) {\n                const results = [];\n                for (const [k, v] of Object.entries(settings)){\n                    const result = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.setSetting)(k, v);\n                    results.push(result);\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    count: results.length\n                });\n            }\n            if (key) {\n                const result = await (0,_lib_site_settings__WEBPACK_IMPORTED_MODULE_5__.setSetting)(key, value);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    setting: result\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Key or settings required\"\n            }, {\n                status: 400\n            });\n        }\n        // POST /api/enrollments\n        if (path === \"/enrollments\") {\n            const { serviceType, name, email, phone, amount, addOns, metadata, userId, discountCode } = body;\n            if (!serviceType || !name || !email || !phone) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Service type, name, email, and phone are required\"\n                }, {\n                    status: 400\n                });\n            }\n            let totalAmount = amount || 0;\n            let addOnDetails = [];\n            if (addOns && Object.keys(addOns).length > 0) {\n                for (const [addOnId, quantity] of Object.entries(addOns)){\n                    const addOn = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].serviceAddOn.findUnique({\n                        where: {\n                            id: addOnId\n                        }\n                    });\n                    if (addOn) {\n                        const addOnTotal = addOn.basePrice * (quantity || 1);\n                        totalAmount += addOnTotal;\n                        addOnDetails.push({\n                            addOnId,\n                            name: addOn.name,\n                            quantity: quantity || 1,\n                            price: addOn.basePrice,\n                            total: addOnTotal\n                        });\n                    }\n                }\n            }\n            let discountAmount = 0;\n            if (discountCode) {\n                const discount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].discount.findUnique({\n                    where: {\n                        code: discountCode\n                    }\n                });\n                if (discount && discount.isActive) {\n                    if (discount.discountType === \"percentage\") {\n                        discountAmount = totalAmount * (discount.discountValue / 100);\n                    } else {\n                        discountAmount = discount.discountValue;\n                    }\n                    totalAmount -= discountAmount;\n                }\n            }\n            const enrollment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].serviceEnrollment.create({\n                data: {\n                    userId,\n                    serviceType,\n                    name,\n                    email,\n                    phone,\n                    amount: body.amount || 0,\n                    discountCode,\n                    discountAmount,\n                    finalAmount: Math.max(0, totalAmount),\n                    addOns: addOnDetails.length > 0 ? addOnDetails : null,\n                    metadata,\n                    status: \"pending\"\n                }\n            });\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.create({\n                data: {\n                    name,\n                    email,\n                    phone,\n                    source: \"WEBSITE\",\n                    interestArea: serviceType === \"free_publishing\" ? \"Free Publishing\" : \"Writing Challenge\",\n                    notes: `Enrollment ID: ${enrollment.id}`,\n                    status: \"NEW\"\n                }\n            });\n            await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_6__.syncLeadToSheets)({\n                name,\n                email,\n                phone,\n                source: \"WEBSITE\",\n                interestArea: serviceType,\n                status: \"NEW\"\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                enrollment,\n                paymentRequired: totalAmount > 0,\n                amount: totalAmount\n            });\n        }\n        // POST /api/anthology\n        if (path === \"/anthology\") {\n            const { name: anthName, phone: anthPhone, isWhatsApp, whatsAppNumber, email: anthEmail, instagramUsername, poetryTitle, poetryContent, bio, contactPreference } = body;\n            if (!anthName || !anthPhone || !anthEmail || !poetryTitle || !poetryContent || !contactPreference) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"All required fields must be filled\"\n                }, {\n                    status: 400\n                });\n            }\n            const submission = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].anthologySubmission.create({\n                data: {\n                    name: anthName,\n                    phone: anthPhone,\n                    isWhatsApp: isWhatsApp !== false,\n                    whatsAppNumber: isWhatsApp === false ? whatsAppNumber : null,\n                    email: anthEmail,\n                    instagramUsername,\n                    poetryTitle,\n                    poetryContent,\n                    bio,\n                    contactPreference\n                }\n            });\n            await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_6__.syncAnthologyToSheets)(submission);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                submission,\n                success: true\n            });\n        }\n        // ==================== ADMIN STAGE TEMPLATES POST ROUTES ====================\n        // POST /api/admin/stage-templates - Create new stage template\n        if (path === \"/admin/stage-templates\") {\n            const { stageType, name, description, isDefault, sortOrder } = body;\n            if (!stageType || !name) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"stageType and name are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check if stageType already exists\n            const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.findUnique({\n                where: {\n                    stageType\n                }\n            });\n            if (existing) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage type already exists\"\n                }, {\n                    status: 400\n                });\n            }\n            const template = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.create({\n                data: {\n                    stageType,\n                    name,\n                    description,\n                    isDefault: isDefault || false,\n                    sortOrder: sortOrder || 99,\n                    isActive: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                template\n            });\n        }\n        // POST /api/admin/books/[bookId]/stages - Add a stage to a book\n        if (path.match(/\\/admin\\/books\\/[^/]+\\/stages$/) && pathSegments.length === 4) {\n            const bookId = pathSegments[2];\n            const { stageType, stageOrder } = body;\n            if (!stageType) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"stageType is required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check if stage already exists for this book\n            const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.findFirst({\n                where: {\n                    bookId,\n                    stageType\n                }\n            });\n            if (existing) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage already exists for this book\"\n                }, {\n                    status: 400\n                });\n            }\n            // Get max order if not provided\n            let order = stageOrder;\n            if (!order) {\n                const maxStage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.findFirst({\n                    where: {\n                        bookId\n                    },\n                    orderBy: {\n                        stageOrder: \"desc\"\n                    }\n                });\n                order = (maxStage?.stageOrder || 0) + 1;\n            }\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.create({\n                data: {\n                    bookId,\n                    stageType,\n                    stageOrder: order,\n                    status: \"PENDING\",\n                    isVisible: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage\n            });\n        }\n        // POST /api/admin/books/[bookId]/stages/toggle - Enable/disable stages for a book\n        if (path.match(/\\/admin\\/books\\/[^/]+\\/stages\\/toggle$/) && pathSegments.length === 4) {\n            const bookId = pathSegments[2];\n            const { stageIds, visible } = body; // stageIds: array of stage IDs, visible: boolean\n            if (!stageIds || !Array.isArray(stageIds)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"stageIds array required\"\n                }, {\n                    status: 400\n                });\n            }\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.updateMany({\n                where: {\n                    id: {\n                        in: stageIds\n                    },\n                    bookId: bookId\n                },\n                data: {\n                    isVisible: visible\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                count: stageIds.length\n            });\n        }\n        // POST /api/admin/books/[bookId]/stages/[stageId]/approve - Author approves a stage (locks it)\n        if (path.match(/\\/admin\\/books\\/[^/]+\\/stages\\/[^/]+\\/approve$/) && pathSegments.length === 5) {\n            const bookId = pathSegments[2];\n            const stageId = pathSegments[4];\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.findUnique({\n                where: {\n                    id: stageId\n                }\n            });\n            if (!stage || stage.bookId !== bookId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage not found\"\n                }, {\n                    status: 404\n                });\n            }\n            if (stage.status !== \"AWAITING_APPROVAL\") {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage is not awaiting approval\"\n                }, {\n                    status: 400\n                });\n            }\n            const updatedStage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.update({\n                where: {\n                    id: stageId\n                },\n                data: {\n                    status: \"APPROVED\",\n                    isLocked: true,\n                    completedAt: new Date()\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage: updatedStage\n            });\n        }\n        // ==================== ADMIN USERS POST ROUTES ====================\n        // POST /api/admin/users - Create user (manual add)\n        if (path === \"/admin/users\") {\n            const { email, name, phone, role, isBlogWriter, alternateEmail, alternatePhone } = body;\n            if (!email || !name) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Email and name are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check if user exists\n            const existingUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    email: email.toLowerCase()\n                }\n            });\n            if (existingUser) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User with this email already exists\"\n                }, {\n                    status: 400\n                });\n            }\n            // Generate Author UID\n            const authorUid = await (0,_lib_identity__WEBPACK_IMPORTED_MODULE_7__.generateAuthorUid)();\n            // Generate public URL\n            const baseUrl = name.toLowerCase().replace(/[^a-z0-9]/g, \"-\").replace(/-+/g, \"-\");\n            let publicUrl = baseUrl;\n            let counter = 1;\n            while(await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    publicUrl\n                }\n            })){\n                publicUrl = `${baseUrl}-${counter}`;\n                counter++;\n            }\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.create({\n                data: {\n                    email: email.toLowerCase(),\n                    name,\n                    password: \"\",\n                    phone,\n                    alternateEmail,\n                    alternatePhone,\n                    role: role || \"AUTHOR\",\n                    isBlogWriter: isBlogWriter || false,\n                    authorUid,\n                    publicUrl,\n                    importSource: \"manual\"\n                },\n                select: {\n                    id: true,\n                    authorUid: true,\n                    email: true,\n                    name: true,\n                    role: true,\n                    phone: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user\n            });\n        }\n        // POST /api/admin/users/import - CSV import users\n        if (path === \"/admin/users/import\") {\n            const { users: usersData, importedById } = body;\n            if (!usersData || !Array.isArray(usersData)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Users array is required\"\n                }, {\n                    status: 400\n                });\n            }\n            const results = {\n                success: [],\n                errors: [],\n                skipped: []\n            };\n            for (const userData of usersData){\n                try {\n                    const { email, name, phone, role } = userData;\n                    if (!email || !name) {\n                        results.errors.push({\n                            email,\n                            error: \"Missing email or name\"\n                        });\n                        continue;\n                    }\n                    // Check if exists\n                    const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                        where: {\n                            email: email.toLowerCase()\n                        }\n                    });\n                    if (existing) {\n                        results.skipped.push({\n                            email,\n                            reason: \"Already exists\",\n                            existingId: existing.id\n                        });\n                        continue;\n                    }\n                    const authorUid = await (0,_lib_identity__WEBPACK_IMPORTED_MODULE_7__.generateAuthorUid)();\n                    const baseUrl = name.toLowerCase().replace(/[^a-z0-9]/g, \"-\").replace(/-+/g, \"-\");\n                    let publicUrl = baseUrl;\n                    let counter = 1;\n                    while(await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                        where: {\n                            publicUrl\n                        }\n                    })){\n                        publicUrl = `${baseUrl}-${counter}`;\n                        counter++;\n                    }\n                    const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.create({\n                        data: {\n                            email: email.toLowerCase(),\n                            name,\n                            password: \"\",\n                            phone,\n                            role: role || \"AUTHOR\",\n                            authorUid,\n                            publicUrl,\n                            importSource: \"csv\"\n                        }\n                    });\n                    results.success.push({\n                        email,\n                        authorUid: user.authorUid,\n                        id: user.id\n                    });\n                } catch (err) {\n                    results.errors.push({\n                        email: userData.email,\n                        error: err.message\n                    });\n                }\n            }\n            // Create import batch record\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].importBatch.create({\n                data: {\n                    type: \"users\",\n                    totalRows: usersData.length,\n                    successCount: results.success.length,\n                    errorCount: results.errors.length,\n                    status: \"completed\",\n                    importedById: importedById || \"system\",\n                    summary: results,\n                    completedAt: new Date()\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                results\n            });\n        }\n        // POST /api/admin/users/[id]/link-books - Link books to user\n        if (path.match(/^\\/admin\\/users\\/[^/]+\\/link-books$/)) {\n            const userId = pathSegments[2];\n            const { bookIds } = body;\n            if (!bookIds || !Array.isArray(bookIds)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"bookIds array required\"\n                }, {\n                    status: 400\n                });\n            }\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    id: userId\n                }\n            });\n            if (!user) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User not found\"\n                }, {\n                    status: 404\n                });\n            }\n            const results = await (0,_lib_identity__WEBPACK_IMPORTED_MODULE_7__.linkAuthorsToBook)(bookIds[0], [\n                userId\n            ]); // For now, link one book at a time\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                linked: results.length\n            });\n        }\n        // ==================== AUTHOR POST ROUTES ====================\n        // POST /api/author/queries - Create query\n        if (path === \"/author/queries\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const { subject, description, type, bookId, priority } = body;\n            if (!subject || !description) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Subject and description required\"\n                }, {\n                    status: 400\n                });\n            }\n            const query = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.create({\n                data: {\n                    authorId: userId,\n                    subject,\n                    description,\n                    type: type || \"GENERAL\",\n                    bookId: bookId || null,\n                    priority: priority || \"MEDIUM\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                query\n            });\n        }\n        // POST /api/author/queries/[id]/comments - Add comment to query\n        if (path.match(/^\\/author\\/queries\\/[^/]+\\/comments$/)) {\n            const queryId = pathSegments[2];\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const { comment } = body;\n            if (!comment) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Comment required\"\n                }, {\n                    status: 400\n                });\n            }\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    id: userId\n                }\n            });\n            if (!user) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"User not found\"\n                }, {\n                    status: 404\n                });\n            }\n            const newComment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].queryComment.create({\n                data: {\n                    queryId,\n                    userId,\n                    userName: user.name,\n                    userRole: user.role,\n                    comment\n                }\n            });\n            // Update query status\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.update({\n                where: {\n                    id: queryId\n                },\n                data: {\n                    status: \"WAITING_RESPONSE\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                comment: newComment\n            });\n        }\n        // POST /api/author/manuscripts - Create or update manuscript\n        if (path === \"/author/manuscripts\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const { id, bookId, content, fileName, fileUrl, isWordUpload, status } = body;\n            if (!bookId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"bookId required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check if updating existing manuscript\n            if (id) {\n                const updated = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].manuscript.update({\n                    where: {\n                        id\n                    },\n                    data: {\n                        content: content || undefined,\n                        fileName: fileName || undefined,\n                        fileUrl: fileUrl || undefined,\n                        isWordUpload: isWordUpload || false,\n                        status: status || \"DRAFT\"\n                    }\n                });\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    manuscript: updated\n                });\n            }\n            // Create new manuscript\n            const manuscript = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].manuscript.create({\n                data: {\n                    bookId,\n                    authorId: userId,\n                    fileName: fileName || \"manuscript\",\n                    fileUrl: fileUrl || \"\",\n                    content: content || null,\n                    isWordUpload: isWordUpload || false,\n                    status: status || \"DRAFT\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                manuscript\n            });\n        }\n        // POST /api/admin/content - Save site content\n        if (path === \"/admin/content\") {\n            const { key, content } = body;\n            if (!key) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Key required\"\n                }, {\n                    status: 400\n                });\n            }\n            const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteContent.findUnique({\n                where: {\n                    key\n                }\n            });\n            if (existing) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteContent.update({\n                    where: {\n                        key\n                    },\n                    data: {\n                        content\n                    }\n                });\n            } else {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteContent.create({\n                    data: {\n                        key,\n                        content\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // POST /api/admin/imports/validate - Validate import data\n        if (path === \"/admin/imports/validate\") {\n            const { type, data, mapping } = body;\n            if (!type || !data) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Type and data required\"\n                }, {\n                    status: 400\n                });\n            }\n            const errors = [];\n            const warnings = [];\n            let validCount = 0;\n            // Validate based on type\n            if (type === \"users\") {\n                for(let i = 0; i < data.length; i++){\n                    const row = data[i];\n                    const email = row[mapping[\"Email*\"]];\n                    const name = row[mapping[\"Name*\"]];\n                    if (!email) {\n                        errors.push({\n                            row: i + 2,\n                            message: \"Email is required\"\n                        });\n                    } else if (!/\\S+@\\S+\\.\\S+/.test(email)) {\n                        errors.push({\n                            row: i + 2,\n                            message: `Invalid email: ${email}`\n                        });\n                    } else {\n                        const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                            where: {\n                                email\n                            }\n                        });\n                        if (existing) {\n                            warnings.push({\n                                row: i + 2,\n                                message: `User already exists: ${email}`\n                            });\n                        } else {\n                            validCount++;\n                        }\n                    }\n                    if (!name) {\n                        errors.push({\n                            row: i + 2,\n                            message: \"Name is required\"\n                        });\n                    }\n                }\n            } else if (type === \"books\") {\n                for(let i = 0; i < data.length; i++){\n                    const row = data[i];\n                    const title = row[mapping[\"Title*\"]];\n                    const authorRef = row[mapping[\"Author UID/Email*\"]];\n                    if (!title) {\n                        errors.push({\n                            row: i + 2,\n                            message: \"Title is required\"\n                        });\n                    } else {\n                        validCount++;\n                    }\n                    if (!authorRef) {\n                        warnings.push({\n                            row: i + 2,\n                            message: \"No author specified\"\n                        });\n                    }\n                }\n            } else if (type === \"sales\") {\n                for(let i = 0; i < data.length; i++){\n                    const row = data[i];\n                    const isbn = row[mapping[\"ISBN*\"]];\n                    const platform = row[mapping[\"Platform*\"]];\n                    const amount = row[mapping[\"Amount*\"]];\n                    if (!isbn) {\n                        errors.push({\n                            row: i + 2,\n                            message: \"ISBN is required\"\n                        });\n                    }\n                    if (!platform) {\n                        errors.push({\n                            row: i + 2,\n                            message: \"Platform is required\"\n                        });\n                    }\n                    if (!amount || isNaN(parseFloat(amount))) {\n                        errors.push({\n                            row: i + 2,\n                            message: \"Valid amount is required\"\n                        });\n                    }\n                    if (isbn && platform && amount && !isNaN(parseFloat(amount))) {\n                        validCount++;\n                    }\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                validCount,\n                errors,\n                warnings\n            });\n        }\n        // POST /api/admin/imports/execute - Execute import\n        if (path === \"/admin/imports/execute\") {\n            const { type, data, mapping } = body;\n            const importedById = request.headers.get(\"x-user-id\") || \"system\";\n            if (!type || !data) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Type and data required\"\n                }, {\n                    status: 400\n                });\n            }\n            let successCount = 0;\n            let errorCount = 0;\n            const errors = [];\n            // Execute import based on type\n            if (type === \"users\") {\n                for (const row of data){\n                    try {\n                        const email = row[mapping[\"Email*\"]];\n                        const name = row[mapping[\"Name*\"]];\n                        const phone = row[mapping[\"Phone\"]];\n                        const role = row[mapping[\"Role\"]] || \"AUTHOR\";\n                        if (!email || !name) continue;\n                        const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                            where: {\n                                email\n                            }\n                        });\n                        if (existing) {\n                            errorCount++;\n                            errors.push({\n                                email,\n                                message: \"Already exists\"\n                            });\n                            continue;\n                        }\n                        // Generate author UID\n                        const seq = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].authorUidSequence.upsert({\n                            where: {\n                                id: \"singleton\"\n                            },\n                            update: {\n                                lastValue: {\n                                    increment: 1\n                                }\n                            },\n                            create: {\n                                id: \"singleton\",\n                                lastValue: 1\n                            }\n                        });\n                        const authorUid = `WP${String(seq.lastValue).padStart(5, \"0\")}`;\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.create({\n                            data: {\n                                email,\n                                name,\n                                phone,\n                                role: role.toUpperCase() === \"ADMIN\" ? \"ADMIN\" : role.toUpperCase() === \"TEAM\" ? \"TEAM\" : \"AUTHOR\",\n                                password: await bcryptjs__WEBPACK_IMPORTED_MODULE_2__[\"default\"].hash(\"temp123\", 12),\n                                authorUid,\n                                importSource: \"csv\"\n                            }\n                        });\n                        successCount++;\n                    } catch (e) {\n                        errorCount++;\n                        errors.push({\n                            message: e.message\n                        });\n                    }\n                }\n            } else if (type === \"books\") {\n                for (const row of data){\n                    try {\n                        const title = row[mapping[\"Title*\"]];\n                        const authorRef = row[mapping[\"Author UID/Email*\"]];\n                        const isbnPaperback = row[mapping[\"Paperback ISBN\"]];\n                        const isbnHardcover = row[mapping[\"Hardcover ISBN\"]];\n                        const category = row[mapping[\"Category\"]];\n                        const description = row[mapping[\"Description\"]];\n                        if (!title) continue;\n                        // Find author\n                        let author = null;\n                        if (authorRef) {\n                            author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findFirst({\n                                where: {\n                                    OR: [\n                                        {\n                                            email: authorRef\n                                        },\n                                        {\n                                            authorUid: authorRef\n                                        }\n                                    ]\n                                }\n                            });\n                        }\n                        if (!author) {\n                            // Create placeholder author or skip\n                            errorCount++;\n                            errors.push({\n                                title,\n                                message: \"Author not found\"\n                            });\n                            continue;\n                        }\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.create({\n                            data: {\n                                title,\n                                authorId: author.id,\n                                isbnPaperback,\n                                isbnHardcover,\n                                category,\n                                description,\n                                status: \"DRAFT\",\n                                importSource: \"csv\"\n                            }\n                        });\n                        successCount++;\n                    } catch (e) {\n                        errorCount++;\n                        errors.push({\n                            message: e.message\n                        });\n                    }\n                }\n            } else if (type === \"sales\") {\n                const batchId = `import-${Date.now()}`;\n                for (const row of data){\n                    try {\n                        const isbn = row[mapping[\"ISBN*\"]];\n                        const platform = row[mapping[\"Platform*\"]];\n                        const dateStr = row[mapping[\"Date*\"]];\n                        const quantity = parseInt(row[mapping[\"Quantity*\"]] || \"1\");\n                        const amount = parseFloat(row[mapping[\"Amount*\"]]);\n                        if (!isbn || !platform || isNaN(amount)) continue;\n                        // Find book by ISBN\n                        const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findFirst({\n                            where: {\n                                OR: [\n                                    {\n                                        isbn\n                                    },\n                                    {\n                                        isbnPaperback: isbn\n                                    },\n                                    {\n                                        isbnHardcover: isbn\n                                    }\n                                ]\n                            }\n                        });\n                        if (!book) {\n                            errorCount++;\n                            errors.push({\n                                isbn,\n                                message: \"Book not found\"\n                            });\n                            continue;\n                        }\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].sale.create({\n                            data: {\n                                bookId: book.id,\n                                isbnUsed: isbn,\n                                platform,\n                                saleDate: dateStr ? new Date(dateStr) : new Date(),\n                                quantity,\n                                unitPrice: amount / quantity,\n                                totalAmount: amount,\n                                importBatchId: batchId,\n                                importSource: \"csv\"\n                            }\n                        });\n                        // Generate royalty\n                        const bucket = platform.toLowerCase().includes(\"website\") ? \"WEBSITE\" : platform.toLowerCase().includes(\"ebook\") || platform.toLowerCase().includes(\"kindle\") ? \"EBOOK\" : \"ECOMMERCE\";\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.create({\n                            data: {\n                                authorId: book.authorId,\n                                bookId: book.id,\n                                saleAmount: amount,\n                                amount: amount * 0.10,\n                                royaltyRate: 0.10,\n                                bucket,\n                                platform,\n                                period: new Date().toISOString().slice(0, 7)\n                            }\n                        });\n                        successCount++;\n                    } catch (e) {\n                        errorCount++;\n                        errors.push({\n                            message: e.message\n                        });\n                    }\n                }\n            }\n            // Create import batch record\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].importBatch.create({\n                data: {\n                    type,\n                    totalRows: data.length,\n                    successCount,\n                    errorCount,\n                    status: \"completed\",\n                    importedById,\n                    errors: errors.length > 0 ? errors : null,\n                    completedAt: new Date()\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                successCount,\n                errorCount,\n                errors\n            });\n        }\n        // ==================== ADMIN ORDERS POST ROUTES ====================\n        // POST /api/admin/orders/stages - Create order stage\n        if (path === \"/admin/orders/stages\") {\n            const { name, description, color, sortOrder } = body;\n            if (!name) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage name is required\"\n                }, {\n                    status: 400\n                });\n            }\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].orderStage.create({\n                data: {\n                    name,\n                    description,\n                    color,\n                    sortOrder: sortOrder || 0\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage\n            });\n        }\n        // POST /api/admin/orders/[id]/move-stage - Move order to stage\n        if (path.match(/^\\/admin\\/orders\\/[^/]+\\/move-stage$/)) {\n            const orderId = pathSegments[2];\n            const { stageId, notes, movedById } = body;\n            const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.update({\n                where: {\n                    id: orderId\n                },\n                data: {\n                    currentStageId: stageId\n                }\n            });\n            // Record history\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].orderStageHistory.create({\n                data: {\n                    orderId,\n                    stageId,\n                    notes,\n                    movedById\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                order\n            });\n        }\n        // ==================== ADMIN ROYALTIES POST ROUTES ====================\n        // POST /api/admin/royalties/mark-paid - Mark royalties as paid and notify authors\n        if (path === \"/admin/royalties/mark-paid\") {\n            const { royaltyIds, paymentRef, markedById } = body;\n            if (!royaltyIds || !Array.isArray(royaltyIds)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"royaltyIds array required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Get royalties with author info before updating\n            const royaltiesToMark = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.findMany({\n                where: {\n                    id: {\n                        in: royaltyIds\n                    }\n                },\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    },\n                    book: {\n                        select: {\n                            title: true\n                        }\n                    }\n                }\n            });\n            // Update royalties\n            const updated = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.updateMany({\n                where: {\n                    id: {\n                        in: royaltyIds\n                    }\n                },\n                data: {\n                    isPaid: true,\n                    paidAt: new Date(),\n                    paymentRef\n                }\n            });\n            // Create notifications for each unique author\n            const authorGroups = {};\n            for (const r of royaltiesToMark){\n                if (!authorGroups[r.authorId]) {\n                    authorGroups[r.authorId] = {\n                        amount: 0,\n                        books: []\n                    };\n                }\n                authorGroups[r.authorId].amount += r.amount;\n                if (!authorGroups[r.authorId].books.includes(r.book?.title)) {\n                    authorGroups[r.authorId].books.push(r.book?.title);\n                }\n            }\n            // Create notification for each author\n            for (const [authorId, data] of Object.entries(authorGroups)){\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].notification.create({\n                    data: {\n                        userId: authorId,\n                        type: \"ROYALTY_PAYMENT\",\n                        title: \"Royalty Payment Processed\",\n                        message: `Your royalty payment of ${data.amount.toLocaleString()} has been processed for ${data.books.join(\", \")}.`,\n                        link: \"/author/royalties\"\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                updated: updated.count,\n                notified: Object.keys(authorGroups).length\n            });\n        }\n        // POST /api/admin/books/{bookId}/royalty-config - Create/Update royalty config\n        if (path.match(/^\\/admin\\/books\\/[^/]+\\/royalty-config$/)) {\n            const bookId = pathSegments[2];\n            const { platform, royaltyAmount } = body;\n            if (!platform || royaltyAmount === undefined) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"platform and royaltyAmount required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Check if config exists\n            const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bookRoyaltyConfig.findUnique({\n                where: {\n                    bookId_platform: {\n                        bookId,\n                        platform\n                    }\n                }\n            });\n            let config;\n            if (existing) {\n                config = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bookRoyaltyConfig.update({\n                    where: {\n                        id: existing.id\n                    },\n                    data: {\n                        royaltyAmount: parseFloat(royaltyAmount),\n                        isActive: true\n                    }\n                });\n            } else {\n                config = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bookRoyaltyConfig.create({\n                    data: {\n                        bookId,\n                        platform,\n                        royaltyAmount: parseFloat(royaltyAmount)\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                config\n            });\n        }\n        // POST /api/admin/royalties/generate - Generate royalties from sales using AMOUNT-BASED model\n        if (path === \"/admin/royalties/generate\") {\n            const { bookId, quantity, platform, period } = body;\n            if (!bookId || !quantity) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"bookId and quantity required\"\n                }, {\n                    status: 400\n                });\n            }\n            const bucket = (0,_lib_identity__WEBPACK_IMPORTED_MODULE_7__.getRoyaltyBucket)(platform);\n            // Get book, its authors, and royalty config\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                where: {\n                    id: bookId\n                },\n                include: {\n                    authors: {\n                        include: {\n                            author: true\n                        }\n                    },\n                    author: true,\n                    royaltyConfigs: {\n                        where: {\n                            platform,\n                            isActive: true\n                        }\n                    }\n                }\n            });\n            if (!book) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Book not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Get royalty amount from config\n            const royaltyConfig = book.royaltyConfigs[0];\n            const royaltyPerUnit = royaltyConfig?.royaltyAmount || 0;\n            if (royaltyPerUnit === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"No royalty amount configured for this book/platform combination\",\n                    hint: \"Configure royalty amount first in Sales > Royalty Configuration\"\n                }, {\n                    status: 400\n                });\n            }\n            // Determine authors\n            let authors = book.authors.map((ba)=>({\n                    id: ba.author.id,\n                    authorUid: ba.author.authorUid,\n                    share: ba.royaltyShare\n                }));\n            if (authors.length === 0 && book.author) {\n                authors = [\n                    {\n                        id: book.author.id,\n                        authorUid: book.author.authorUid,\n                        share: 100\n                    }\n                ];\n            }\n            const totalRoyalty = royaltyPerUnit * quantity;\n            const royalties = [];\n            for (const author of authors){\n                const share = author.share !== null ? author.share / 100 : 1 / authors.length;\n                const royalty = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.create({\n                    data: {\n                        authorId: author.id,\n                        authorUid: author.authorUid,\n                        bookId,\n                        amount: totalRoyalty * share,\n                        royaltyRate: 0,\n                        saleAmount: 0,\n                        quantity,\n                        bucket,\n                        platform,\n                        period: period || new Date().toISOString().slice(0, 7)\n                    }\n                });\n                royalties.push(royalty);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                royalties,\n                royaltyPerUnit,\n                totalRoyalty\n            });\n        }\n        // POST /api/admin/sales/import - Import sales data and auto-generate royalties\n        if (path === \"/admin/sales/import\") {\n            const { sales: salesData } = body;\n            if (!salesData || !Array.isArray(salesData)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"sales array required\"\n                }, {\n                    status: 400\n                });\n            }\n            const results = {\n                success: [],\n                errors: [],\n                royaltiesGenerated: 0\n            };\n            for (const saleItem of salesData){\n                try {\n                    const { isbn, platform, quantity, saleDate, unitPrice } = saleItem;\n                    // Find book by ISBN\n                    const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findFirst({\n                        where: {\n                            OR: [\n                                {\n                                    isbn: isbn\n                                },\n                                {\n                                    isbnPaperback: isbn\n                                },\n                                {\n                                    isbnHardcover: isbn\n                                },\n                                {\n                                    isbnEbook: isbn\n                                }\n                            ]\n                        },\n                        include: {\n                            authors: {\n                                include: {\n                                    author: true\n                                }\n                            },\n                            author: true,\n                            royaltyConfigs: {\n                                where: {\n                                    platform,\n                                    isActive: true\n                                }\n                            }\n                        }\n                    });\n                    if (!book) {\n                        results.errors.push({\n                            isbn,\n                            error: \"Book not found\"\n                        });\n                        continue;\n                    }\n                    // Create sale record\n                    const sale = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].sale.create({\n                        data: {\n                            bookId: book.id,\n                            isbnUsed: isbn,\n                            platform,\n                            quantity: parseInt(quantity) || 1,\n                            unitPrice: parseFloat(unitPrice) || 0,\n                            totalAmount: (parseFloat(unitPrice) || 0) * (parseInt(quantity) || 1),\n                            saleDate: new Date(saleDate),\n                            importSource: \"CSV\"\n                        }\n                    });\n                    results.success.push({\n                        isbn,\n                        saleId: sale.id\n                    });\n                    // Auto-generate royalties if config exists\n                    const royaltyConfig = book.royaltyConfigs[0];\n                    if (royaltyConfig) {\n                        const bucket = (0,_lib_identity__WEBPACK_IMPORTED_MODULE_7__.getRoyaltyBucket)(platform);\n                        let authors = book.authors.map((ba)=>({\n                                id: ba.author.id,\n                                authorUid: ba.author.authorUid,\n                                share: ba.royaltyShare\n                            }));\n                        if (authors.length === 0 && book.author) {\n                            authors = [\n                                {\n                                    id: book.author.id,\n                                    authorUid: book.author.authorUid,\n                                    share: 100\n                                }\n                            ];\n                        }\n                        const totalRoyalty = royaltyConfig.royaltyAmount * (parseInt(quantity) || 1);\n                        for (const author of authors){\n                            const share = author.share !== null ? author.share / 100 : 1 / authors.length;\n                            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].royalty.create({\n                                data: {\n                                    authorId: author.id,\n                                    authorUid: author.authorUid,\n                                    bookId: book.id,\n                                    saleId: sale.id,\n                                    amount: totalRoyalty * share,\n                                    royaltyRate: 0,\n                                    saleAmount: sale.totalAmount,\n                                    quantity: parseInt(quantity) || 1,\n                                    bucket,\n                                    platform,\n                                    period: new Date(saleDate).toISOString().slice(0, 7)\n                                }\n                            });\n                            results.royaltiesGenerated++;\n                        }\n                    }\n                } catch (error) {\n                    results.errors.push({\n                        ...saleItem,\n                        error: error.message\n                    });\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                results\n            });\n        }\n        // ==================== ADMIN LEADS POST ROUTES ====================\n        // POST /api/admin/leads - Create lead\n        if (path === \"/admin/leads\") {\n            const { name, email, phone, alternateEmail, alternatePhone, source, interestArea, contractAmount, deadline, deadlineSeverity, assignedToId, notes, createdById, stage } = body;\n            if (!name || !email) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name and email are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Handle empty strings - convert to null for UUID fields\n            const cleanAssignedToId = assignedToId && assignedToId.trim() !== \"\" ? assignedToId : null;\n            const cleanCreatedById = createdById && createdById.trim() !== \"\" ? createdById : null;\n            const lead = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.create({\n                data: {\n                    name,\n                    email,\n                    phone: phone || null,\n                    alternateEmail: alternateEmail || null,\n                    alternatePhone: alternatePhone || null,\n                    source: source || \"WEBSITE\",\n                    interestArea: interestArea || null,\n                    contractAmount: contractAmount ? parseFloat(contractAmount) : null,\n                    deadline: deadline ? new Date(deadline) : null,\n                    deadlineSeverity: deadlineSeverity || \"MEDIUM\",\n                    assignedToId: cleanAssignedToId,\n                    createdById: cleanCreatedById,\n                    status: stage || \"NEW\"\n                }\n            });\n            // Add initial note if provided\n            if (notes) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].leadNote.create({\n                    data: {\n                        leadId: lead.id,\n                        content: notes,\n                        createdById\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lead: {\n                    ...lead,\n                    stage: lead.status\n                }\n            });\n        }\n        // POST /api/admin/leads/[id]/notes - Add note to lead\n        if (path.match(/^\\/admin\\/leads\\/[^/]+\\/notes$/)) {\n            const leadId = pathSegments[2];\n            const { content, createdById, createdByName } = body;\n            if (!content) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Content is required\"\n                }, {\n                    status: 400\n                });\n            }\n            const lead = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.findUnique({\n                where: {\n                    id: leadId\n                }\n            });\n            if (!lead) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Lead not found\"\n                }, {\n                    status: 404\n                });\n            }\n            const note = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].leadNote.create({\n                data: {\n                    leadId,\n                    content,\n                    createdById\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                note\n            });\n        }\n        // POST /api/admin/site-settings - Save site settings\n        if (path === \"/admin/site-settings\") {\n            const settings = body;\n            // Save each category of settings\n            for (const [category, values] of Object.entries(settings)){\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].siteSetting.upsert({\n                    where: {\n                        key: category\n                    },\n                    update: {\n                        value: values\n                    },\n                    create: {\n                        key: category,\n                        value: values\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // ==================== ADMIN BOOKS POST ROUTES ====================\n        // POST /api/admin/books - Create book from admin\n        if (path === \"/admin/books\") {\n            const { title, authorId, authorUid, authorEmail, category, description, isbnPaperback, isbnHardcover, allowWordUpload } = body;\n            // Validation: Title required\n            if (!title) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Title is required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Validation: Exactly one of authorId, authorUid, or authorEmail required\n            const authorIdentifiers = [\n                authorId,\n                authorUid,\n                authorEmail\n            ].filter(Boolean);\n            if (authorIdentifiers.length === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author identification required. Provide one of: authorId, authorUid, or authorEmail\"\n                }, {\n                    status: 400\n                });\n            }\n            // Find author by ID, UID, or Email\n            let author = null;\n            if (authorId) {\n                author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                    where: {\n                        id: authorId\n                    }\n                });\n                if (!author) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: \"Author not found with provided ID\"\n                    }, {\n                        status: 404\n                    });\n                }\n            } else if (authorUid) {\n                author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                    where: {\n                        authorUid\n                    }\n                });\n                if (!author) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: `Author not found with UID: ${authorUid}`\n                    }, {\n                        status: 404\n                    });\n                }\n            } else if (authorEmail) {\n                author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                    where: {\n                        email: authorEmail.toLowerCase()\n                    }\n                });\n                if (!author) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: `Author not found with email: ${authorEmail}`\n                    }, {\n                        status: 404\n                    });\n                }\n            }\n            // Create book with publishing stages (ISBN is optional)\n            // Only INITIAL_REVIEW is visible by default, others are hidden\n            const publishingStageTypes = [\n                {\n                    type: \"MANUSCRIPT_RECEIVED\",\n                    visible: false\n                },\n                {\n                    type: \"INITIAL_REVIEW\",\n                    visible: true\n                },\n                {\n                    type: \"EDITING\",\n                    visible: false\n                },\n                {\n                    type: \"PROOFREADING\",\n                    visible: false\n                },\n                {\n                    type: \"COVER_DESIGN\",\n                    visible: false\n                },\n                {\n                    type: \"INTERIOR_FORMATTING\",\n                    visible: false\n                },\n                {\n                    type: \"FINAL_REVIEW\",\n                    visible: false\n                },\n                {\n                    type: \"ISBN_ASSIGNMENT\",\n                    visible: false\n                },\n                {\n                    type: \"PRINTING\",\n                    visible: false\n                },\n                {\n                    type: \"DISTRIBUTION\",\n                    visible: false\n                },\n                {\n                    type: \"COMPLETED\",\n                    visible: false\n                }\n            ];\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.create({\n                data: {\n                    title,\n                    authorId: author.id,\n                    category: category || null,\n                    description: description || null,\n                    isbnPaperback: isbnPaperback || null,\n                    isbnHardcover: isbnHardcover || null,\n                    isbn: isbnPaperback || null,\n                    status: \"DRAFT\",\n                    allowWordUpload: allowWordUpload || false,\n                    publishingStages: {\n                        create: publishingStageTypes.map((stage, index)=>({\n                                stageType: stage.type,\n                                stageOrder: index + 1,\n                                status: stage.type === \"INITIAL_REVIEW\" ? \"PENDING\" : \"PENDING\",\n                                isVisible: stage.visible\n                            }))\n                    }\n                },\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            authorUid: true\n                        }\n                    },\n                    publishingStages: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book\n            });\n        }\n        // POST /api/admin/books/import - Bulk import books\n        if (path === \"/admin/books/import\") {\n            const { books: booksData } = body;\n            if (!booksData || !Array.isArray(booksData)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Books array is required\"\n                }, {\n                    status: 400\n                });\n            }\n            const results = {\n                success: [],\n                errors: [],\n                skipped: []\n            };\n            for (const bookData of booksData){\n                try {\n                    const { title, authorUid, authorEmail, isbnPaperback, isbnHardcover, category } = bookData;\n                    if (!title) {\n                        results.errors.push({\n                            title: title || \"Unknown\",\n                            error: \"Title is required\"\n                        });\n                        continue;\n                    }\n                    // Find author by UID or email (at least one required)\n                    let author = null;\n                    if (authorUid) {\n                        author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                            where: {\n                                authorUid\n                            }\n                        });\n                    }\n                    if (!author && authorEmail) {\n                        author = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                            where: {\n                                email: authorEmail.toLowerCase()\n                            }\n                        });\n                    }\n                    if (!author) {\n                        results.errors.push({\n                            title,\n                            error: `Author not found. Provided: ${authorUid ? `UID=${authorUid}` : \"\"} ${authorEmail ? `Email=${authorEmail}` : \"\"}`.trim()\n                        });\n                        continue;\n                    }\n                    // Check for duplicate ISBN\n                    if (isbnPaperback) {\n                        const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.findUnique({\n                            where: {\n                                isbnPaperback\n                            }\n                        });\n                        if (existing) {\n                            results.skipped.push({\n                                title,\n                                reason: `Paperback ISBN ${isbnPaperback} already exists`\n                            });\n                            continue;\n                        }\n                    }\n                    const publishingStageTypes = [\n                        \"MANUSCRIPT_RECEIVED\",\n                        \"INITIAL_REVIEW\",\n                        \"EDITING\",\n                        \"PROOFREADING\",\n                        \"COVER_DESIGN\",\n                        \"INTERIOR_FORMATTING\",\n                        \"FINAL_REVIEW\",\n                        \"ISBN_ASSIGNMENT\",\n                        \"PRINTING\",\n                        \"DISTRIBUTION\",\n                        \"COMPLETED\"\n                    ];\n                    const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.create({\n                        data: {\n                            title,\n                            authorId: author.id,\n                            category: category || null,\n                            isbnPaperback: isbnPaperback || null,\n                            isbnHardcover: isbnHardcover || null,\n                            isbn: isbnPaperback || null,\n                            status: \"DRAFT\",\n                            publishingStages: {\n                                create: publishingStageTypes.map((type, index)=>({\n                                        stageType: type,\n                                        stageOrder: index + 1,\n                                        status: index === 0 ? \"IN_PROGRESS\" : \"PENDING\"\n                                    }))\n                            }\n                        }\n                    });\n                    results.success.push({\n                        title,\n                        id: book.id\n                    });\n                } catch (error) {\n                    results.errors.push({\n                        title: bookData.title || \"Unknown\",\n                        error: error.message\n                    });\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                results\n            });\n        }\n        // ==================== ADMIN PACKAGES POST ROUTES ====================\n        // POST /api/admin/packages - Create package\n        if (path === \"/admin/packages\") {\n            const { name, description, price, features, isPopular, sortOrder } = body;\n            if (!name || price === undefined) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name and price are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const pkg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingPackage.create({\n                data: {\n                    name,\n                    description,\n                    price,\n                    features: features || [],\n                    isPopular: isPopular || false,\n                    sortOrder: sortOrder || 0,\n                    isActive: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                package: pkg\n            });\n        }\n        // POST /api/categories\n        if (path === \"/categories\") {\n            const { name: catName, description: catDesc, parentId, seoTitle, seoDesc } = body;\n            if (!catName) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name is required\"\n                }, {\n                    status: 400\n                });\n            }\n            let slug = catName.toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/-+/g, \"-\");\n            let counter = 1;\n            while(await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].category.findUnique({\n                where: {\n                    slug\n                }\n            })){\n                slug = `${catName.toLowerCase().replace(/[^a-z0-9]+/g, \"-\")}-${counter}`;\n                counter++;\n            }\n            const category = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].category.create({\n                data: {\n                    name: catName,\n                    slug,\n                    description: catDesc,\n                    parentId,\n                    seoTitle: seoTitle || catName,\n                    seoDesc\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                category\n            });\n        }\n        // ==================== BLOG POST ROUTES ====================\n        // POST /api/blog - Create blog post (admin/blog writer)\n        if (path === \"/blog\") {\n            const { title: blogTitle, content: blogContent, excerpt, coverImage, authorName, authorId: blogAuthorId, category: blogCategory, tags, isPublished, linkedBookId, seoTitle, seoDesc } = body;\n            if (!blogTitle || !blogContent) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Title and content are required\"\n                }, {\n                    status: 400\n                });\n            }\n            // Generate slug\n            let slug = blogTitle.toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\");\n            let counter = 1;\n            while(await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                where: {\n                    slug\n                }\n            })){\n                slug = `${blogTitle.toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/-+/g, \"-\")}-${counter}`;\n                counter++;\n            }\n            const post = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.create({\n                data: {\n                    title: blogTitle,\n                    slug,\n                    content: blogContent,\n                    excerpt: excerpt || blogContent.substring(0, 200) + \"...\",\n                    coverImage,\n                    authorName: authorName || \"Admin\",\n                    authorId: blogAuthorId,\n                    category: blogCategory,\n                    tags: tags ? Array.isArray(tags) ? tags : tags.split(\",\").map((t)=>t.trim()) : null,\n                    isPublished: isPublished || false,\n                    publishedAt: isPublished ? new Date() : null,\n                    linkedBookId,\n                    seoTitle: seoTitle || blogTitle,\n                    seoDesc: seoDesc || excerpt\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                post\n            });\n        }\n        // POST /api/blog/[slug]/comment - Add comment to blog post\n        if (path.match(/^\\/blog\\/[^/]+\\/comment$/)) {\n            const slug = pathSegments[1];\n            const { authorName: commentAuthor, authorEmail, content: commentContent } = body;\n            if (!commentAuthor || !commentContent) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name and comment are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const post = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                where: {\n                    slug\n                }\n            });\n            if (!post || !post.isPublished) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Post not found\"\n                }, {\n                    status: 404\n                });\n            }\n            const comment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogComment.create({\n                data: {\n                    postId: post.id,\n                    authorName: commentAuthor,\n                    authorEmail,\n                    content: commentContent,\n                    isApproved: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                comment,\n                message: \"Comment submitted for moderation\"\n            });\n        }\n        // POST /api/blog/[slug]/like - Like a blog post\n        if (path.match(/^\\/blog\\/[^/]+\\/like$/)) {\n            const slug = pathSegments[1];\n            const { visitorId } = body;\n            if (!visitorId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Visitor ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const post = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                where: {\n                    slug\n                }\n            });\n            if (!post || !post.isPublished) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Post not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Check if already liked\n            const existingLike = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogLike.findUnique({\n                where: {\n                    postId_visitorId: {\n                        postId: post.id,\n                        visitorId\n                    }\n                }\n            });\n            if (existingLike) {\n                // Unlike\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogLike.delete({\n                    where: {\n                        id: existingLike.id\n                    }\n                });\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    liked: false\n                });\n            }\n            // Add like\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogLike.create({\n                data: {\n                    postId: post.id,\n                    visitorId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                liked: true\n            });\n        }\n        // POST /api/guest-posts - Submit guest post\n        if (path === \"/guest-posts\") {\n            const { title: guestTitle, content: guestContent, writerName, email: guestEmail, phone: guestPhone, socialLinks: guestSocialLinks } = body;\n            if (!guestTitle || !guestContent || !writerName || !guestEmail) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Title, content, writer name, and email are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const guestPost = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].guestPost.create({\n                data: {\n                    title: guestTitle,\n                    content: guestContent,\n                    writerName,\n                    email: guestEmail,\n                    phone: guestPhone,\n                    socialLinks: guestSocialLinks,\n                    status: \"pending\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                guestPost,\n                message: \"Guest post submitted for review\"\n            });\n        }\n        // POST /api/admin/blog/comments/[id]/approve - Approve comment\n        if (path.match(/^\\/admin\\/blog\\/comments\\/[^/]+\\/approve$/)) {\n            const commentId = pathSegments[3];\n            const { approved } = body;\n            const comment = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogComment.update({\n                where: {\n                    id: commentId\n                },\n                data: {\n                    isApproved: approved !== false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                comment\n            });\n        }\n        // POST /api/admin/guest-posts/[id]/review - Review guest post\n        if (path.match(/^\\/admin\\/guest-posts\\/[^/]+\\/review$/)) {\n            const guestPostId = pathSegments[2];\n            const { status: reviewStatus, rejectReason, reviewedBy } = body;\n            if (![\n                \"approved\",\n                \"rejected\"\n            ].includes(reviewStatus)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Invalid status\"\n                }, {\n                    status: 400\n                });\n            }\n            const guestPost = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].guestPost.update({\n                where: {\n                    id: guestPostId\n                },\n                data: {\n                    status: reviewStatus,\n                    rejectReason: reviewStatus === \"rejected\" ? rejectReason : null,\n                    reviewedBy,\n                    reviewedAt: new Date()\n                }\n            });\n            // If approved, create a blog post\n            if (reviewStatus === \"approved\") {\n                let slug = guestPost.title.toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/-+/g, \"-\");\n                let counter = 1;\n                while(await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                    where: {\n                        slug\n                    }\n                })){\n                    slug = `${guestPost.title.toLowerCase().replace(/[^a-z0-9]+/g, \"-\")}-${counter}`;\n                    counter++;\n                }\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.create({\n                    data: {\n                        title: guestPost.title,\n                        slug,\n                        content: guestPost.content,\n                        excerpt: guestPost.content.substring(0, 200) + \"...\",\n                        authorName: guestPost.writerName,\n                        category: \"Guest Post\",\n                        isPublished: true,\n                        publishedAt: new Date()\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                guestPost\n            });\n        }\n        // POST /api/addons\n        if (path === \"/addons\") {\n            const { name: addonName, description: addonDesc, serviceType: addonService, basePrice, pricingType, pricingTiers } = body;\n            if (!addonName || !addonService || basePrice === undefined) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name, service type, and base price are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const addOn = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].serviceAddOn.create({\n                data: {\n                    name: addonName,\n                    description: addonDesc,\n                    serviceType: addonService,\n                    basePrice,\n                    pricingType: pricingType || \"fixed\",\n                    pricingTiers\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                addOn\n            });\n        }\n        // POST /api/reviews\n        if (path === \"/reviews\") {\n            const { bookId: reviewBookId, authorName: reviewAuthor, bookTitle: reviewBookTitle, rating, content: reviewContent, source, displayOn } = body;\n            if (!reviewAuthor || !rating || !reviewContent) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Author name, rating, and content are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const review = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].review.create({\n                data: {\n                    bookId: reviewBookId,\n                    authorName: reviewAuthor,\n                    bookTitle: reviewBookTitle,\n                    rating,\n                    content: reviewContent,\n                    source,\n                    displayOn,\n                    isApproved: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                review\n            });\n        }\n        // POST /api/discounts\n        if (path === \"/discounts\") {\n            const { name: discName, code: discCode, discountType, discountValue, appliesTo, startsAt, expiresAt, showTimer, maxUses } = body;\n            if (!discName || !discountValue || !appliesTo) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Name, discount value, and applies to are required\"\n                }, {\n                    status: 400\n                });\n            }\n            const discount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].discount.create({\n                data: {\n                    name: discName,\n                    code: discCode,\n                    discountType: discountType || \"percentage\",\n                    discountValue,\n                    appliesTo,\n                    startsAt: startsAt ? new Date(startsAt) : null,\n                    expiresAt: expiresAt ? new Date(expiresAt) : null,\n                    showTimer: showTimer || false,\n                    maxUses\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                discount\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Not found\"\n        }, {\n            status: 404\n        });\n    } catch (error) {\n        console.error(\"API POST Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PUT(request, context) {\n    const params = await context.params;\n    const pathSegments = params?.path || [];\n    const path = \"/\" + pathSegments.join(\"/\");\n    try {\n        // Parse body\n        let body = {};\n        try {\n            body = await request.json();\n        } catch (e) {\n        // Body might be empty\n        }\n        // ==================== AUTHOR PUT ROUTES ====================\n        // PUT /api/author/settings/profile - Update author profile\n        if (path === \"/author/settings/profile\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const { name, phone, alternateEmail, alternatePhone, bio, website, publicUrl, socialLinks } = body;\n            const updateData = {};\n            if (name !== undefined) updateData.name = name;\n            if (phone !== undefined) updateData.phone = phone;\n            if (alternateEmail !== undefined) updateData.alternateEmail = alternateEmail;\n            if (alternatePhone !== undefined) updateData.alternatePhone = alternatePhone;\n            if (bio !== undefined) updateData.bio = bio;\n            if (website !== undefined) updateData.website = website;\n            if (publicUrl !== undefined) updateData.publicUrl = publicUrl;\n            if (socialLinks !== undefined) updateData.socialLinks = socialLinks;\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.update({\n                where: {\n                    id: userId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                user\n            });\n        }\n        // PUT /api/author/settings/bank - Update author bank details\n        if (path === \"/author/settings/bank\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const { accountName, accountNumber, bankName, ifscCode, branchName } = body;\n            const existing = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bankDetails.findUnique({\n                where: {\n                    userId\n                }\n            });\n            if (existing) {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bankDetails.update({\n                    where: {\n                        userId\n                    },\n                    data: {\n                        accountName,\n                        accountNumber,\n                        bankName,\n                        ifscCode,\n                        branchName\n                    }\n                });\n            } else {\n                await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bankDetails.create({\n                    data: {\n                        userId,\n                        accountName,\n                        accountNumber,\n                        bankName,\n                        ifscCode,\n                        branchName\n                    }\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // PUT /api/author/manuscripts - Update manuscript status\n        if (path === \"/author/manuscripts\") {\n            const userId = request.headers.get(\"x-user-id\");\n            if (!userId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Unauthorized\"\n                }, {\n                    status: 401\n                });\n            }\n            const { id, status, content, fileName, fileUrl, isWordUpload } = body;\n            if (!id) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Manuscript ID required\"\n                }, {\n                    status: 400\n                });\n            }\n            const updateData = {};\n            if (status !== undefined) updateData.status = status;\n            if (content !== undefined) updateData.content = content;\n            if (fileName !== undefined) updateData.fileName = fileName;\n            if (fileUrl !== undefined) updateData.fileUrl = fileUrl;\n            if (isWordUpload !== undefined) updateData.isWordUpload = isWordUpload;\n            const manuscript = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].manuscript.update({\n                where: {\n                    id\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                manuscript\n            });\n        }\n        // PUT /api/author/settings/notifications - Update notification preferences\n        if (path === \"/author/settings/notifications\") {\n            // For now, just acknowledge - these would normally be stored in a settings table\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // ==================== ADMIN LEADS PUT ROUTES ====================\n        // PUT /api/admin/leads/[id] - Update lead\n        if (path.startsWith(\"/admin/leads/\") && pathSegments.length === 3) {\n            const leadId = pathSegments[2];\n            const { stage, status, contractAmount, deadline, deadlineSeverity, assignedToId, interestArea, name, email, phone } = body;\n            const lead = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.findUnique({\n                where: {\n                    id: leadId\n                }\n            });\n            if (!lead) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Lead not found\"\n                }, {\n                    status: 404\n                });\n            }\n            const updateData = {};\n            // Track stage/status change (accept both 'stage' and 'status' for compatibility)\n            const newStatus = stage || status;\n            if (newStatus !== undefined && newStatus !== lead.status) {\n                updateData.status = newStatus;\n                if (newStatus === \"CONVERTED\") {\n                    updateData.convertedAt = new Date();\n                }\n            }\n            if (name !== undefined) updateData.name = name;\n            if (email !== undefined) updateData.email = email;\n            if (phone !== undefined) updateData.phone = phone;\n            if (contractAmount !== undefined) updateData.contractAmount = contractAmount ? parseFloat(contractAmount) : null;\n            if (deadline !== undefined) updateData.deadline = deadline ? new Date(deadline) : null;\n            if (deadlineSeverity !== undefined) updateData.deadlineSeverity = deadlineSeverity;\n            if (assignedToId !== undefined) updateData.assignedToId = assignedToId && assignedToId.trim() !== \"\" ? assignedToId : null;\n            if (interestArea !== undefined) updateData.interestArea = interestArea;\n            const updatedLead = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.update({\n                where: {\n                    id: leadId\n                },\n                data: updateData,\n                include: {\n                    assignedTo: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    },\n                    notes: {\n                        orderBy: {\n                            createdAt: \"desc\"\n                        },\n                        take: 10\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lead: {\n                    ...updatedLead,\n                    stage: updatedLead.status\n                }\n            });\n        }\n        // ==================== ADMIN CATEGORIES PUT ROUTES ====================\n        // Update category (admin)\n        if (path.startsWith(\"/admin/categories/\") && pathSegments.length === 3) {\n            const categoryId = pathSegments[2];\n            const { name, description, parentId, isActive, seoTitle, seoDesc, sortOrder } = body;\n            const updateData = {};\n            if (name !== undefined) updateData.name = name;\n            if (description !== undefined) updateData.description = description;\n            if (parentId !== undefined) updateData.parentId = parentId || null;\n            if (isActive !== undefined) updateData.isActive = isActive;\n            if (seoTitle !== undefined) updateData.seoTitle = seoTitle;\n            if (seoDesc !== undefined) updateData.seoDesc = seoDesc;\n            if (sortOrder !== undefined) updateData.sortOrder = sortOrder;\n            const category = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].category.update({\n                where: {\n                    id: categoryId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                category\n            });\n        }\n        // ==================== ADMIN STAGE TEMPLATES PUT ROUTES ====================\n        // PUT /api/admin/stage-templates/[id] - Update a stage template\n        if (path.startsWith(\"/admin/stage-templates/\") && pathSegments.length === 3) {\n            const templateId = pathSegments[2];\n            const { name, description, isDefault, sortOrder, isActive } = body;\n            const updateData = {};\n            if (name !== undefined) updateData.name = name;\n            if (description !== undefined) updateData.description = description;\n            if (isDefault !== undefined) updateData.isDefault = isDefault;\n            if (sortOrder !== undefined) updateData.sortOrder = sortOrder;\n            if (isActive !== undefined) updateData.isActive = isActive;\n            const template = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.update({\n                where: {\n                    id: templateId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                template\n            });\n        }\n        // ==================== ADMIN USERS PUT ROUTES ====================\n        // PUT /api/admin/users/[id] - Update user\n        if (path.startsWith(\"/admin/users/\") && pathSegments.length === 3) {\n            const userId = pathSegments[2];\n            const { name, phone, role, isActive, isBlogWriter, alternateEmail, alternatePhone, bio, website, socialLinks } = body;\n            const updateData = {};\n            if (name !== undefined) updateData.name = name;\n            if (phone !== undefined) updateData.phone = phone;\n            if (role !== undefined) updateData.role = role;\n            if (isActive !== undefined) updateData.isActive = isActive;\n            if (isBlogWriter !== undefined) updateData.isBlogWriter = isBlogWriter;\n            if (alternateEmail !== undefined) updateData.alternateEmail = alternateEmail;\n            if (alternatePhone !== undefined) updateData.alternatePhone = alternatePhone;\n            if (bio !== undefined) updateData.bio = bio;\n            if (website !== undefined) updateData.website = website;\n            if (socialLinks !== undefined) updateData.socialLinks = socialLinks;\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.update({\n                where: {\n                    id: userId\n                },\n                data: updateData,\n                select: {\n                    id: true,\n                    authorUid: true,\n                    email: true,\n                    name: true,\n                    role: true,\n                    phone: true,\n                    isActive: true,\n                    isBlogWriter: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user\n            });\n        }\n        // ==================== ADMIN ORDERS PUT ROUTES ====================\n        // PUT /api/admin/orders/stages/[id] - Update order stage\n        if (path.match(/^\\/admin\\/orders\\/stages\\/[^/]+$/) && pathSegments.length === 4) {\n            const stageId = pathSegments[3];\n            const { name, description, color, sortOrder, isActive } = body;\n            const updateData = {};\n            if (name !== undefined) updateData.name = name;\n            if (description !== undefined) updateData.description = description;\n            if (color !== undefined) updateData.color = color;\n            if (sortOrder !== undefined) updateData.sortOrder = sortOrder;\n            if (isActive !== undefined) updateData.isActive = isActive;\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].orderStage.update({\n                where: {\n                    id: stageId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage\n            });\n        }\n        // PUT /api/admin/orders/[id] - Update order\n        if (path.startsWith(\"/admin/orders/\") && pathSegments.length === 3 && pathSegments[2] !== \"stages\") {\n            const orderId = pathSegments[2];\n            const { status, currentStageId, shippingName, shippingEmail, shippingPhone, shippingAddress, shippingCity, shippingState, shippingZipCode } = body;\n            const updateData = {};\n            if (status !== undefined) updateData.status = status;\n            if (currentStageId !== undefined) updateData.currentStageId = currentStageId;\n            if (shippingName !== undefined) updateData.shippingName = shippingName;\n            if (shippingEmail !== undefined) updateData.shippingEmail = shippingEmail;\n            if (shippingPhone !== undefined) updateData.shippingPhone = shippingPhone;\n            if (shippingAddress !== undefined) updateData.shippingAddress = shippingAddress;\n            if (shippingCity !== undefined) updateData.shippingCity = shippingCity;\n            if (shippingState !== undefined) updateData.shippingState = shippingState;\n            if (shippingZipCode !== undefined) updateData.shippingZipCode = shippingZipCode;\n            // Update timestamps based on status\n            if (status === \"SHIPPED\" && !updateData.shippedAt) updateData.shippedAt = new Date();\n            if (status === \"DELIVERED\" && !updateData.deliveredAt) updateData.deliveredAt = new Date();\n            const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.update({\n                where: {\n                    id: orderId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                order\n            });\n        }\n        // ==================== ADMIN BOOKS PUT ROUTES ====================\n        // PUT /api/admin/books/[id] - Update book (including ISBN, deadline, severity)\n        if (path.startsWith(\"/admin/books/\") && pathSegments.length === 3 && !path.includes(\"/stages\")) {\n            const bookId = pathSegments[2];\n            const { title, isbnPaperback, isbnHardcover, isbnEbook, category, status, description, deadline, deadlineSeverity, // Store listing fields\n            isPublic, isAuthorCopy, price, discountPrice, paperbackPrice, hardcoverPrice, ebookPrice, hasPaperback, hasHardcover, hasEbook, authorCopyPrice, authorCopyMOQ, authorCopyTiers, shippingEnabled, // Store display overrides\n            storeDisplayTitle, storeDisplayAuthor, storeDisplayDescription, storeDisplayCover } = body;\n            const updateData = {};\n            if (title !== undefined) updateData.title = title;\n            if (category !== undefined) updateData.category = category;\n            if (description !== undefined) updateData.description = description;\n            if (status !== undefined) updateData.status = status;\n            if (deadline !== undefined) updateData.deadline = deadline ? new Date(deadline) : null;\n            if (deadlineSeverity !== undefined) updateData.deadlineSeverity = deadlineSeverity;\n            // Handle ISBN updates - important for canonical linking\n            if (isbnPaperback !== undefined) {\n                updateData.isbnPaperback = isbnPaperback || null;\n                // Paperback ISBN synced to legacy isbn field\n                updateData.isbn = isbnPaperback || null;\n            }\n            if (isbnHardcover !== undefined) updateData.isbnHardcover = isbnHardcover || null;\n            if (isbnEbook !== undefined) updateData.isbnEbook = isbnEbook || null;\n            // Store listing fields\n            if (isPublic !== undefined) updateData.isPublic = isPublic;\n            if (isAuthorCopy !== undefined) updateData.isAuthorCopy = isAuthorCopy;\n            if (price !== undefined) updateData.price = parseFloat(price) || 0;\n            if (discountPrice !== undefined) updateData.discountPrice = discountPrice ? parseFloat(discountPrice) : null;\n            if (paperbackPrice !== undefined) updateData.paperbackPrice = paperbackPrice ? parseFloat(paperbackPrice) : null;\n            if (hardcoverPrice !== undefined) updateData.hardcoverPrice = hardcoverPrice ? parseFloat(hardcoverPrice) : null;\n            if (ebookPrice !== undefined) updateData.ebookPrice = ebookPrice ? parseFloat(ebookPrice) : null;\n            if (hasPaperback !== undefined) updateData.hasPaperback = hasPaperback;\n            if (hasHardcover !== undefined) updateData.hasHardcover = hasHardcover;\n            if (hasEbook !== undefined) updateData.hasEbook = hasEbook;\n            if (authorCopyPrice !== undefined) updateData.authorCopyPrice = authorCopyPrice ? parseFloat(authorCopyPrice) : null;\n            if (authorCopyMOQ !== undefined) updateData.authorCopyMOQ = parseInt(authorCopyMOQ) || 1;\n            if (authorCopyTiers !== undefined) updateData.authorCopyTiers = authorCopyTiers;\n            if (shippingEnabled !== undefined) updateData.shippingEnabled = shippingEnabled;\n            // Store display overrides\n            if (storeDisplayTitle !== undefined) updateData.storeDisplayTitle = storeDisplayTitle || null;\n            if (storeDisplayAuthor !== undefined) updateData.storeDisplayAuthor = storeDisplayAuthor || null;\n            if (storeDisplayDescription !== undefined) updateData.storeDisplayDescription = storeDisplayDescription || null;\n            if (storeDisplayCover !== undefined) updateData.storeDisplayCover = storeDisplayCover || null;\n            // Word upload toggle\n            if (body.allowWordUpload !== undefined) updateData.allowWordUpload = body.allowWordUpload;\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.update({\n                where: {\n                    id: bookId\n                },\n                data: updateData,\n                include: {\n                    author: {\n                        select: {\n                            id: true,\n                            name: true,\n                            authorUid: true\n                        }\n                    }\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book\n            });\n        }\n        // PUT /api/admin/books/[bookId]/stages/[stageId] - Update stage status/assignment\n        if (path.match(/\\/admin\\/books\\/[^/]+\\/stages\\/[^/]+$/) && pathSegments.length === 5) {\n            const bookId = pathSegments[2];\n            const stageId = pathSegments[4];\n            const { status, assignedToId, notes, dueDate, fileLink, isVisible, changedById } = body;\n            // Get current stage for history\n            const currentStage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.findUnique({\n                where: {\n                    id: stageId\n                }\n            });\n            if (!currentStage || currentStage.bookId !== bookId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Validate changedById if provided\n            let validChangedById = null;\n            if (changedById) {\n                const changedByUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                    where: {\n                        id: changedById\n                    }\n                });\n                if (changedByUser) {\n                    validChangedById = changedById;\n                }\n            }\n            const updateData = {};\n            const historyEntries = [];\n            // Handle visibility change\n            if (isVisible !== undefined) {\n                updateData.isVisible = isVisible;\n                if (validChangedById) {\n                    historyEntries.push({\n                        stageId,\n                        action: isVisible ? \"STAGE_ENABLED\" : \"STAGE_HIDDEN\",\n                        notes: isVisible ? \"Stage enabled and visible to author\" : \"Stage hidden from author view\",\n                        changedById: validChangedById\n                    });\n                }\n            }\n            // Handle status change\n            if (status !== undefined && status !== currentStage.status) {\n                updateData.status = status;\n                // Set timestamps based on status\n                if (status === \"IN_PROGRESS\" && !currentStage.startedAt) {\n                    updateData.startedAt = new Date();\n                }\n                if (status === \"COMPLETED\" || status === \"APPROVED\") {\n                    updateData.completedAt = new Date();\n                }\n                // Reset completedAt if moving back to in-progress statuses\n                if (status === \"IN_PROGRESS\" || status === \"PENDING\" || status === \"QUERY_RAISED\") {\n                    updateData.completedAt = null;\n                }\n                if (validChangedById) {\n                    historyEntries.push({\n                        stageId,\n                        action: \"STATUS_CHANGE\",\n                        fromStatus: currentStage.status,\n                        toStatus: status,\n                        changedById: validChangedById\n                    });\n                }\n            }\n            // Handle assignment change\n            if (assignedToId !== undefined && assignedToId !== currentStage.assignedToId) {\n                updateData.assignedToId = assignedToId || null;\n                if (validChangedById) {\n                    historyEntries.push({\n                        stageId,\n                        action: \"ASSIGNED\",\n                        fromUserId: currentStage.assignedToId,\n                        toUserId: assignedToId || null,\n                        changedById: validChangedById\n                    });\n                }\n            }\n            // Handle notes\n            if (notes !== undefined) {\n                updateData.notes = notes;\n                if (notes && notes !== currentStage.notes && validChangedById) {\n                    historyEntries.push({\n                        stageId,\n                        action: \"NOTE_ADDED\",\n                        notes: notes,\n                        changedById: validChangedById\n                    });\n                }\n            }\n            // Handle file link\n            if (fileLink !== undefined) {\n                updateData.fileLink = fileLink || null;\n                if (validChangedById) {\n                    historyEntries.push({\n                        stageId,\n                        action: \"FILE_ADDED\",\n                        notes: fileLink ? `File link added: ${fileLink}` : \"File link removed\",\n                        changedById: validChangedById\n                    });\n                }\n            }\n            // Handle due date\n            if (dueDate !== undefined) {\n                updateData.dueDate = dueDate ? new Date(dueDate) : null;\n                if (validChangedById) {\n                    historyEntries.push({\n                        stageId,\n                        action: \"DUE_DATE_SET\",\n                        notes: dueDate ? `Due date set to ${new Date(dueDate).toLocaleDateString()}` : \"Due date removed\",\n                        changedById: validChangedById\n                    });\n                }\n            }\n            // Update stage (even if no history entries)\n            const updatedStage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.update({\n                where: {\n                    id: stageId\n                },\n                data: updateData,\n                include: {\n                    assignedTo: {\n                        select: {\n                            id: true,\n                            name: true\n                        }\n                    }\n                }\n            });\n            // Create history entries only if we have valid entries\n            if (historyEntries.length > 0) {\n                try {\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStageHistory.createMany({\n                        data: historyEntries\n                    });\n                } catch (historyError) {\n                    // History creation failed but stage was updated - log but don't fail\n                    console.error(\"Failed to create stage history:\", historyError);\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage: updatedStage\n            });\n        }\n        // ==================== ADMIN PACKAGES PUT ROUTES ====================\n        // PUT /api/admin/packages/[id] - Update package\n        if (path.startsWith(\"/admin/packages/\") && pathSegments.length === 3) {\n            const packageId = pathSegments[2];\n            const { name, description, price, features, isPopular, isActive, sortOrder } = body;\n            const updateData = {};\n            if (name !== undefined) updateData.name = name;\n            if (description !== undefined) updateData.description = description;\n            if (price !== undefined) updateData.price = price;\n            if (features !== undefined) updateData.features = features;\n            if (isPopular !== undefined) updateData.isPopular = isPopular;\n            if (isActive !== undefined) updateData.isActive = isActive;\n            if (sortOrder !== undefined) updateData.sortOrder = sortOrder;\n            const pkg = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingPackage.update({\n                where: {\n                    id: packageId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                package: pkg\n            });\n        }\n        // Update blog post (admin)\n        if (path.startsWith(\"/admin/blog/\") && pathSegments.length === 3) {\n            const postId = pathSegments[2];\n            const { title, content, excerpt, coverImage, authorName, category: blogCategory, tags, isPublished, linkedBookId, seoTitle, seoDesc } = body;\n            const updateData = {};\n            if (title !== undefined) updateData.title = title;\n            if (content !== undefined) updateData.content = content;\n            if (excerpt !== undefined) updateData.excerpt = excerpt;\n            if (coverImage !== undefined) updateData.coverImage = coverImage;\n            if (authorName !== undefined) updateData.authorName = authorName;\n            if (blogCategory !== undefined) updateData.category = blogCategory;\n            if (tags !== undefined) updateData.tags = Array.isArray(tags) ? tags : tags?.split(\",\").map((t)=>t.trim());\n            if (linkedBookId !== undefined) updateData.linkedBookId = linkedBookId || null;\n            if (seoTitle !== undefined) updateData.seoTitle = seoTitle;\n            if (seoDesc !== undefined) updateData.seoDesc = seoDesc;\n            // Handle publishing\n            if (isPublished !== undefined) {\n                updateData.isPublished = isPublished;\n                if (isPublished) {\n                    const existingPost = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.findUnique({\n                        where: {\n                            id: postId\n                        }\n                    });\n                    if (!existingPost.publishedAt) {\n                        updateData.publishedAt = new Date();\n                    }\n                }\n            }\n            const post = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.update({\n                where: {\n                    id: postId\n                },\n                data: updateData\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                post\n            });\n        }\n        // Update user blog writer status (admin)\n        if (path.startsWith(\"/admin/users/\") && pathSegments.length === 4 && pathSegments[3] === \"blog-writer\") {\n            const userId = pathSegments[2];\n            const { isBlogWriter } = body;\n            const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.update({\n                where: {\n                    id: userId\n                },\n                data: {\n                    isBlogWriter: isBlogWriter === true\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    email: true,\n                    isBlogWriter: true\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                user\n            });\n        }\n        // Update book\n        if (path.startsWith(\"/books/\") && pathSegments.length === 2) {\n            const bookId = pathSegments[1];\n            const book = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.update({\n                where: {\n                    id: bookId\n                },\n                data: body\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                book\n            });\n        }\n        // Update stage\n        if (path.startsWith(\"/stages/\") && pathSegments.length === 2) {\n            const stageId = pathSegments[1];\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.update({\n                where: {\n                    id: stageId\n                },\n                data: body\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                stage\n            });\n        }\n        // Update query\n        if (path.startsWith(\"/queries/\") && pathSegments.length === 2) {\n            const queryId = pathSegments[1];\n            const query = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.update({\n                where: {\n                    id: queryId\n                },\n                data: body\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                query\n            });\n        }\n        // Update lead\n        if (path.startsWith(\"/leads/\") && pathSegments.length === 2) {\n            const leadId = pathSegments[1];\n            const lead = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.update({\n                where: {\n                    id: leadId\n                },\n                data: body\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                lead\n            });\n        }\n        // Update order status (admin)\n        if (path.startsWith(\"/orders/\") && pathSegments.length === 2) {\n            const orderId = pathSegments[1];\n            const order = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].order.update({\n                where: {\n                    id: orderId\n                },\n                data: body\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                order\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Not found\"\n        }, {\n            status: 404\n        });\n    } catch (error) {\n        console.error(\"API PUT Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function DELETE(request, context) {\n    const params = await context.params;\n    const pathSegments = params?.path || [];\n    const path = \"/\" + pathSegments.join(\"/\");\n    try {\n        // Delete category (admin)\n        if (path.startsWith(\"/admin/categories/\") && pathSegments.length === 3) {\n            const categoryId = pathSegments[2];\n            // Check if category has books\n            const bookCount = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].bookCategory.count({\n                where: {\n                    categoryId\n                }\n            });\n            if (bookCount > 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Cannot delete category with associated books\"\n                }, {\n                    status: 400\n                });\n            }\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].category.delete({\n                where: {\n                    id: categoryId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete stage template (soft delete - set isActive to false)\n        if (path.startsWith(\"/admin/stage-templates/\") && pathSegments.length === 3) {\n            const templateId = pathSegments[2];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].stageTemplate.update({\n                where: {\n                    id: templateId\n                },\n                data: {\n                    isActive: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete stage from a book\n        if (path.match(/\\/admin\\/books\\/[^/]+\\/stages\\/[^/]+$/) && pathSegments.length === 5) {\n            const bookId = pathSegments[2];\n            const stageId = pathSegments[4];\n            const stage = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.findUnique({\n                where: {\n                    id: stageId\n                }\n            });\n            if (!stage || stage.bookId !== bookId) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Stage not found\"\n                }, {\n                    status: 404\n                });\n            }\n            // Don't allow deleting completed or locked stages\n            if (stage.isLocked || stage.status === \"COMPLETED\" || stage.status === \"APPROVED\") {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Cannot delete a completed or locked stage\"\n                }, {\n                    status: 400\n                });\n            }\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingStage.delete({\n                where: {\n                    id: stageId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete blog post (admin)\n        if (path.startsWith(\"/admin/blog/\") && pathSegments.length === 3) {\n            const postId = pathSegments[2];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogPost.delete({\n                where: {\n                    id: postId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete blog comment (admin)\n        if (path.startsWith(\"/admin/blog/comments/\") && pathSegments.length === 4) {\n            const commentId = pathSegments[3];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].blogComment.delete({\n                where: {\n                    id: commentId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete guest post (admin)\n        if (path.startsWith(\"/admin/guest-posts/\") && pathSegments.length === 3) {\n            const guestPostId = pathSegments[2];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].guestPost.delete({\n                where: {\n                    id: guestPostId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // ==================== ADMIN DELETE ROUTES ====================\n        // DELETE /api/admin/users/[id] - Delete user (soft delete by deactivating)\n        if (path.startsWith(\"/admin/users/\") && pathSegments.length === 3) {\n            const userId = pathSegments[2];\n            // Soft delete - just deactivate\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.update({\n                where: {\n                    id: userId\n                },\n                data: {\n                    isActive: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // DELETE /api/admin/orders/stages/[id] - Delete order stage\n        if (path.match(/^\\/admin\\/orders\\/stages\\/[^/]+$/) && pathSegments.length === 4) {\n            const stageId = pathSegments[3];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].orderStage.update({\n                where: {\n                    id: stageId\n                },\n                data: {\n                    isActive: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // DELETE /api/admin/packages/[id] - Delete package (soft delete)\n        if (path.startsWith(\"/admin/packages/\") && pathSegments.length === 3) {\n            const packageId = pathSegments[2];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].publishingPackage.update({\n                where: {\n                    id: packageId\n                },\n                data: {\n                    isActive: false\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete book\n        if (path.startsWith(\"/books/\") && pathSegments.length === 2) {\n            const bookId = pathSegments[1];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].book.delete({\n                where: {\n                    id: bookId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete query\n        if (path.startsWith(\"/queries/\") && pathSegments.length === 2) {\n            const queryId = pathSegments[1];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query.delete({\n                where: {\n                    id: queryId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Delete lead\n        if (path.startsWith(\"/leads/\") && pathSegments.length === 2) {\n            const leadId = pathSegments[1];\n            await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__[\"default\"].lead.delete({\n                where: {\n                    id: leadId\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Not found\"\n        }, {\n            status: 404\n        });\n    } catch (error) {\n        console.error(\"API DELETE Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2lELElBQUksQ0FDdEI7WUFBRWdDLE9BQU87WUFBeUJ3UixTQUFTeFIsTUFBTW9MLE9BQU87UUFBQyxHQUN6RDtZQUFFbk4sUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtbW9uZ28tdGVtcGxhdGUvLi9hcHAvYXBpL1tbLi4ucGF0aF1dL3JvdXRlLmpzPzQ4ZjEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gV3JpdGVyJ3MgUG9ja2V0IC0gTWFpbiBBUEkgUm91dGVzXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJztcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQgcHJpc21hIGZyb20gJ0AvbGliL3ByaXNtYSc7XG5pbXBvcnQgeyBpc1Jhem9ycGF5Q29uZmlndXJlZCwgY3JlYXRlT3JkZXIsIHZlcmlmeVBheW1lbnRTaWduYXR1cmUsIHZlcmlmeVdlYmhvb2tTaWduYXR1cmUgfSBmcm9tICdAL2xpYi9yYXpvcnBheSc7XG5pbXBvcnQgeyBnZXRTZXR0aW5nLCBnZXRTZXR0aW5ncywgZ2V0U2V0dGluZ3NCeUNhdGVnb3J5LCBzZXRTZXR0aW5nIH0gZnJvbSAnQC9saWIvc2l0ZS1zZXR0aW5ncyc7XG5pbXBvcnQgeyBzeW5jTGVhZFRvU2hlZXRzLCBzeW5jQW50aG9sb2d5VG9TaGVldHMgfSBmcm9tICdAL2xpYi9nb29nbGUtc2hlZXRzJztcbmltcG9ydCB7IGdlbmVyYXRlQXV0aG9yVWlkLCBlbnN1cmVBdXRob3JVaWQsIGdldE9yQ3JlYXRlQXV0aG9yQnlFbWFpbCwgbGlua0F1dGhvcnNUb0Jvb2ssIGdldFJveWFsdHlCdWNrZXQgfSBmcm9tICdAL2xpYi9pZGVudGl0eSc7XG5cbi8vIEhlbHBlcjogR2V0IGN1cnJlbnQgc2Vzc2lvblxuYXN5bmMgZnVuY3Rpb24gZ2V0U2Vzc2lvbihyZXF1ZXN0KSB7XG4gIC8vIFNpbXBsZSBKV1QgZXh0cmFjdGlvbiBmcm9tIEF1dGhvcml6YXRpb24gaGVhZGVyIGZvciBBUEkgY2FsbHNcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2F1dGhvcml6YXRpb24nKTtcbiAgaWYgKGF1dGhIZWFkZXI/LnN0YXJ0c1dpdGgoJ0JlYXJlciAnKSkge1xuICAgIC8vIEZvciBBUEkgY2FsbHMsIHdlJ2xsIHZlcmlmeSB0aGUgc2Vzc2lvbiBkaWZmZXJlbnRseVxuICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24gLSBpbiBwcm9kdWN0aW9uIHVzZSBwcm9wZXIgSldUIHZlcmlmaWNhdGlvblxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vLyBIZWxwZXI6IENoZWNrIHJvbGUgYXV0aG9yaXphdGlvblxuZnVuY3Rpb24gY2hlY2tSb2xlKHVzZXJSb2xlLCBhbGxvd2VkUm9sZXMpIHtcbiAgcmV0dXJuIGFsbG93ZWRSb2xlcy5pbmNsdWRlcyh1c2VyUm9sZSk7XG59XG5cbi8vIEhlbHBlcjogR2VuZXJhdGUgb3JkZXIgbnVtYmVyXG5mdW5jdGlvbiBnZW5lcmF0ZU9yZGVyTnVtYmVyKCkge1xuICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpLnRvU3RyaW5nKDM2KS50b1VwcGVyQ2FzZSgpO1xuICBjb25zdCByYW5kb20gPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgNikudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIGBXUC0ke3RpbWVzdGFtcH0tJHtyYW5kb219YDtcbn1cblxuLy8gRGVmaW5lIHB1Ymxpc2hpbmcgc3RhZ2VzXG5jb25zdCBQVUJMSVNISU5HX1NUQUdFUyA9IFtcbiAgeyB0eXBlOiAnTUFOVVNDUklQVF9SRUNFSVZFRCcsIG9yZGVyOiAxIH0sXG4gIHsgdHlwZTogJ0lOSVRJQUxfUkVWSUVXJywgb3JkZXI6IDIgfSxcbiAgeyB0eXBlOiAnRURJVElORycsIG9yZGVyOiAzIH0sXG4gIHsgdHlwZTogJ1BST09GUkVBRElORycsIG9yZGVyOiA0IH0sXG4gIHsgdHlwZTogJ0NPVkVSX0RFU0lHTicsIG9yZGVyOiA1IH0sXG4gIHsgdHlwZTogJ0lOVEVSSU9SX0ZPUk1BVFRJTkcnLCBvcmRlcjogNiB9LFxuICB7IHR5cGU6ICdGSU5BTF9SRVZJRVcnLCBvcmRlcjogNyB9LFxuICB7IHR5cGU6ICdJU0JOX0FTU0lHTk1FTlQnLCBvcmRlcjogOCB9LFxuICB7IHR5cGU6ICdQUklOVElORycsIG9yZGVyOiA5IH0sXG4gIHsgdHlwZTogJ0RJU1RSSUJVVElPTicsIG9yZGVyOiAxMCB9LFxuICB7IHR5cGU6ICdDT01QTEVURUQnLCBvcmRlcjogMTEgfSxcbl07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCwgY29udGV4dCkge1xuICBjb25zdCBwYXJhbXMgPSBhd2FpdCBjb250ZXh0LnBhcmFtcztcbiAgY29uc3QgcGF0aFNlZ21lbnRzID0gcGFyYW1zPy5wYXRoIHx8IFtdO1xuICBjb25zdCBwYXRoID0gJy8nICsgcGF0aFNlZ21lbnRzLmpvaW4oJy8nKTtcblxuICB0cnkge1xuICAgIC8vIEhlYWx0aCBjaGVja1xuICAgIGlmIChwYXRoID09PSAnL2hlYWx0aCcpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgZGF0YWJhc2U6ICdwb3N0Z3Jlc3FsJyxcbiAgICAgICAgcmF6b3JwYXk6IGlzUmF6b3JwYXlDb25maWd1cmVkKCkgPyAnY29uZmlndXJlZCcgOiAnbm90X2NvbmZpZ3VyZWQnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGFsbCBib29rcyAocHVibGljKVxuICAgIGlmIChwYXRoID09PSAnL2Jvb2tzJykge1xuICAgICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgaXNQdWJsaWMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdwdWJsaWMnKSA9PT0gJ3RydWUnO1xuICAgICAgY29uc3QgYXV0aG9ySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdhdXRob3JJZCcpO1xuXG4gICAgICBjb25zdCB3aGVyZSA9IHt9O1xuICAgICAgaWYgKGlzUHVibGljKSB7XG4gICAgICAgIHdoZXJlLmlzUHVibGljID0gdHJ1ZTtcbiAgICAgICAgd2hlcmUuaXNBdXRob3JDb3B5ID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoYXV0aG9ySWQpIHtcbiAgICAgICAgd2hlcmUuYXV0aG9ySWQgPSBhdXRob3JJZDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYm9va3MgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIHB1YmxpY1VybDogdHJ1ZSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBib29rcyB9KTtcbiAgICB9XG5cbiAgICAvLyBHZXQgc2luZ2xlIGJvb2tcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvYm9va3MvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgYm9va0lkID0gcGF0aFNlZ21lbnRzWzFdO1xuICAgICAgY29uc3QgYm9vayA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogYm9va0lkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhdXRob3I6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBwdWJsaWNVcmw6IHRydWUsIGJpbzogdHJ1ZSB9IH0sXG4gICAgICAgICAgcHVibGlzaGluZ1N0YWdlczoge1xuICAgICAgICAgICAgb3JkZXJCeTogeyBzdGFnZU9yZGVyOiAnYXNjJyB9LFxuICAgICAgICAgICAgaW5jbHVkZTogeyBmaWxlczogdHJ1ZSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWFudXNjcmlwdHM6IHsgb3JkZXJCeTogeyB2ZXJzaW9uOiAnZGVzYycgfSB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghYm9vaykge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0Jvb2sgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBib29rIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCBhdXRob3IncyBib29rcyB3aXRoIGZ1bGwgZGV0YWlsc1xuICAgIGlmIChwYXRoID09PSAnL2F1dGhvci9ib29rcycpIHtcbiAgICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IGF1dGhvcklkID0gc2VhcmNoUGFyYW1zLmdldCgnYXV0aG9ySWQnKSB8fCByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXVzZXItaWQnKTtcblxuICAgICAgaWYgKCFhdXRob3JJZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0F1dGhvciBJRCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYm9va3MgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IGF1dGhvcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBwdWJsaXNoaW5nU3RhZ2VzOiB7XG4gICAgICAgICAgICBvcmRlckJ5OiB7IHN0YWdlT3JkZXI6ICdhc2MnIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtYW51c2NyaXB0czoge1xuICAgICAgICAgICAgb3JkZXJCeTogeyB2ZXJzaW9uOiAnZGVzYycgfSxcbiAgICAgICAgICAgIHRha2U6IDEsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBleHRlcm5hbExpbmtzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYm9va3MgfSk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGF1dGhvcidzIHNhbGVzIGFuYWx5dGljc1xuICAgIGlmIChwYXRoID09PSAnL2F1dGhvci9hbmFseXRpY3MnKSB7XG4gICAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICBjb25zdCBhdXRob3JJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2F1dGhvcklkJyk7XG5cbiAgICAgIGlmICghYXV0aG9ySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdBdXRob3IgSUQgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIERhaWx5IHNhbGVzIChsYXN0IDMwIGRheXMpXG4gICAgICBjb25zdCB0aGlydHlEYXlzQWdvID0gbmV3IERhdGUoKTtcbiAgICAgIHRoaXJ0eURheXNBZ28uc2V0RGF0ZSh0aGlydHlEYXlzQWdvLmdldERhdGUoKSAtIDMwKTtcblxuICAgICAgY29uc3Qgcm95YWx0aWVzID0gYXdhaXQgcHJpc21hLnJveWFsdHkuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGF1dGhvcklkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogeyBndGU6IHRoaXJ0eURheXNBZ28gfSxcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZTogeyBib29rOiB7IHNlbGVjdDogeyB0aXRsZTogdHJ1ZSB9IH0gfSxcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vbnRobHkgc3VtbWFyeVxuICAgICAgY29uc3QgbW9udGhseVN1bW1hcnkgPSBhd2FpdCBwcmlzbWEucm95YWx0eS5ncm91cEJ5KHtcbiAgICAgICAgYnk6IFsncGVyaW9kJ10sXG4gICAgICAgIHdoZXJlOiB7IGF1dGhvcklkIH0sXG4gICAgICAgIF9zdW06IHsgYW1vdW50OiB0cnVlLCBzYWxlQW1vdW50OiB0cnVlIH0sXG4gICAgICAgIF9jb3VudDogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUb3RhbCB1bnBhaWQgcm95YWx0aWVzXG4gICAgICBjb25zdCB1bnBhaWRSb3lhbHRpZXMgPSBhd2FpdCBwcmlzbWEucm95YWx0eS5hZ2dyZWdhdGUoe1xuICAgICAgICB3aGVyZTogeyBhdXRob3JJZCwgaXNQYWlkOiBmYWxzZSB9LFxuICAgICAgICBfc3VtOiB7IGFtb3VudDogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHJlY2VudFJveWFsdGllczogcm95YWx0aWVzLFxuICAgICAgICBtb250aGx5U3VtbWFyeSxcbiAgICAgICAgdW5wYWlkVG90YWw6IHVucGFpZFJveWFsdGllcy5fc3VtLmFtb3VudCB8fCAwLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGF1dGhvcidzIG9yZGVyc1xuICAgIGlmIChwYXRoID09PSAnL2F1dGhvci9vcmRlcnMnKSB7XG4gICAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICBjb25zdCBhdXRob3JJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2F1dGhvcklkJyk7XG5cbiAgICAgIGlmICghYXV0aG9ySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdBdXRob3IgSUQgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG9yZGVycyA9IGF3YWl0IHByaXNtYS5vcmRlci5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZDogYXV0aG9ySWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7IGJvb2s6IHsgc2VsZWN0OiB7IHRpdGxlOiB0cnVlLCBjb3ZlckltYWdlOiB0cnVlIH0gfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvcmRlcnMgfSk7XG4gICAgfVxuXG4gICAgLy8gR2V0IHF1ZXJpZXMgZm9yIGF1dGhvclxuICAgIGlmIChwYXRoID09PSAnL2F1dGhvci9xdWVyaWVzJykge1xuICAgICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgYXV0aG9ySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdhdXRob3JJZCcpO1xuXG4gICAgICBpZiAoIWF1dGhvcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQXV0aG9yIElEIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBxdWVyaWVzID0gYXdhaXQgcHJpc21hLnF1ZXJ5LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgYXV0aG9ySWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGJvb2s6IHsgc2VsZWN0OiB7IHRpdGxlOiB0cnVlIH0gfSxcbiAgICAgICAgICBzdGFnZTogeyBzZWxlY3Q6IHsgc3RhZ2VUeXBlOiB0cnVlIH0gfSxcbiAgICAgICAgICBjb21tZW50czogeyBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2FzYycgfSB9LFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcXVlcmllcyB9KTtcbiAgICB9XG5cbiAgICAvLyBHZXQgbm90aWZpY2F0aW9uc1xuICAgIGlmIChwYXRoID09PSAnL25vdGlmaWNhdGlvbnMnKSB7XG4gICAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICBjb25zdCB1c2VySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd1c2VySWQnKTtcblxuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVc2VyIElEIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBub3RpZmljYXRpb25zID0gYXdhaXQgcHJpc21hLm5vdGlmaWNhdGlvbi5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDUwLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHVucmVhZENvdW50ID0gYXdhaXQgcHJpc21hLm5vdGlmaWNhdGlvbi5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCwgaXNSZWFkOiBmYWxzZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG5vdGlmaWNhdGlvbnMsIHVucmVhZENvdW50IH0pO1xuICAgIH1cblxuICAgIC8vIEdldCB1c2VyIHByb2ZpbGVcbiAgICBpZiAocGF0aCA9PT0gJy9wcm9maWxlJykge1xuICAgICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgdXNlcklkID0gc2VhcmNoUGFyYW1zLmdldCgndXNlcklkJyk7XG5cbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVXNlciBJRCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogdXNlcklkIH0sXG4gICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgcGhvbmU6IHRydWUsXG4gICAgICAgICAgcm9sZTogdHJ1ZSxcbiAgICAgICAgICBwcm9maWxlSW1hZ2U6IHRydWUsXG4gICAgICAgICAgYmlvOiB0cnVlLFxuICAgICAgICAgIHdlYnNpdGU6IHRydWUsXG4gICAgICAgICAgc29jaWFsTGlua3M6IHRydWUsXG4gICAgICAgICAgcHVibGljVXJsOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBiYW5rRGV0YWlscyA9IGF3YWl0IHByaXNtYS5iYW5rRGV0YWlscy5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdXNlciwgYmFua0RldGFpbHMgfSk7XG4gICAgfVxuXG4gICAgLy8gUHVibGljIGF1dGhvciBwcm9maWxlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2F1dGhvcnMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgcHVibGljVXJsID0gcGF0aFNlZ21lbnRzWzFdO1xuICAgICAgY29uc3QgYXV0aG9yID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IHB1YmxpY1VybCB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIGJpbzogdHJ1ZSxcbiAgICAgICAgICBwcm9maWxlSW1hZ2U6IHRydWUsXG4gICAgICAgICAgd2Vic2l0ZTogdHJ1ZSxcbiAgICAgICAgICBzb2NpYWxMaW5rczogdHJ1ZSxcbiAgICAgICAgICBwdWJsaWNVcmw6IHRydWUsXG4gICAgICAgICAgYm9va3M6IHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGlzUHVibGljOiB0cnVlIH0sXG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIHRpdGxlOiB0cnVlLFxuICAgICAgICAgICAgICBjb3ZlckltYWdlOiB0cnVlLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgcHJpY2U6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFhdXRob3IpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdBdXRob3Igbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBhdXRob3IgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvc3RvcmUvYm9va3MgLSBHZXQgYWxsIHB1YmxpY2x5IGxpc3RlZCBib29rcyBmb3IgdGhlIHN0b3JlXG4gICAgaWYgKHBhdGggPT09ICcvc3RvcmUvYm9va3MnKSB7XG4gICAgICBjb25zdCBib29rcyA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBpc1B1YmxpYzogdHJ1ZSxcbiAgICAgICAgICBzdGF0dXM6ICdQVUJMSVNIRUQnLFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgcHVibGlzaGVkRGF0ZTogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYm9va3MgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvc3RvcmUvYm9va3MvW2lkXSAtIEdldCBzaW5nbGUgYm9vayBmb3Igc3RvcmVcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvc3RvcmUvYm9va3MvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgYm9va0lkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgXG4gICAgICBjb25zdCBib29rID0gYXdhaXQgcHJpc21hLmJvb2suZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBib29rSWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGF1dGhvcjogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIHB1YmxpY1VybDogdHJ1ZSB9IH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFib29rIHx8ICFib29rLmlzUHVibGljKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQm9vayBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGJvb2sgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRtaW46IEdldCBhbGwgdXNlcnNcbiAgICAvLyBBZG1pbjogR2V0IGFsbCBib29rcyB3aXRoIHN0YWdlc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL2Jvb2tzJykge1xuICAgICAgY29uc3QgYm9va3MgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhdXRob3I6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBlbWFpbDogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlIH0gfSxcbiAgICAgICAgICBwdWJsaXNoaW5nU3RhZ2VzOiB7XG4gICAgICAgICAgICBvcmRlckJ5OiB7IHN0YWdlT3JkZXI6ICdhc2MnIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7IGFzc2lnbmVkVG86IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9IH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGJvb2tzIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL2Jvb2tzL1tpZF0gLSBHZXQgc2luZ2xlIGJvb2sgd2l0aCBmdWxsIHByb2plY3QgZGV0YWlsc1xuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9ib29rcy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzICYmICFwYXRoLmluY2x1ZGVzKCcvc3RhZ2VzJykpIHtcbiAgICAgIGNvbnN0IGJvb2tJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIFxuICAgICAgY29uc3QgYm9vayA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogYm9va0lkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhdXRob3I6IHsgXG4gICAgICAgICAgICBzZWxlY3Q6IHsgXG4gICAgICAgICAgICAgIGlkOiB0cnVlLCBcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSwgXG4gICAgICAgICAgICAgIGVtYWlsOiB0cnVlLCBcbiAgICAgICAgICAgICAgcGhvbmU6IHRydWUsXG4gICAgICAgICAgICAgIGF1dGhvclVpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgICAgICAgICAgfSBcbiAgICAgICAgICB9LFxuICAgICAgICAgIHB1Ymxpc2hpbmdTdGFnZXM6IHtcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgc3RhZ2VPcmRlcjogJ2FzYycgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgXG4gICAgICAgICAgICAgIGFzc2lnbmVkVG86IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBlbWFpbDogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgIGhpc3Rvcnk6IHtcbiAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgICAgICAgICAgdGFrZTogMTAsXG4gICAgICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgICAgY2hhbmdlZEJ5OiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBxdWVyaWVzOiB7XG4gICAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgICAgICB0YWtlOiAxMCxcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBuYW1lOiB0cnVlIH0gfSxcbiAgICAgICAgICAgICAgYXNzaWduZWRUbzogeyBzZWxlY3Q6IHsgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFib29rKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQm9vayBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBJU0JOIHN0YXR1c1xuICAgICAgY29uc3QgaXNiblN0YXR1cyA9IGJvb2suaXNiblBhcGVyYmFjayA/ICdBTExPVFRFRCcgOiAnUEVORElORyc7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBvdmVyYWxsIHByb2dyZXNzXG4gICAgICBjb25zdCB0b3RhbFN0YWdlcyA9IGJvb2sucHVibGlzaGluZ1N0YWdlcy5sZW5ndGg7XG4gICAgICBjb25zdCBjb21wbGV0ZWRTdGFnZXMgPSBib29rLnB1Ymxpc2hpbmdTdGFnZXMuZmlsdGVyKHMgPT4gXG4gICAgICAgIHMuc3RhdHVzID09PSAnQ09NUExFVEVEJyB8fCBzLnN0YXR1cyA9PT0gJ0FQUFJPVkVEJ1xuICAgICAgKS5sZW5ndGg7XG4gICAgICBjb25zdCBwcm9ncmVzc1BlcmNlbnQgPSB0b3RhbFN0YWdlcyA+IDAgPyBNYXRoLnJvdW5kKChjb21wbGV0ZWRTdGFnZXMgLyB0b3RhbFN0YWdlcykgKiAxMDApIDogMDtcblxuICAgICAgLy8gR2V0IGN1cnJlbnQgc3RhZ2VcbiAgICAgIGNvbnN0IGN1cnJlbnRTdGFnZSA9IGJvb2sucHVibGlzaGluZ1N0YWdlcy5maW5kKHMgPT4gXG4gICAgICAgIHMuc3RhdHVzID09PSAnSU5fUFJPR1JFU1MnIHx8IHMuc3RhdHVzID09PSAnQVdBSVRJTkdfQVBQUk9WQUwnXG4gICAgICApIHx8IGJvb2sucHVibGlzaGluZ1N0YWdlcy5maW5kKHMgPT4gcy5zdGF0dXMgPT09ICdQRU5ESU5HJyk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBib29rLFxuICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgaXNiblN0YXR1cyxcbiAgICAgICAgICBwcm9ncmVzc1BlcmNlbnQsXG4gICAgICAgICAgY29tcGxldGVkU3RhZ2VzLFxuICAgICAgICAgIHRvdGFsU3RhZ2VzLFxuICAgICAgICAgIGN1cnJlbnRTdGFnZTogY3VycmVudFN0YWdlPy5zdGFnZVR5cGUgfHwgbnVsbCxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vdGVhbSAtIEdldCB0ZWFtIG1lbWJlcnMgZm9yIGFzc2lnbm1lbnRcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi90ZWFtJykge1xuICAgICAgY29uc3QgdGVhbSA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICByb2xlOiB7IGluOiBbJ0FETUlOJywgJ1RFQU0nXSB9LFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIHJvbGU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgbmFtZTogJ2FzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0ZWFtIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL3N0YWdlLXRlbXBsYXRlcyAtIEdldCBhbGwgc3RhZ2UgdGVtcGxhdGVzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vc3RhZ2UtdGVtcGxhdGVzJykge1xuICAgICAgbGV0IHRlbXBsYXRlcyA9IGF3YWl0IHByaXNtYS5zdGFnZVRlbXBsYXRlLmZpbmRNYW55KHtcbiAgICAgICAgb3JkZXJCeTogeyBzb3J0T3JkZXI6ICdhc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gSWYgbm8gdGVtcGxhdGVzIGV4aXN0LCBjcmVhdGUgZGVmYXVsdHMgKGFsbCBPRkYgZXhjZXB0IElOSVRJQUxfUkVWSUVXKVxuICAgICAgaWYgKHRlbXBsYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdFN0YWdlcyA9IFtcbiAgICAgICAgICB7IHN0YWdlVHlwZTogJ01BTlVTQ1JJUFRfUkVDRUlWRUQnLCBuYW1lOiAnTWFudXNjcmlwdCBSZWNlaXZlZCcsIHNvcnRPcmRlcjogMSwgaXNEZWZhdWx0OiBmYWxzZSB9LFxuICAgICAgICAgIHsgc3RhZ2VUeXBlOiAnSU5JVElBTF9SRVZJRVcnLCBuYW1lOiAnSW5pdGlhbCBSZXZpZXcnLCBzb3J0T3JkZXI6IDIsIGlzRGVmYXVsdDogdHJ1ZSB9LCAvLyBPbmx5IHRoaXMgb25lIGlzIE9OIGJ5IGRlZmF1bHRcbiAgICAgICAgICB7IHN0YWdlVHlwZTogJ0VESVRJTkcnLCBuYW1lOiAnRWRpdGluZycsIHNvcnRPcmRlcjogMywgaXNEZWZhdWx0OiBmYWxzZSB9LFxuICAgICAgICAgIHsgc3RhZ2VUeXBlOiAnUFJPT0ZSRUFESU5HJywgbmFtZTogJ1Byb29mcmVhZGluZycsIHNvcnRPcmRlcjogNCwgaXNEZWZhdWx0OiBmYWxzZSB9LFxuICAgICAgICAgIHsgc3RhZ2VUeXBlOiAnQ09WRVJfREVTSUdOJywgbmFtZTogJ0NvdmVyIERlc2lnbicsIHNvcnRPcmRlcjogNSwgaXNEZWZhdWx0OiBmYWxzZSB9LFxuICAgICAgICAgIHsgc3RhZ2VUeXBlOiAnSU5URVJJT1JfRk9STUFUVElORycsIG5hbWU6ICdJbnRlcmlvciBGb3JtYXR0aW5nJywgc29ydE9yZGVyOiA2LCBpc0RlZmF1bHQ6IGZhbHNlIH0sXG4gICAgICAgICAgeyBzdGFnZVR5cGU6ICdGSU5BTF9SRVZJRVcnLCBuYW1lOiAnRmluYWwgUmV2aWV3Jywgc29ydE9yZGVyOiA3LCBpc0RlZmF1bHQ6IGZhbHNlIH0sXG4gICAgICAgICAgeyBzdGFnZVR5cGU6ICdJU0JOX0FTU0lHTk1FTlQnLCBuYW1lOiAnSVNCTiBBc3NpZ25tZW50Jywgc29ydE9yZGVyOiA4LCBpc0RlZmF1bHQ6IGZhbHNlIH0sXG4gICAgICAgICAgeyBzdGFnZVR5cGU6ICdQUklOVElORycsIG5hbWU6ICdQcmludGluZycsIHNvcnRPcmRlcjogOSwgaXNEZWZhdWx0OiBmYWxzZSB9LFxuICAgICAgICAgIHsgc3RhZ2VUeXBlOiAnRElTVFJJQlVUSU9OJywgbmFtZTogJ0Rpc3RyaWJ1dGlvbicsIHNvcnRPcmRlcjogMTAsIGlzRGVmYXVsdDogZmFsc2UgfSxcbiAgICAgICAgICB7IHN0YWdlVHlwZTogJ0NPTVBMRVRFRCcsIG5hbWU6ICdDb21wbGV0ZWQnLCBzb3J0T3JkZXI6IDExLCBpc0RlZmF1bHQ6IGZhbHNlIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgYXdhaXQgcHJpc21hLnN0YWdlVGVtcGxhdGUuY3JlYXRlTWFueSh7IGRhdGE6IGRlZmF1bHRTdGFnZXMgfSk7XG4gICAgICAgIHRlbXBsYXRlcyA9IGF3YWl0IHByaXNtYS5zdGFnZVRlbXBsYXRlLmZpbmRNYW55KHsgb3JkZXJCeTogeyBzb3J0T3JkZXI6ICdhc2MnIH0gfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHRlbXBsYXRlcyB9KTtcbiAgICB9XG5cbiAgICAvLyBBZG1pbjogR2V0IGFsbCBxdWVyaWVzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vcXVlcmllcycpIHtcbiAgICAgIGNvbnN0IHF1ZXJpZXMgPSBhd2FpdCBwcmlzbWEucXVlcnkuZmluZE1hbnkoe1xuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBuYW1lOiB0cnVlLCBlbWFpbDogdHJ1ZSB9IH0sXG4gICAgICAgICAgYm9vazogeyBzZWxlY3Q6IHsgdGl0bGU6IHRydWUgfSB9LFxuICAgICAgICAgIGFzc2lnbmVkVG86IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9LFxuICAgICAgICAgIGNvbW1lbnRzOiB7IG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnYXNjJyB9IH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBxdWVyaWVzIH0pO1xuICAgIH1cblxuICAgIC8vIEFkbWluOiBHZXQgQ1JNIGxlYWRzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vbGVhZHMnKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IHN0YXR1c0ZpbHRlciA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdzdGF0dXMnKTtcbiAgICAgIGNvbnN0IGRhdGVGcm9tID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2RhdGVGcm9tJyk7XG4gICAgICBjb25zdCBkYXRlVG8gPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnZGF0ZVRvJyk7XG4gICAgICBjb25zdCBhc3NpZ25lZFRvSWQgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnYXNzaWduZWRUb0lkJyk7XG5cbiAgICAgIGNvbnN0IHdoZXJlID0ge307XG4gICAgICBcbiAgICAgIC8vIFN0YXR1cyBmaWx0ZXIgKENvbnZlcnRlZCwgTG9zdCwgT3BlbilcbiAgICAgIGlmIChzdGF0dXNGaWx0ZXIgJiYgc3RhdHVzRmlsdGVyICE9PSAnYWxsJykge1xuICAgICAgICBpZiAoc3RhdHVzRmlsdGVyID09PSAnT1BFTicpIHtcbiAgICAgICAgICB3aGVyZS5zdGF0dXMgPSB7IG5vdEluOiBbJ0NPTlZFUlRFRCcsICdMT1NUJ10gfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3aGVyZS5zdGF0dXMgPSBzdGF0dXNGaWx0ZXI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gRGF0ZSByYW5nZSBmaWx0ZXJcbiAgICAgIGlmIChkYXRlRnJvbSB8fCBkYXRlVG8pIHtcbiAgICAgICAgd2hlcmUuY3JlYXRlZEF0ID0ge307XG4gICAgICAgIGlmIChkYXRlRnJvbSkgd2hlcmUuY3JlYXRlZEF0Lmd0ZSA9IG5ldyBEYXRlKGRhdGVGcm9tKTtcbiAgICAgICAgaWYgKGRhdGVUbykgd2hlcmUuY3JlYXRlZEF0Lmx0ZSA9IG5ldyBEYXRlKGRhdGVUbyArICdUMjM6NTk6NTknKTtcbiAgICAgIH1cblxuICAgICAgLy8gQXNzaWduZWQgdG8gZmlsdGVyXG4gICAgICBpZiAoYXNzaWduZWRUb0lkICYmIGFzc2lnbmVkVG9JZCAhPT0gJ2FsbCcpIHtcbiAgICAgICAgd2hlcmUuYXNzaWduZWRUb0lkID0gYXNzaWduZWRUb0lkO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBsZWFkcyA9IGF3YWl0IHByaXNtYS5sZWFkLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhc3NpZ25lZFRvOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgYWN0aXZpdGllczogeyBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHRha2U6IDUgfSxcbiAgICAgICAgICBub3RlczogeyBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0gfSxcbiAgICAgICAgICBzdGFnZUhpc3Rvcnk6IHsgb3JkZXJCeTogeyBtb3ZlZEF0OiAnZGVzYycgfSB9LFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gTWFwIHN0YXR1cyB0byBzdGFnZSBmb3IgZnJvbnRlbmQgY29tcGF0aWJpbGl0eVxuICAgICAgY29uc3QgbWFwcGVkTGVhZHMgPSBsZWFkcy5tYXAobGVhZCA9PiAoe1xuICAgICAgICAuLi5sZWFkLFxuICAgICAgICBzdGFnZTogbGVhZC5zdGF0dXMsIC8vIE1hcCBzdGF0dXMgdG8gc3RhZ2VcbiAgICAgIH0pKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHN1bW1hcnlcbiAgICAgIGNvbnN0IGFsbExlYWRzID0gYXdhaXQgcHJpc21hLmxlYWQuZmluZE1hbnkoKTtcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSB7XG4gICAgICAgIHRvdGFsOiBhbGxMZWFkcy5sZW5ndGgsXG4gICAgICAgIG5ldzogYWxsTGVhZHMuZmlsdGVyKGwgPT4gbC5zdGF0dXMgPT09ICdORVcnKS5sZW5ndGgsXG4gICAgICAgIGNvbnRhY3RlZDogYWxsTGVhZHMuZmlsdGVyKGwgPT4gbC5zdGF0dXMgPT09ICdDT05UQUNURUQnKS5sZW5ndGgsXG4gICAgICAgIGludGVyZXN0ZWQ6IGFsbExlYWRzLmZpbHRlcihsID0+IGwuc3RhdHVzID09PSAnSU5URVJFU1RFRCcpLmxlbmd0aCxcbiAgICAgICAgbmVnb3RpYXRpbmc6IGFsbExlYWRzLmZpbHRlcihsID0+IGwuc3RhdHVzID09PSAnTkVHT1RJQVRJTkcnKS5sZW5ndGgsXG4gICAgICAgIGNvbnZlcnRlZDogYWxsTGVhZHMuZmlsdGVyKGwgPT4gbC5zdGF0dXMgPT09ICdDT05WRVJURUQnKS5sZW5ndGgsXG4gICAgICAgIGxvc3Q6IGFsbExlYWRzLmZpbHRlcihsID0+IGwuc3RhdHVzID09PSAnTE9TVCcpLmxlbmd0aCxcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGxlYWRzOiBtYXBwZWRMZWFkcywgc3VtbWFyeSB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZG1pbi9sZWFkLXN0YWdlcyAtIEdldCBjdXN0b20gbGVhZCBzdGFnZXNcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9sZWFkLXN0YWdlcycpIHtcbiAgICAgIGNvbnN0IHN0YWdlc1NldHRpbmcgPSBhd2FpdCBwcmlzbWEuc2l0ZVNldHRpbmcuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGtleTogJ2xlYWRTdGFnZXMnIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZGVmYXVsdFN0YWdlcyA9IFtcbiAgICAgICAgeyBpZDogJ05FVycsIG5hbWU6ICdOZXcnLCBjb2xvcjogJ2JsdWUnIH0sXG4gICAgICAgIHsgaWQ6ICdDT05UQUNURUQnLCBuYW1lOiAnQ29udGFjdGVkJywgY29sb3I6ICd5ZWxsb3cnIH0sXG4gICAgICAgIHsgaWQ6ICdJTlRFUkVTVEVEJywgbmFtZTogJ0ludGVyZXN0ZWQnLCBjb2xvcjogJ2dyZWVuJyB9LFxuICAgICAgICB7IGlkOiAnTkVHT1RJQVRJTkcnLCBuYW1lOiAnTmVnb3RpYXRpbmcnLCBjb2xvcjogJ3B1cnBsZScgfSxcbiAgICAgICAgeyBpZDogJ0NPTlZFUlRFRCcsIG5hbWU6ICdDb252ZXJ0ZWQnLCBjb2xvcjogJ2VtZXJhbGQnIH0sXG4gICAgICAgIHsgaWQ6ICdMT1NUJywgbmFtZTogJ0xvc3QnLCBjb2xvcjogJ3JlZCcgfSxcbiAgICAgIF07XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN0YWdlczogc3RhZ2VzU2V0dGluZz8udmFsdWUgfHwgZGVmYXVsdFN0YWdlcyB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZG1pbi9ub3RpZmljYXRpb25zIC0gR2V0IGFsbCBub3RpZmljYXRpb25zIHNlbnRcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9ub3RpZmljYXRpb25zJykge1xuICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IGF3YWl0IHByaXNtYS5ub3RpZmljYXRpb24uZmluZE1hbnkoe1xuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDEwMCxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVzZXI6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBhdXRob3JVaWQ6IHRydWUgfSB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG5vdGlmaWNhdGlvbnMgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vc2l0ZS1zZXR0aW5ncyAtIEdldCBhbGwgc2l0ZSBzZXR0aW5nc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3NpdGUtc2V0dGluZ3MnKSB7XG4gICAgICBjb25zdCBhbGxTZXR0aW5ncyA9IGF3YWl0IHByaXNtYS5zaXRlU2V0dGluZy5maW5kTWFueSgpO1xuICAgICAgXG4gICAgICBjb25zdCBzZXR0aW5ncyA9IHt9O1xuICAgICAgZm9yIChjb25zdCBzIG9mIGFsbFNldHRpbmdzKSB7XG4gICAgICAgIHNldHRpbmdzW3Mua2V5XSA9IHMudmFsdWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHNldHRpbmdzIH0pO1xuICAgIH1cblxuICAgIC8vIEFkbWluOiBHZXQgYWxsIGNhdGVnb3JpZXMgKHdpdGggYm9vayBjb3VudClcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9jYXRlZ29yaWVzJykge1xuICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IHByaXNtYS5jYXRlZ29yeS5maW5kTWFueSh7XG4gICAgICAgIG9yZGVyQnk6IHsgc29ydE9yZGVyOiAnYXNjJyB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgY2hpbGRyZW46IHtcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgc29ydE9yZGVyOiAnYXNjJyB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICBfY291bnQ6IHsgc2VsZWN0OiB7IGJvb2tzOiB0cnVlIH0gfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBfY291bnQ6IHsgc2VsZWN0OiB7IGJvb2tzOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB0b3BMZXZlbCA9IGNhdGVnb3JpZXMuZmlsdGVyKGMgPT4gIWMucGFyZW50SWQpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgY2F0ZWdvcmllczogdG9wTGV2ZWwgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRtaW46IERhc2hib2FyZCBzdGF0c1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3N0YXRzJykge1xuICAgICAgY29uc3QgW3RvdGFsQm9va3MsIHRvdGFsQXV0aG9ycywgdG90YWxPcmRlcnMsIHBlbmRpbmdRdWVyaWVzLCBuZXdMZWFkc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHByaXNtYS5ib29rLmNvdW50KCksXG4gICAgICAgIHByaXNtYS51c2VyLmNvdW50KHsgd2hlcmU6IHsgcm9sZTogJ0FVVEhPUicgfSB9KSxcbiAgICAgICAgcHJpc21hLm9yZGVyLmNvdW50KHsgd2hlcmU6IHsgc3RhdHVzOiAnUEFJRCcgfSB9KSxcbiAgICAgICAgcHJpc21hLnF1ZXJ5LmNvdW50KHsgd2hlcmU6IHsgc3RhdHVzOiB7IGluOiBbJ09QRU4nLCAnSU5fUFJPR1JFU1MnXSB9IH0gfSksXG4gICAgICAgIHByaXNtYS5sZWFkLmNvdW50KHsgd2hlcmU6IHsgc3RhdHVzOiAnTkVXJyB9IH0pLFxuICAgICAgXSk7XG5cbiAgICAgIC8vIEJvb2tzIGJ5IHN0YXR1c1xuICAgICAgY29uc3QgYm9va3NCeVN0YXR1cyA9IGF3YWl0IHByaXNtYS5ib29rLmdyb3VwQnkoe1xuICAgICAgICBieTogWydzdGF0dXMnXSxcbiAgICAgICAgX2NvdW50OiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFJlY2VudCBvcmRlcnNcbiAgICAgIGNvbnN0IHJlY2VudE9yZGVycyA9IGF3YWl0IHByaXNtYS5vcmRlci5maW5kTWFueSh7XG4gICAgICAgIHRha2U6IDEwLFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB7IHNlbGVjdDogeyBuYW1lOiB0cnVlIH0gfSxcbiAgICAgICAgICBpdGVtczogeyBzZWxlY3Q6IHsgYm9vazogeyBzZWxlY3Q6IHsgdGl0bGU6IHRydWUgfSB9IH0gfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICB0b3RhbEJvb2tzLFxuICAgICAgICB0b3RhbEF1dGhvcnMsXG4gICAgICAgIHRvdGFsT3JkZXJzLFxuICAgICAgICBwZW5kaW5nUXVlcmllcyxcbiAgICAgICAgbmV3TGVhZHMsXG4gICAgICAgIGJvb2tzQnlTdGF0dXMsXG4gICAgICAgIHJlY2VudE9yZGVycyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFVTRVJTIEFQSSA9PT09PT09PT09PT09PT09PT09PVxuICAgIFxuICAgIC8vIEdFVCAvYXBpL2FkbWluL3VzZXJzIC0gTGlzdCBhbGwgdXNlcnMgd2l0aCBmaWx0ZXJzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vdXNlcnMnKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IHJvbGUgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgncm9sZScpO1xuICAgICAgY29uc3Qgc2VhcmNoID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3NlYXJjaCcpO1xuICAgICAgY29uc3QgcGFnZSA9IHBhcnNlSW50KHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdwYWdlJykgfHwgJzEnKTtcbiAgICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQodXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2xpbWl0JykgfHwgJzUwJyk7XG4gICAgICBjb25zdCBza2lwID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xuXG4gICAgICBjb25zdCB3aGVyZSA9IHt9O1xuICAgICAgaWYgKHJvbGUgJiYgcm9sZSAhPT0gJ2FsbCcpIHdoZXJlLnJvbGUgPSByb2xlO1xuICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICB3aGVyZS5PUiA9IFtcbiAgICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXG4gICAgICAgICAgeyBlbWFpbDogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgICB7IGF1dGhvclVpZDogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgXTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgW3VzZXJzLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHByaXNtYS51c2VyLmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZSxcbiAgICAgICAgICBza2lwLFxuICAgICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgYXV0aG9yVWlkOiB0cnVlLFxuICAgICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgICAgcGhvbmU6IHRydWUsXG4gICAgICAgICAgICByb2xlOiB0cnVlLFxuICAgICAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpc0Jsb2dXcml0ZXI6IHRydWUsXG4gICAgICAgICAgICBpbXBvcnRTb3VyY2U6IHRydWUsXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXG4gICAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgYm9va3M6IHRydWUsXG4gICAgICAgICAgICAgICAgYm9va0F1dGhvcnNoaXBzOiB0cnVlLFxuICAgICAgICAgICAgICAgIHJveWFsdGllczogdHJ1ZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHByaXNtYS51c2VyLmNvdW50KHsgd2hlcmUgfSksXG4gICAgICBdKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHRvdGFsIHJveWFsdGllcyBwZXIgdXNlclxuICAgICAgY29uc3QgdXNlcnNXaXRoUm95YWx0aWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIHVzZXJzLm1hcChhc3luYyAodXNlcikgPT4ge1xuICAgICAgICAgIGNvbnN0IHJveWFsdHlBZ2cgPSBhd2FpdCBwcmlzbWEucm95YWx0eS5hZ2dyZWdhdGUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgYXV0aG9ySWQ6IHVzZXIuaWQgfSxcbiAgICAgICAgICAgIF9zdW06IHsgYW1vdW50OiB0cnVlIH0sXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgcGFpZEFnZyA9IGF3YWl0IHByaXNtYS5yb3lhbHR5LmFnZ3JlZ2F0ZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBhdXRob3JJZDogdXNlci5pZCwgaXNQYWlkOiB0cnVlIH0sXG4gICAgICAgICAgICBfc3VtOiB7IGFtb3VudDogdHJ1ZSB9LFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgICAgdG90YWxSb3lhbHR5OiByb3lhbHR5QWdnLl9zdW0uYW1vdW50IHx8IDAsXG4gICAgICAgICAgICBwYWlkUm95YWx0eTogcGFpZEFnZy5fc3VtLmFtb3VudCB8fCAwLFxuICAgICAgICAgICAgdW5wYWlkUm95YWx0eTogKHJveWFsdHlBZ2cuX3N1bS5hbW91bnQgfHwgMCkgLSAocGFpZEFnZy5fc3VtLmFtb3VudCB8fCAwKSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgdXNlcnM6IHVzZXJzV2l0aFJveWFsdGllcyxcbiAgICAgICAgcGFnaW5hdGlvbjogeyBwYWdlLCBsaW1pdCwgdG90YWwsIHRvdGFsUGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIGxpbWl0KSB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vdXNlcnMvW2lkXSAtIFNpbmdsZSB1c2VyIGRldGFpbHNcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvYWRtaW4vdXNlcnMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMyAmJiBwYXRoU2VnbWVudHNbMl0gIT09ICdpbXBvcnQnKSB7XG4gICAgICBjb25zdCB1c2VySWQgPSBwYXRoU2VnbWVudHNbMl07XG5cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYm9va3M6IHtcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUsIHN0YXR1czogdHJ1ZSwgaXNiblBhcGVyYmFjazogdHJ1ZSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9va0F1dGhvcnNoaXBzOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIGJvb2s6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCB0aXRsZTogdHJ1ZSwgc3RhdHVzOiB0cnVlLCBpc2JuUGFwZXJiYWNrOiB0cnVlIH0gfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICByb3lhbHRpZXM6IHtcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgICAgIHRha2U6IDIwLFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICBib29rOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUgfSB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJhbmtEZXRhaWxzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDYWxjdWxhdGUgcm95YWx0eSBzdW1tYXJ5XG4gICAgICBjb25zdCByb3lhbHR5QWdnID0gYXdhaXQgcHJpc21hLnJveWFsdHkuYWdncmVnYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgYXV0aG9ySWQ6IHVzZXJJZCB9LFxuICAgICAgICBfc3VtOiB7IGFtb3VudDogdHJ1ZSB9LFxuICAgICAgfSk7XG4gICAgICBjb25zdCBwYWlkQWdnID0gYXdhaXQgcHJpc21hLnJveWFsdHkuYWdncmVnYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgYXV0aG9ySWQ6IHVzZXJJZCwgaXNQYWlkOiB0cnVlIH0sXG4gICAgICAgIF9zdW06IHsgYW1vdW50OiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgeyBwYXNzd29yZDogXywgLi4udXNlcldpdGhvdXRQYXNzd29yZCB9ID0gdXNlcjtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAuLi51c2VyV2l0aG91dFBhc3N3b3JkLFxuICAgICAgICAgIHRvdGFsUm95YWx0eTogcm95YWx0eUFnZy5fc3VtLmFtb3VudCB8fCAwLFxuICAgICAgICAgIHBhaWRSb3lhbHR5OiBwYWlkQWdnLl9zdW0uYW1vdW50IHx8IDAsXG4gICAgICAgICAgdW5wYWlkUm95YWx0eTogKHJveWFsdHlBZ2cuX3N1bS5hbW91bnQgfHwgMCkgLSAocGFpZEFnZy5fc3VtLmFtb3VudCB8fCAwKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIE9SREVSUyBBUEkgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL29yZGVycyAtIExpc3QgYWxsIG9yZGVyc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL29yZGVycycpIHtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3Qgc3RhdHVzID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3N0YXR1cycpO1xuICAgICAgY29uc3Qgc2VhcmNoID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3NlYXJjaCcpO1xuICAgICAgY29uc3QgcGFnZSA9IHBhcnNlSW50KHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdwYWdlJykgfHwgJzEnKTtcbiAgICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQodXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2xpbWl0JykgfHwgJzUwJyk7XG4gICAgICBjb25zdCBza2lwID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xuXG4gICAgICBjb25zdCB3aGVyZSA9IHt9O1xuICAgICAgaWYgKHN0YXR1cyAmJiBzdGF0dXMgIT09ICdhbGwnKSB3aGVyZS5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICBpZiAoc2VhcmNoKSB7XG4gICAgICAgIHdoZXJlLk9SID0gW1xuICAgICAgICAgIHsgb3JkZXJOdW1iZXI6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXG4gICAgICAgICAgeyBzaGlwcGluZ05hbWU6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXG4gICAgICAgICAgeyBzaGlwcGluZ0VtYWlsOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxuICAgICAgICBdO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBbb3JkZXJzLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHByaXNtYS5vcmRlci5maW5kTWFueSh7XG4gICAgICAgICAgd2hlcmUsXG4gICAgICAgICAgc2tpcCxcbiAgICAgICAgICB0YWtlOiBsaW1pdCxcbiAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgdXNlcjogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIGVtYWlsOiB0cnVlLCBhdXRob3JVaWQ6IHRydWUgfSB9LFxuICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIGJvb2s6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCB0aXRsZTogdHJ1ZSwgY292ZXJJbWFnZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3VycmVudFN0YWdlOiB0cnVlLFxuICAgICAgICAgICAgc3RhZ2VIaXN0b3J5OiB7XG4gICAgICAgICAgICAgIG9yZGVyQnk6IHsgbW92ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgICAgICAgIHRha2U6IDUsXG4gICAgICAgICAgICAgIGluY2x1ZGU6IHsgc3RhZ2U6IHRydWUgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHByaXNtYS5vcmRlci5jb3VudCh7IHdoZXJlIH0pLFxuICAgICAgXSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIG9yZGVycyxcbiAgICAgICAgcGFnaW5hdGlvbjogeyBwYWdlLCBsaW1pdCwgdG90YWwsIHRvdGFsUGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIGxpbWl0KSB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vb3JkZXJzL3N0YWdlcyAtIEdldCBvcmRlciBzdGFnZXNcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9vcmRlcnMvc3RhZ2VzJykge1xuICAgICAgY29uc3Qgc3RhZ2VzID0gYXdhaXQgcHJpc21hLm9yZGVyU3RhZ2UuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyBpc0FjdGl2ZTogdHJ1ZSB9LFxuICAgICAgICBvcmRlckJ5OiB7IHNvcnRPcmRlcjogJ2FzYycgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3RhZ2VzIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL29yZGVycy9baWRdIC0gU2luZ2xlIG9yZGVyIGRldGFpbHNcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvYWRtaW4vb3JkZXJzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDMgJiYgcGF0aFNlZ21lbnRzWzJdICE9PSAnc3RhZ2VzJykge1xuICAgICAgY29uc3Qgb3JkZXJJZCA9IHBhdGhTZWdtZW50c1syXTtcblxuICAgICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBwcmlzbWEub3JkZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgZW1haWw6IHRydWUsIGF1dGhvclVpZDogdHJ1ZSwgcGhvbmU6IHRydWUgfSB9LFxuICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIGJvb2s6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3VycmVudFN0YWdlOiB0cnVlLFxuICAgICAgICAgIHN0YWdlSGlzdG9yeToge1xuICAgICAgICAgICAgb3JkZXJCeTogeyBtb3ZlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgc3RhZ2U6IHRydWUgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghb3JkZXIpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdPcmRlciBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9yZGVyIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFJPWUFMVElFUyBBUEkgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL3JveWFsdGllcyAtIExpc3Qgcm95YWx0aWVzIHdpdGggZmlsdGVyc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3JveWFsdGllcycpIHtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgYXV0aG9yVWlkID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2F1dGhvclVpZCcpO1xuICAgICAgY29uc3QgYXV0aG9ySWQgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnYXV0aG9ySWQnKTtcbiAgICAgIGNvbnN0IGJvb2tJZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdib29rSWQnKTtcbiAgICAgIGNvbnN0IHBlcmlvZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdwZXJpb2QnKTtcbiAgICAgIGNvbnN0IGlzUGFpZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdpc1BhaWQnKTtcbiAgICAgIGNvbnN0IGJ1Y2tldCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdidWNrZXQnKTtcbiAgICAgIGNvbnN0IHBhZ2UgPSBwYXJzZUludCh1cmwuc2VhcmNoUGFyYW1zLmdldCgncGFnZScpIHx8ICcxJyk7XG4gICAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICc1MCcpO1xuICAgICAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBsaW1pdDtcblxuICAgICAgY29uc3Qgd2hlcmUgPSB7fTtcbiAgICAgIGlmIChhdXRob3JVaWQpIHdoZXJlLmF1dGhvclVpZCA9IGF1dGhvclVpZDtcbiAgICAgIGlmIChhdXRob3JJZCkgd2hlcmUuYXV0aG9ySWQgPSBhdXRob3JJZDtcbiAgICAgIGlmIChib29rSWQpIHdoZXJlLmJvb2tJZCA9IGJvb2tJZDtcbiAgICAgIGlmIChwZXJpb2QpIHdoZXJlLnBlcmlvZCA9IHBlcmlvZDtcbiAgICAgIGlmIChpc1BhaWQgPT09ICd0cnVlJykgd2hlcmUuaXNQYWlkID0gdHJ1ZTtcbiAgICAgIGlmIChpc1BhaWQgPT09ICdmYWxzZScpIHdoZXJlLmlzUGFpZCA9IGZhbHNlO1xuICAgICAgaWYgKGJ1Y2tldCkgd2hlcmUuYnVja2V0ID0gYnVja2V0O1xuXG4gICAgICBjb25zdCBbcm95YWx0aWVzLCB0b3RhbCwgYWdncmVnYXRlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHByaXNtYS5yb3lhbHR5LmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZSxcbiAgICAgICAgICBza2lwLFxuICAgICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBhdXRob3I6IHsgXG4gICAgICAgICAgICAgIHNlbGVjdDogeyBcbiAgICAgICAgICAgICAgICBpZDogdHJ1ZSwgXG4gICAgICAgICAgICAgICAgbmFtZTogdHJ1ZSwgXG4gICAgICAgICAgICAgICAgZW1haWw6IHRydWUsIFxuICAgICAgICAgICAgICAgIGF1dGhvclVpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBiYW5rRGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnROdW1iZXI6IHRydWUsIGlmc2NDb2RlOiB0cnVlLCBhY2NvdW50TmFtZTogdHJ1ZSwgYmFua05hbWU6IHRydWUgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib29rOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUsIGlzYm46IHRydWUsIGlzYm5QYXBlcmJhY2s6IHRydWUsIGlzYm5IYXJkY292ZXI6IHRydWUgfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgICBwcmlzbWEucm95YWx0eS5jb3VudCh7IHdoZXJlIH0pLFxuICAgICAgICBwcmlzbWEucm95YWx0eS5hZ2dyZWdhdGUoe1xuICAgICAgICAgIHdoZXJlLFxuICAgICAgICAgIF9zdW06IHsgYW1vdW50OiB0cnVlLCBzYWxlQW1vdW50OiB0cnVlIH0sXG4gICAgICAgIH0pLFxuICAgICAgXSk7XG5cbiAgICAgIC8vIEdldCBwYWlkIHZzIHVucGFpZCBicmVha2Rvd25cbiAgICAgIGNvbnN0IHBhaWRBZ2cgPSBhd2FpdCBwcmlzbWEucm95YWx0eS5hZ2dyZWdhdGUoe1xuICAgICAgICB3aGVyZTogeyAuLi53aGVyZSwgaXNQYWlkOiB0cnVlIH0sXG4gICAgICAgIF9zdW06IHsgYW1vdW50OiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgcm95YWx0aWVzLFxuICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2UsIGxpbWl0LCB0b3RhbCwgdG90YWxQYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gbGltaXQpIH0sXG4gICAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgICB0b3RhbEFtb3VudDogYWdncmVnYXRlcy5fc3VtLmFtb3VudCB8fCAwLFxuICAgICAgICAgIHRvdGFsU2FsZXM6IGFnZ3JlZ2F0ZXMuX3N1bS5zYWxlQW1vdW50IHx8IDAsXG4gICAgICAgICAgcGFpZEFtb3VudDogcGFpZEFnZy5fc3VtLmFtb3VudCB8fCAwLFxuICAgICAgICAgIHBlbmRpbmdBbW91bnQ6IChhZ2dyZWdhdGVzLl9zdW0uYW1vdW50IHx8IDApIC0gKHBhaWRBZ2cuX3N1bS5hbW91bnQgfHwgMCksXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZG1pbi9yb3lhbHRpZXMvcGVyaW9kcyAtIEdldCBhdmFpbGFibGUgcGVyaW9kc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3JveWFsdGllcy9wZXJpb2RzJykge1xuICAgICAgY29uc3QgcGVyaW9kcyA9IGF3YWl0IHByaXNtYS5yb3lhbHR5Lmdyb3VwQnkoe1xuICAgICAgICBieTogWydwZXJpb2QnXSxcbiAgICAgICAgX3N1bTogeyBhbW91bnQ6IHRydWUgfSxcbiAgICAgICAgb3JkZXJCeTogeyBwZXJpb2Q6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHBlcmlvZHM6IHBlcmlvZHMuZmlsdGVyKHAgPT4gcC5wZXJpb2QpLm1hcChwID0+ICh7XG4gICAgICAgICAgcGVyaW9kOiBwLnBlcmlvZCxcbiAgICAgICAgICB0b3RhbEFtb3VudDogcC5fc3VtLmFtb3VudCB8fCAwLFxuICAgICAgICB9KSksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZG1pbi9yb3lhbHRpZXMvYnktYXV0aG9yIC0gUm95YWx0aWVzIGdyb3VwZWQgYnkgYXV0aG9yXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vcm95YWx0aWVzL2J5LWF1dGhvcicpIHtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgcGVyaW9kID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3BlcmlvZCcpO1xuXG4gICAgICBjb25zdCB3aGVyZSA9IHBlcmlvZCA/IHsgcGVyaW9kIH0gOiB7fTtcblxuICAgICAgY29uc3Qgcm95YWx0aWVzID0gYXdhaXQgcHJpc21hLnJveWFsdHkuZ3JvdXBCeSh7XG4gICAgICAgIGJ5OiBbJ2F1dGhvcklkJywgJ2F1dGhvclVpZCddLFxuICAgICAgICB3aGVyZSxcbiAgICAgICAgX3N1bTogeyBhbW91bnQ6IHRydWUsIHNhbGVBbW91bnQ6IHRydWUgfSxcbiAgICAgICAgX2NvdW50OiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEdldCBhdXRob3IgZGV0YWlsc1xuICAgICAgY29uc3QgYXV0aG9ySWRzID0gcm95YWx0aWVzLm1hcChyID0+IHIuYXV0aG9ySWQpO1xuICAgICAgY29uc3QgYXV0aG9ycyA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHsgaW46IGF1dGhvcklkcyB9IH0sXG4gICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgZW1haWw6IHRydWUsIGF1dGhvclVpZDogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGF1dGhvcnNNYXAgPSBuZXcgTWFwKGF1dGhvcnMubWFwKGEgPT4gW2EuaWQsIGFdKSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHJveWFsdGllc0J5QXV0aG9yOiByb3lhbHRpZXMubWFwKHIgPT4gKHtcbiAgICAgICAgICBhdXRob3I6IGF1dGhvcnNNYXAuZ2V0KHIuYXV0aG9ySWQpLFxuICAgICAgICAgIHRvdGFsQW1vdW50OiByLl9zdW0uYW1vdW50IHx8IDAsXG4gICAgICAgICAgdG90YWxTYWxlczogci5fc3VtLnNhbGVBbW91bnQgfHwgMCxcbiAgICAgICAgICBjb3VudDogci5fY291bnQsXG4gICAgICAgIH0pKSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFBBQ0tBR0VTIEFQSSA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vcGFja2FnZXMgLSBMaXN0IGFsbCBwYWNrYWdlcyAoaW5jbHVkaW5nIGluYWN0aXZlKVxuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3BhY2thZ2VzJykge1xuICAgICAgY29uc3QgcGFja2FnZXMgPSBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1BhY2thZ2UuZmluZE1hbnkoe1xuICAgICAgICBvcmRlckJ5OiB7IHNvcnRPcmRlcjogJ2FzYycgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcGFja2FnZXMgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vcGFja2FnZXMvW2lkXSAtIFNpbmdsZSBwYWNrYWdlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2FkbWluL3BhY2thZ2VzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIGNvbnN0IHBhY2thZ2VJZCA9IHBhdGhTZWdtZW50c1syXTtcblxuICAgICAgY29uc3QgcGtnID0gYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdQYWNrYWdlLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogcGFja2FnZUlkIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFwa2cpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdQYWNrYWdlIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcGFja2FnZTogcGtnIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCBwdWJsaXNoaW5nIHBhY2thZ2VzXG4gICAgaWYgKHBhdGggPT09ICcvcGFja2FnZXMnKSB7XG4gICAgICBjb25zdCBwYWNrYWdlcyA9IGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nUGFja2FnZS5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IGlzQWN0aXZlOiB0cnVlIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgc29ydE9yZGVyOiAnYXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHBhY2thZ2VzIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCBibG9nIHBvc3RzXG4gICAgaWYgKHBhdGggPT09ICcvYmxvZycpIHtcbiAgICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IGNhdGVnb3J5ID0gc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnknKTtcblxuICAgICAgY29uc3Qgd2hlcmUgPSB7IGlzUHVibGlzaGVkOiB0cnVlIH07XG4gICAgICBpZiAoY2F0ZWdvcnkpIHdoZXJlLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XG5cbiAgICAgIGNvbnN0IHBvc3RzID0gYXdhaXQgcHJpc21hLmJsb2dQb3N0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIG9yZGVyQnk6IHsgcHVibGlzaGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHBvc3RzIH0pO1xuICAgIH1cblxuICAgIC8vIFBheW1lbnQgc3RhdHVzIGNoZWNrXG4gICAgaWYgKHBhdGggPT09ICcvcGF5bWVudC9zdGF0dXMnKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBjb25maWd1cmVkOiBpc1Jhem9ycGF5Q29uZmlndXJlZCgpLFxuICAgICAgICBtZXNzYWdlOiBpc1Jhem9ycGF5Q29uZmlndXJlZCgpXG4gICAgICAgICAgPyAnUmF6b3JwYXkgaXMgY29uZmlndXJlZCBhbmQgcmVhZHknXG4gICAgICAgICAgOiAnUmF6b3JwYXkgaXMgbm90IGNvbmZpZ3VyZWQuIEFkZCBSQVpPUlBBWV9LRVlfSUQgYW5kIFJBWk9SUEFZX0tFWV9TRUNSRVQgdG8gZW5hYmxlIHBheW1lbnRzLicsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBORVcgQVBJIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gR0VUIC9hcGkvc2V0dGluZ3NcbiAgICBpZiAocGF0aCA9PT0gJy9zZXR0aW5ncycpIHtcbiAgICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IGNhdGVnb3J5ID0gc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnknKTtcbiAgICAgIGNvbnN0IGtleSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2tleScpO1xuXG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgZ2V0U2V0dGluZyhrZXkpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBrZXksIHZhbHVlIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBhd2FpdCBnZXRTZXR0aW5nc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzZXR0aW5ncyB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYWxsU2V0dGluZ3MgPSBhd2FpdCBwcmlzbWEuc2l0ZVNldHRpbmcuZmluZE1hbnkoKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHNldHRpbmdzOiBhbGxTZXR0aW5ncyB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZGRvbnNcbiAgICBpZiAocGF0aCA9PT0gJy9hZGRvbnMnKSB7XG4gICAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICBjb25zdCBzZXJ2aWNlVHlwZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NlcnZpY2VUeXBlJyk7XG5cbiAgICAgIGNvbnN0IHdoZXJlID0geyBpc0FjdGl2ZTogdHJ1ZSB9O1xuICAgICAgaWYgKHNlcnZpY2VUeXBlKSB7XG4gICAgICAgIHdoZXJlLnNlcnZpY2VUeXBlID0gc2VydmljZVR5cGU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFkZE9ucyA9IGF3YWl0IHByaXNtYS5zZXJ2aWNlQWRkT24uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZSxcbiAgICAgICAgb3JkZXJCeTogeyBzb3J0T3JkZXI6ICdhc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYWRkT25zIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL3Jldmlld3NcbiAgICBpZiAocGF0aCA9PT0gJy9yZXZpZXdzJykge1xuICAgICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgZGlzcGxheU9uID0gc2VhcmNoUGFyYW1zLmdldCgnZGlzcGxheU9uJyk7XG4gICAgICBjb25zdCBib29rSWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdib29rSWQnKTtcbiAgICAgIGNvbnN0IGZlYXR1cmVkID0gc2VhcmNoUGFyYW1zLmdldCgnZmVhdHVyZWQnKTtcblxuICAgICAgY29uc3Qgd2hlcmUgPSB7IGlzQXBwcm92ZWQ6IHRydWUgfTtcbiAgICAgIGlmIChib29rSWQpIHdoZXJlLmJvb2tJZCA9IGJvb2tJZDtcbiAgICAgIGlmIChmZWF0dXJlZCA9PT0gJ3RydWUnKSB3aGVyZS5pc0ZlYXR1cmVkID0gdHJ1ZTtcblxuICAgICAgbGV0IHJldmlld3MgPSBhd2FpdCBwcmlzbWEucmV2aWV3LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgdGFrZTogMjAsXG4gICAgICB9KTtcblxuICAgICAgaWYgKGRpc3BsYXlPbikge1xuICAgICAgICByZXZpZXdzID0gcmV2aWV3cy5maWx0ZXIociA9PiB7XG4gICAgICAgICAgY29uc3QgZGlzcGxheXMgPSByLmRpc3BsYXlPbiB8fCBbXTtcbiAgICAgICAgICByZXR1cm4gZGlzcGxheXMuaW5jbHVkZXMoZGlzcGxheU9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJldmlld3MgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvY2F0ZWdvcmllc1xuICAgIGlmIChwYXRoID09PSAnL2NhdGVnb3JpZXMnKSB7XG4gICAgICBjb25zdCBjYXRlZ29yaWVzID0gYXdhaXQgcHJpc21hLmNhdGVnb3J5LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgb3JkZXJCeTogeyBzb3J0T3JkZXI6ICdhc2MnIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBjaGlsZHJlbjoge1xuICAgICAgICAgICAgd2hlcmU6IHsgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgc29ydE9yZGVyOiAnYXNjJyB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdG9wTGV2ZWwgPSBjYXRlZ29yaWVzLmZpbHRlcihjID0+ICFjLnBhcmVudElkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNhdGVnb3JpZXM6IHRvcExldmVsIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FudGhvbG9neS9jb3VudFxuICAgIGlmIChwYXRoID09PSAnL2FudGhvbG9neS9jb3VudCcpIHtcbiAgICAgIGNvbnN0IHR3ZW50eUZvdXJIb3Vyc0FnbyA9IG5ldyBEYXRlKERhdGUubm93KCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIFxuICAgICAgY29uc3QgY291bnQgPSBhd2FpdCBwcmlzbWEuYW50aG9sb2d5U3VibWlzc2lvbi5jb3VudCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiB7IGd0ZTogdHdlbnR5Rm91ckhvdXJzQWdvIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgY291bnQsIHBlcmlvZDogJzI0aCcgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvZGlzY291bnRzXG4gICAgaWYgKHBhdGggPT09ICcvZGlzY291bnRzJykge1xuICAgICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3QgY29kZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2NvZGUnKTtcbiAgICAgIGNvbnN0IGFwcGxpZXNUbyA9IHNlYXJjaFBhcmFtcy5nZXQoJ2FwcGxpZXNUbycpO1xuXG4gICAgICBpZiAoY29kZSkge1xuICAgICAgICBjb25zdCBkaXNjb3VudCA9IGF3YWl0IHByaXNtYS5kaXNjb3VudC5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBjb2RlIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghZGlzY291bnQgfHwgIWRpc2NvdW50LmlzQWN0aXZlKSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdmFsaWQ6IGZhbHNlLCBlcnJvcjogJ0ludmFsaWQgb3IgZXhwaXJlZCBjb2RlJyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXNjb3VudC5leHBpcmVzQXQgJiYgbmV3IERhdGUoKSA+IGRpc2NvdW50LmV4cGlyZXNBdCkge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHZhbGlkOiBmYWxzZSwgZXJyb3I6ICdDb2RlIGhhcyBleHBpcmVkJyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXNjb3VudC5tYXhVc2VzICYmIGRpc2NvdW50LnVzZWRDb3VudCA+PSBkaXNjb3VudC5tYXhVc2VzKSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdmFsaWQ6IGZhbHNlLCBlcnJvcjogJ0NvZGUgdXNhZ2UgbGltaXQgcmVhY2hlZCcgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB2YWxpZDogdHJ1ZSwgZGlzY291bnQgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHdoZXJlID0geyBpc0FjdGl2ZTogdHJ1ZSB9O1xuICAgICAgaWYgKGFwcGxpZXNUbykge1xuICAgICAgICB3aGVyZS5hcHBsaWVzVG8gPSB7IGluOiBbYXBwbGllc1RvLCAnYWxsJ10gfTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGlzY291bnRzID0gYXdhaXQgcHJpc21hLmRpc2NvdW50LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBkaXNjb3VudHMgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvaG9tZXBhZ2UgLSBIb21lcGFnZSBkYXRhXG4gICAgaWYgKHBhdGggPT09ICcvaG9tZXBhZ2UnKSB7XG4gICAgICBjb25zdCBzaG93UmVjZW50UmVsZWFzZXMgPSBhd2FpdCBnZXRTZXR0aW5nKCdob21lcGFnZS5zaG93X3JlY2VudF9yZWxlYXNlcycpO1xuICAgICAgY29uc3Qgc2hvd0Jlc3RTZWxsZXJzID0gYXdhaXQgZ2V0U2V0dGluZygnaG9tZXBhZ2Uuc2hvd19iZXN0X3NlbGxlcnMnKTtcbiAgICAgIGNvbnN0IGJlc3RTZWxsZXJzTW9kZSA9IGF3YWl0IGdldFNldHRpbmcoJ2hvbWVwYWdlLmJlc3Rfc2VsbGVyc19tb2RlJyk7XG4gICAgICBjb25zdCBzaG93TGl2ZUNvdW50ZXIgPSBhd2FpdCBnZXRTZXR0aW5nKCdob21lcGFnZS5zaG93X2xpdmVfY291bnRlcicpO1xuICAgICAgY29uc3QgcHVibGlzaGluZ1N0ZXBzID0gYXdhaXQgZ2V0U2V0dGluZygnaG9tZXBhZ2UucHVibGlzaGluZ19zdGVwcycpO1xuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgIHNob3dSZWNlbnRSZWxlYXNlcyxcbiAgICAgICAgICBzaG93QmVzdFNlbGxlcnMsXG4gICAgICAgICAgYmVzdFNlbGxlcnNNb2RlLFxuICAgICAgICAgIHNob3dMaXZlQ291bnRlcixcbiAgICAgICAgICBwdWJsaXNoaW5nU3RlcHMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBpZiAoc2hvd1JlY2VudFJlbGVhc2VzKSB7XG4gICAgICAgIGRhdGEucmVjZW50UmVsZWFzZXMgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAgICAgaXNBdXRob3JDb3B5OiBmYWxzZSxcbiAgICAgICAgICAgIHN0YXR1czogJ1BVQkxJU0hFRCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcmRlckJ5OiB7IHB1Ymxpc2hlZERhdGU6ICdkZXNjJyB9LFxuICAgICAgICAgIHRha2U6IDgsXG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIHRpdGxlOiB0cnVlLFxuICAgICAgICAgICAgY292ZXJJbWFnZTogdHJ1ZSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxuICAgICAgICAgICAgZ2VucmU6IHRydWUsXG4gICAgICAgICAgICBhdXRob3I6IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2hvd0Jlc3RTZWxsZXJzKSB7XG4gICAgICAgIGlmIChiZXN0U2VsbGVyc01vZGUgPT09ICdtYW51YWwnKSB7XG4gICAgICAgICAgZGF0YS5iZXN0U2VsbGVycyA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAgICAgICBpc0F1dGhvckNvcHk6IGZhbHNlLFxuICAgICAgICAgICAgICBpc0Jlc3RTZWxsZXI6IHRydWUsXG4gICAgICAgICAgICAgIGJlc3RTZWxsZXJNYW51YWw6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGFrZTogOCxcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgICAgIGNvdmVySW1hZ2U6IHRydWUsXG4gICAgICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxuICAgICAgICAgICAgICBnZW5yZTogdHJ1ZSxcbiAgICAgICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBuYW1lOiB0cnVlIH0gfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF0YS5iZXN0U2VsbGVycyA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAgICAgICBpc0F1dGhvckNvcHk6IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgc2FsZXNDb3VudDogJ2Rlc2MnIH0sXG4gICAgICAgICAgICB0YWtlOiA4LFxuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICB0aXRsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgY292ZXJJbWFnZTogdHJ1ZSxcbiAgICAgICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXG4gICAgICAgICAgICAgIGdlbnJlOiB0cnVlLFxuICAgICAgICAgICAgICBhdXRob3I6IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoc2hvd0xpdmVDb3VudGVyKSB7XG4gICAgICAgIGRhdGEuYm9va3NQdWJsaXNoZWQgPSBhd2FpdCBwcmlzbWEuYm9vay5jb3VudCh7XG4gICAgICAgICAgd2hlcmU6IHsgc3RhdHVzOiAnUFVCTElTSEVEJyB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZGF0YS5yZXZpZXdzID0gYXdhaXQgcHJpc21hLnJldmlldy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgaXNBcHByb3ZlZDogdHJ1ZSxcbiAgICAgICAgICBpc0ZlYXR1cmVkOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICB0YWtlOiA2LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhKTtcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBCTE9HIFNZU1RFTSBBUElzID09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBHRVQgL2FwaS9ibG9nIC0gTGlzdCBwdWJsaXNoZWQgYmxvZyBwb3N0cyAocHVibGljKVxuICAgIGlmIChwYXRoID09PSAnL2Jsb2cnKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IHBhZ2UgPSBwYXJzZUludCh1cmwuc2VhcmNoUGFyYW1zLmdldCgncGFnZScpIHx8ICcxJyk7XG4gICAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICcxMicpO1xuICAgICAgY29uc3QgY2F0ZWdvcnkgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnknKTtcbiAgICAgIGNvbnN0IHNraXAgPSAocGFnZSAtIDEpICogbGltaXQ7XG5cbiAgICAgIGNvbnN0IHdoZXJlID0geyBpc1B1Ymxpc2hlZDogdHJ1ZSB9O1xuICAgICAgaWYgKGNhdGVnb3J5KSB3aGVyZS5jYXRlZ29yeSA9IGNhdGVnb3J5O1xuXG4gICAgICBjb25zdCBbcG9zdHMsIHRvdGFsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgcHJpc21hLmJsb2dQb3N0LmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZSxcbiAgICAgICAgICBvcmRlckJ5OiB7IHB1Ymxpc2hlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgICBza2lwLFxuICAgICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICB0aXRsZTogdHJ1ZSxcbiAgICAgICAgICAgIHNsdWc6IHRydWUsXG4gICAgICAgICAgICBleGNlcnB0OiB0cnVlLFxuICAgICAgICAgICAgY292ZXJJbWFnZTogdHJ1ZSxcbiAgICAgICAgICAgIGF1dGhvck5hbWU6IHRydWUsXG4gICAgICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcbiAgICAgICAgICAgIHRhZ3M6IHRydWUsXG4gICAgICAgICAgICB2aWV3czogdHJ1ZSxcbiAgICAgICAgICAgIHB1Ymxpc2hlZEF0OiB0cnVlLFxuICAgICAgICAgICAgX2NvdW50OiB7IHNlbGVjdDogeyBjb21tZW50czogeyB3aGVyZTogeyBpc0FwcHJvdmVkOiB0cnVlIH0gfSwgbGlrZXM6IHRydWUgfSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgICBwcmlzbWEuYmxvZ1Bvc3QuY291bnQoeyB3aGVyZSB9KSxcbiAgICAgIF0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBwb3N0cyxcbiAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgIHBhZ2UsXG4gICAgICAgICAgbGltaXQsXG4gICAgICAgICAgdG90YWwsXG4gICAgICAgICAgdG90YWxQYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gbGltaXQpLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYmxvZy9bc2x1Z10gLSBTaW5nbGUgYmxvZyBwb3N0IChwdWJsaWMpXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2Jsb2cvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMiAmJiBwYXRoU2VnbWVudHNbMV0gIT09ICdjYXRlZ29yaWVzJykge1xuICAgICAgY29uc3Qgc2x1ZyA9IHBhdGhTZWdtZW50c1sxXTtcblxuICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IHByaXNtYS5ibG9nUG9zdC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgc2x1ZyB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGlzQXBwcm92ZWQ6IHRydWUgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIF9jb3VudDogeyBzZWxlY3Q6IHsgbGlrZXM6IHRydWUgfSB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcG9zdCB8fCAhcG9zdC5pc1B1Ymxpc2hlZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1Bvc3Qgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBJbmNyZW1lbnQgdmlld3NcbiAgICAgIGF3YWl0IHByaXNtYS5ibG9nUG9zdC51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogcG9zdC5pZCB9LFxuICAgICAgICBkYXRhOiB7IHZpZXdzOiB7IGluY3JlbWVudDogMSB9IH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gR2V0IGxpbmtlZCBib29rIGlmIGV4aXN0c1xuICAgICAgbGV0IGxpbmtlZEJvb2sgPSBudWxsO1xuICAgICAgaWYgKHBvc3QubGlua2VkQm9va0lkKSB7XG4gICAgICAgIGxpbmtlZEJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogcG9zdC5saW5rZWRCb29rSWQgfSxcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgICBjb3ZlckltYWdlOiB0cnVlLFxuICAgICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBuYW1lOiB0cnVlIH0gfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcG9zdDogeyAuLi5wb3N0LCBsaW5rZWRCb29rIH0gfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYmxvZy9jYXRlZ29yaWVzIC0gQmxvZyBjYXRlZ29yaWVzXG4gICAgaWYgKHBhdGggPT09ICcvYmxvZy9jYXRlZ29yaWVzJykge1xuICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IHByaXNtYS5ibG9nUG9zdC5ncm91cEJ5KHtcbiAgICAgICAgYnk6IFsnY2F0ZWdvcnknXSxcbiAgICAgICAgd2hlcmU6IHsgaXNQdWJsaXNoZWQ6IHRydWUsIGNhdGVnb3J5OiB7IG5vdDogbnVsbCB9IH0sXG4gICAgICAgIF9jb3VudDogeyBjYXRlZ29yeTogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIGNhdGVnb3JpZXM6IGNhdGVnb3JpZXMuZmlsdGVyKGMgPT4gYy5jYXRlZ29yeSkubWFwKGMgPT4gKHtcbiAgICAgICAgICBuYW1lOiBjLmNhdGVnb3J5LFxuICAgICAgICAgIGNvdW50OiBjLl9jb3VudC5jYXRlZ29yeSxcbiAgICAgICAgfSkpLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vYmxvZyAtIEFsbCBibG9nIHBvc3RzIChhZG1pbilcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9ibG9nJykge1xuICAgICAgY29uc3QgcG9zdHMgPSBhd2FpdCBwcmlzbWEuYmxvZ1Bvc3QuZmluZE1hbnkoe1xuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBfY291bnQ6IHsgc2VsZWN0OiB7IGNvbW1lbnRzOiB0cnVlLCBsaWtlczogdHJ1ZSB9IH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcG9zdHMgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vYmxvZy9jb21tZW50cyAtIFBlbmRpbmcgY29tbWVudHMgKGFkbWluKSAtIE1VU1QgQkUgQkVGT1JFIC9hZG1pbi9ibG9nL1tpZF1cbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9ibG9nL2NvbW1lbnRzJykge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICBjb25zdCBhcHByb3ZlZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdhcHByb3ZlZCcpO1xuXG4gICAgICBjb25zdCB3aGVyZSA9IHt9O1xuICAgICAgaWYgKGFwcHJvdmVkID09PSAndHJ1ZScpIHdoZXJlLmlzQXBwcm92ZWQgPSB0cnVlO1xuICAgICAgZWxzZSBpZiAoYXBwcm92ZWQgPT09ICdmYWxzZScpIHdoZXJlLmlzQXBwcm92ZWQgPSBmYWxzZTtcblxuICAgICAgY29uc3QgY29tbWVudHMgPSBhd2FpdCBwcmlzbWEuYmxvZ0NvbW1lbnQuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZSxcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgcG9zdDogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIHRpdGxlOiB0cnVlLCBzbHVnOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBjb21tZW50cyB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZG1pbi9ibG9nL1tpZF0gLSBTaW5nbGUgYmxvZyBwb3N0IGZvciBlZGl0aW5nIChhZG1pbilcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvYWRtaW4vYmxvZy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICBjb25zdCBwb3N0SWQgPSBwYXRoU2VnbWVudHNbMl07XG5cbiAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBwcmlzbWEuYmxvZ1Bvc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwb3N0SWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGNvbW1lbnRzOiB7IG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcG9zdCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1Bvc3Qgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBwb3N0IH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL2d1ZXN0LXBvc3RzIC0gR3Vlc3QgcG9zdCBzdWJtaXNzaW9ucyAoYWRtaW4pXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vZ3Vlc3QtcG9zdHMnKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IHN0YXR1cyA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdzdGF0dXMnKSB8fCAncGVuZGluZyc7XG5cbiAgICAgIGNvbnN0IGd1ZXN0UG9zdHMgPSBhd2FpdCBwcmlzbWEuZ3Vlc3RQb3N0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHN0YXR1cyA9PT0gJ2FsbCcgPyB7fSA6IHsgc3RhdHVzIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBndWVzdFBvc3RzIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FudGhvbG9neS9zdGF0cyAtIEFudGhvbG9neSBzdWJtaXNzaW9uIHN0YXRzXG4gICAgaWYgKHBhdGggPT09ICcvYW50aG9sb2d5L3N0YXRzJykge1xuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgIGNvbnN0IHR3ZW50eUZvdXJIb3Vyc0FnbyA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcblxuICAgICAgY29uc3QgW3RvdGFsLCB0b2RheV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHByaXNtYS5hbnRob2xvZ3lTdWJtaXNzaW9uLmNvdW50KCksXG4gICAgICAgIHByaXNtYS5hbnRob2xvZ3lTdWJtaXNzaW9uLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyBjcmVhdGVkQXQ6IHsgZ3RlOiB0d2VudHlGb3VySG91cnNBZ28gfSB9LFxuICAgICAgICB9KSxcbiAgICAgIF0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0b3RhbCwgdG9kYXkgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vYW50aG9sb2d5IC0gQW50aG9sb2d5IHN1Ym1pc3Npb25zIChhZG1pbilcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9hbnRob2xvZ3knKSB7XG4gICAgICBjb25zdCBzdWJtaXNzaW9ucyA9IGF3YWl0IHByaXNtYS5hbnRob2xvZ3lTdWJtaXNzaW9uLmZpbmRNYW55KHtcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Ym1pc3Npb25zIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL3Nob3AvYm9va3NcbiAgICBpZiAocGF0aCA9PT0gJy9zaG9wL2Jvb2tzJykge1xuICAgICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgICAgY29uc3Qgc2VhcmNoID0gc2VhcmNoUGFyYW1zLmdldCgnc2VhcmNoJyk7XG4gICAgICBjb25zdCBjYXRlZ29yeSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2NhdGVnb3J5Jyk7XG4gICAgICBjb25zdCB1c2VySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCd1c2VySWQnKTsgLy8gRm9yIGF1dGhvciBjb3BpZXMgdmlzaWJpbGl0eVxuXG4gICAgICBjb25zdCB3aGVyZSA9IHtcbiAgICAgICAgaXNQdWJsaWM6IHRydWUsXG4gICAgICAgIHN0YXR1czogJ1BVQkxJU0hFRCcsXG4gICAgICB9O1xuXG4gICAgICAvLyBPbmx5IHNob3cgYXV0aG9yIGNvcGllcyB0byBsb2dnZWQtaW4gbWF0Y2hpbmcgYXV0aG9yc1xuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgd2hlcmUuaXNBdXRob3JDb3B5ID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgd2hlcmUuT1IgPSBbXG4gICAgICAgICAgeyB0aXRsZTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgICB7IGlzYm46IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXG4gICAgICAgICAgeyBhdXRob3I6IHsgbmFtZTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSB9LFxuICAgICAgICBdO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgd2hlcmUuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYm9va3MgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgZXh0ZXJuYWxMaW5rczogdHJ1ZSxcbiAgICAgICAgICBjYXRlZ29yaWVzOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7IGNhdGVnb3J5OiB0cnVlIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeTogeyBwdWJsaXNoZWREYXRlOiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGaWx0ZXIgYXV0aG9yIGNvcGllcyAtIG9ubHkgc2hvdyB0byBtYXRjaGluZyBhdXRob3JcbiAgICAgIGNvbnN0IGZpbHRlcmVkQm9va3MgPSBib29rcy5maWx0ZXIoYm9vayA9PiB7XG4gICAgICAgIGlmIChib29rLmlzQXV0aG9yQ29weSkge1xuICAgICAgICAgIHJldHVybiBib29rLmF1dGhvcklkID09PSB1c2VySWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYm9va3M6IGZpbHRlcmVkQm9va3MgfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAvLyBBVVRIT1IgQVBJIFJPVVRFU1xuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBHRVQgL2FwaS9hdXRob3IvbWFudXNjcmlwdHMgLSBHZXQgYXV0aG9yJ3MgbWFudXNjcmlwdHNcbiAgICBpZiAocGF0aCA9PT0gJy9hdXRob3IvbWFudXNjcmlwdHMnKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IGF1dGhvcklkUGFyYW0gPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnYXV0aG9ySWQnKTtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGF1dGhvcklkUGFyYW0gfHwgcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWlkJyk7XG4gICAgICBcbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBtYW51c2NyaXB0cyA9IGF3YWl0IHByaXNtYS5tYW51c2NyaXB0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgYXV0aG9ySWQ6IHVzZXJJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYm9vazogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIHRpdGxlOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeTogeyB1cGRhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG1hbnVzY3JpcHRzIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2F1dGhvci9xdWVyaWVzIC0gR2V0IGF1dGhvcidzIHF1ZXJpZXNcbiAgICBpZiAocGF0aCA9PT0gJy9hdXRob3IvcXVlcmllcycpIHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtdXNlci1pZCcpO1xuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHF1ZXJpZXMgPSBhd2FpdCBwcmlzbWEucXVlcnkuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyBhdXRob3JJZDogdXNlcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBib29rOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUgfSB9LFxuICAgICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2FzYycgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcXVlcmllcyB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hdXRob3Ivb3JkZXJzIC0gR2V0IGF1dGhvcidzIG9yZGVyc1xuICAgIGlmIChwYXRoID09PSAnL2F1dGhvci9vcmRlcnMnKSB7XG4gICAgICBjb25zdCB1c2VySWQgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXVzZXItaWQnKTtcbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBvcmRlcnMgPSBhd2FpdCBwcmlzbWEub3JkZXIuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIGJvb2s6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCB0aXRsZTogdHJ1ZSwgY292ZXJJbWFnZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3VycmVudFN0YWdlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb3JkZXJzIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2F1dGhvci9yb3lhbHRpZXMgLSBHZXQgYXV0aG9yJ3Mgcm95YWx0aWVzIHdpdGggZGFpbHkgYnJlYWtkb3duXG4gICAgaWYgKHBhdGggPT09ICcvYXV0aG9yL3JveWFsdGllcycpIHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtdXNlci1pZCcpO1xuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJveWFsdGllcyA9IGF3YWl0IHByaXNtYS5yb3lhbHR5LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgYXV0aG9ySWQ6IHVzZXJJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYm9vazogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIHRpdGxlOiB0cnVlLCBpc2JuOiB0cnVlLCBpc2JuUGFwZXJiYWNrOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEdyb3VwIGJ5IHBlcmlvZCBmb3IgbW9udGhseSBicmVha2Rvd25cbiAgICAgIGNvbnN0IGJ5UGVyaW9kID0gcm95YWx0aWVzLnJlZHVjZSgoYWNjLCByKSA9PiB7XG4gICAgICAgIGNvbnN0IHBlcmlvZCA9IHIucGVyaW9kIHx8ICdVbmtub3duJztcbiAgICAgICAgaWYgKCFhY2NbcGVyaW9kXSkgYWNjW3BlcmlvZF0gPSB7IHRvdGFsOiAwLCBwYWlkOiAwLCBwZW5kaW5nOiAwLCBpdGVtczogW10gfTtcbiAgICAgICAgYWNjW3BlcmlvZF0udG90YWwgKz0gci5hbW91bnQ7XG4gICAgICAgIGlmIChyLmlzUGFpZCkgYWNjW3BlcmlvZF0ucGFpZCArPSByLmFtb3VudDtcbiAgICAgICAgZWxzZSBhY2NbcGVyaW9kXS5wZW5kaW5nICs9IHIuYW1vdW50O1xuICAgICAgICBhY2NbcGVyaW9kXS5pdGVtcy5wdXNoKHIpO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwge30pO1xuXG4gICAgICAvLyBHcm91cCBieSBkYXkgZm9yIGRhaWx5IGJyZWFrZG93biAocmVjZW50IDMwIGRheXMpXG4gICAgICBjb25zdCBsYXN0MzBEYXlzID0gbmV3IERhdGUoKTtcbiAgICAgIGxhc3QzMERheXMuc2V0RGF0ZShsYXN0MzBEYXlzLmdldERhdGUoKSAtIDMwKTtcbiAgICAgIGNvbnN0IHJlY2VudFJveWFsdGllcyA9IHJveWFsdGllcy5maWx0ZXIociA9PiBuZXcgRGF0ZShyLmNyZWF0ZWRBdCkgPj0gbGFzdDMwRGF5cyk7XG4gICAgICBjb25zdCBieURheSA9IHJlY2VudFJveWFsdGllcy5yZWR1Y2UoKGFjYywgcikgPT4ge1xuICAgICAgICBjb25zdCBkYXkgPSBuZXcgRGF0ZShyLmNyZWF0ZWRBdCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgICBpZiAoIWFjY1tkYXldKSBhY2NbZGF5XSA9IHsgdG90YWw6IDAsIGl0ZW1zOiBbXSB9O1xuICAgICAgICBhY2NbZGF5XS50b3RhbCArPSByLmFtb3VudDtcbiAgICAgICAgYWNjW2RheV0uaXRlbXMucHVzaChyKTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgY29uc3Qgc3VtbWFyeSA9IHtcbiAgICAgICAgdG90YWw6IHJveWFsdGllcy5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgci5hbW91bnQsIDApLFxuICAgICAgICBwYWlkOiByb3lhbHRpZXMuZmlsdGVyKHIgPT4gci5pc1BhaWQpLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLmFtb3VudCwgMCksXG4gICAgICAgIHBlbmRpbmc6IHJveWFsdGllcy5maWx0ZXIociA9PiAhci5pc1BhaWQpLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLmFtb3VudCwgMCksXG4gICAgICAgIGJ5QnVja2V0OiB7XG4gICAgICAgICAgV0VCU0lURTogcm95YWx0aWVzLmZpbHRlcihyID0+IHIuYnVja2V0ID09PSAnV0VCU0lURScpLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLmFtb3VudCwgMCksXG4gICAgICAgICAgRUJPT0s6IHJveWFsdGllcy5maWx0ZXIociA9PiByLmJ1Y2tldCA9PT0gJ0VCT09LJykucmVkdWNlKChzdW0sIHIpID0+IHN1bSArIHIuYW1vdW50LCAwKSxcbiAgICAgICAgICBFQ09NTUVSQ0U6IHJveWFsdGllcy5maWx0ZXIociA9PiByLmJ1Y2tldCA9PT0gJ0VDT01NRVJDRScpLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLmFtb3VudCwgMCksXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByb3lhbHRpZXMsIHN1bW1hcnksIGJ5UGVyaW9kLCBieURheSB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hdXRob3Ivc2V0dGluZ3MgLSBHZXQgYXV0aG9yJ3Mgc2V0dGluZ3NcbiAgICBpZiAocGF0aCA9PT0gJy9hdXRob3Ivc2V0dGluZ3MnKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICAgIGNvbnN0IGF1dGhvcklkUGFyYW0gPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnYXV0aG9ySWQnKTtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGF1dGhvcklkUGFyYW0gfHwgcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWlkJyk7XG4gICAgICBcbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiB1c2VySWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGJhbmtEZXRhaWxzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBwcm9maWxlOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIHBob25lOiB1c2VyLnBob25lLFxuICAgICAgICAgIGFsdGVybmF0ZUVtYWlsOiB1c2VyLmFsdGVybmF0ZUVtYWlsLFxuICAgICAgICAgIGFsdGVybmF0ZVBob25lOiB1c2VyLmFsdGVybmF0ZVBob25lLFxuICAgICAgICAgIGJpbzogdXNlci5iaW8sXG4gICAgICAgICAgd2Vic2l0ZTogdXNlci53ZWJzaXRlLFxuICAgICAgICAgIHB1YmxpY1VybDogdXNlci5wdWJsaWNVcmwsXG4gICAgICAgICAgc29jaWFsTGlua3M6IHVzZXIuc29jaWFsTGlua3MsXG4gICAgICAgICAgYXV0aG9yVWlkOiB1c2VyLmF1dGhvclVpZCxcbiAgICAgICAgICBwcm9maWxlSW1hZ2U6IHVzZXIucHJvZmlsZUltYWdlLFxuICAgICAgICB9LFxuICAgICAgICBiYW5rRGV0YWlsczogdXNlci5iYW5rRGV0YWlscyxcbiAgICAgICAgbm90aWZpY2F0aW9uczoge1xuICAgICAgICAgIGVtYWlsTm90aWZpY2F0aW9uczogdHJ1ZSxcbiAgICAgICAgICBzdGFnZVVwZGF0ZXM6IHRydWUsXG4gICAgICAgICAgcXVlcnlSZXNwb25zZXM6IHRydWUsXG4gICAgICAgICAgcm95YWx0eUFsZXJ0czogdHJ1ZSxcbiAgICAgICAgICBtYXJrZXRpbmdFbWFpbHM6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvcHVibGljL2F1dGhvcnMvW3NsdWddIC0gUHVibGljIGF1dGhvciBwcm9maWxlXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL3B1YmxpYy9hdXRob3JzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIGNvbnN0IHNsdWcgPSBwYXRoU2VnbWVudHNbMl07XG5cbiAgICAgIGNvbnN0IGF1dGhvciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRGaXJzdCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgIHsgcHVibGljVXJsOiBzbHVnIH0sXG4gICAgICAgICAgICB7IGlkOiBzbHVnIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgICByb2xlOiAnQVVUSE9SJyxcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICBiaW86IHRydWUsXG4gICAgICAgICAgcHJvZmlsZUltYWdlOiB0cnVlLFxuICAgICAgICAgIHdlYnNpdGU6IHRydWUsXG4gICAgICAgICAgc29jaWFsTGlua3M6IHRydWUsXG4gICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFhdXRob3IpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdBdXRob3Igbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBib29rcyA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBhdXRob3JJZDogYXV0aG9yLmlkLFxuICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAgIHN0YXR1czogJ1BVQkxJU0hFRCcsXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBleHRlcm5hbExpbmtzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IHB1Ymxpc2hlZERhdGU6ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGF1dGhvciwgYm9va3MgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vc2FsZXMgLSBHZXQgYWxsIHNhbGVzIHdpdGggZW5oYW5jZWQgZGF0YVxuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3NhbGVzJykge1xuICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBwcmlzbWEuc2FsZS5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBib29rOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIGF1dGhvcjogeyBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIGF1dGhvclVpZDogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgIHJveWFsdHlDb25maWdzOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IHNhbGVEYXRlOiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGZXRjaCBhbGwgcm95YWx0aWVzIGZvciBzdW1tYXJ5XG4gICAgICBjb25zdCByb3lhbHRpZXMgPSBhd2FpdCBwcmlzbWEucm95YWx0eS5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhdXRob3I6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBhdXRob3JVaWQ6IHRydWUgfSB9LFxuICAgICAgICAgIGJvb2s6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCB0aXRsZTogdHJ1ZSwgaXNibjogdHJ1ZSwgaXNiblBhcGVyYmFjazogdHJ1ZSwgaXNibkhhcmRjb3ZlcjogdHJ1ZSB9IH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdW1tYXJ5ID0ge1xuICAgICAgICB0b3RhbFNhbGVzOiBzYWxlcy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy50b3RhbEFtb3VudCwgMCksXG4gICAgICAgIHRvdGFsVW5pdHM6IHNhbGVzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnF1YW50aXR5LCAwKSxcbiAgICAgICAgdG90YWxSb3lhbHRpZXM6IHJveWFsdGllcy5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgci5hbW91bnQsIDApLFxuICAgICAgICBwZW5kaW5nUm95YWx0aWVzOiByb3lhbHRpZXMuZmlsdGVyKHIgPT4gIXIuaXNQYWlkKS5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgci5hbW91bnQsIDApLFxuICAgICAgICBwYWlkUm95YWx0aWVzOiByb3lhbHRpZXMuZmlsdGVyKHIgPT4gci5pc1BhaWQpLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLmFtb3VudCwgMCksXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzYWxlcywgcm95YWx0aWVzLCBzdW1tYXJ5IH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL3JveWFsdGllcyAtIEdldCBhbGwgcm95YWx0aWVzIHdpdGggZnVsbCBkZXRhaWxzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vcm95YWx0aWVzJykge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgICBjb25zdCBpc1BhaWRGaWx0ZXIgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnaXNQYWlkJyk7XG4gICAgICBjb25zdCBwbGF0Zm9ybSA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdwbGF0Zm9ybScpO1xuICAgICAgY29uc3QgcGVyaW9kID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3BlcmlvZCcpO1xuXG4gICAgICBjb25zdCB3aGVyZSA9IHt9O1xuICAgICAgaWYgKGlzUGFpZEZpbHRlciAhPT0gbnVsbCAmJiBpc1BhaWRGaWx0ZXIgIT09ICdhbGwnKSB7XG4gICAgICAgIHdoZXJlLmlzUGFpZCA9IGlzUGFpZEZpbHRlciA9PT0gJ3RydWUnO1xuICAgICAgfVxuICAgICAgaWYgKHBsYXRmb3JtICYmIHBsYXRmb3JtICE9PSAnYWxsJykge1xuICAgICAgICB3aGVyZS5PUiA9IFt7IHBsYXRmb3JtIH0sIHsgYnVja2V0OiBwbGF0Zm9ybSB9XTtcbiAgICAgIH1cbiAgICAgIGlmIChwZXJpb2QgJiYgcGVyaW9kICE9PSAnYWxsJykge1xuICAgICAgICB3aGVyZS5wZXJpb2QgPSBwZXJpb2Q7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJveWFsdGllcyA9IGF3YWl0IHByaXNtYS5yb3lhbHR5LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhdXRob3I6IHsgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBlbWFpbDogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlIH0gfSxcbiAgICAgICAgICBib29rOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUsIGlzYm46IHRydWUsIGlzYm5QYXBlcmJhY2s6IHRydWUsIGlzYm5IYXJkY292ZXI6IHRydWUgfSB9LFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcm95YWx0aWVzIH0pO1xuICAgIH1cblxuICAgIC8vIEdFVCAvYXBpL2FkbWluL2Jvb2tzL3tib29rSWR9L3JveWFsdHktY29uZmlnIC0gR2V0IHJveWFsdHkgY29uZmlncyBmb3IgYSBib29rXG4gICAgaWYgKHBhdGgubWF0Y2goL15cXC9hZG1pblxcL2Jvb2tzXFwvW14vXStcXC9yb3lhbHR5LWNvbmZpZyQvKSkge1xuICAgICAgY29uc3QgYm9va0lkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgXG4gICAgICBjb25zdCBjb25maWdzID0gYXdhaXQgcHJpc21hLmJvb2tSb3lhbHR5Q29uZmlnLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgYm9va0lkLCBpc0FjdGl2ZTogdHJ1ZSB9LFxuICAgICAgICBvcmRlckJ5OiB7IHBsYXRmb3JtOiAnYXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNvbmZpZ3MgfSk7XG4gICAgfVxuXG4gICAgLy8gR0VUIC9hcGkvYWRtaW4vY29udGVudCAtIEdldCBzaXRlIGNvbnRlbnRcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9jb250ZW50Jykge1xuICAgICAgY29uc3QgY29udGVudHMgPSBhd2FpdCBwcmlzbWEuc2l0ZUNvbnRlbnQuZmluZE1hbnkoe1xuICAgICAgICBvcmRlckJ5OiB7IGtleTogJ2FzYycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBjb250ZW50cyB9KTtcbiAgICB9XG5cbiAgICAvLyBHRVQgL2FwaS9hZG1pbi9pbXBvcnRzIC0gR2V0IGltcG9ydCBoaXN0b3J5XG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vaW1wb3J0cycpIHtcbiAgICAgIGNvbnN0IGltcG9ydHMgPSBhd2FpdCBwcmlzbWEuaW1wb3J0QmF0Y2guZmluZE1hbnkoe1xuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDUwLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGltcG9ydHMgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOb3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQVBJIEdFVCBFcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdCwgY29udGV4dCkge1xuICBjb25zdCBwYXJhbXMgPSBhd2FpdCBjb250ZXh0LnBhcmFtcztcbiAgY29uc3QgcGF0aFNlZ21lbnRzID0gcGFyYW1zPy5wYXRoIHx8IFtdO1xuICBjb25zdCBwYXRoID0gJy8nICsgcGF0aFNlZ21lbnRzLmpvaW4oJy8nKTtcblxuICB0cnkge1xuICAgIC8vIEhhbmRsZSBGb3JtRGF0YSByb3V0ZXMgQkVGT1JFIHRyeWluZyB0byBwYXJzZSBKU09OXG4gICAgLy8gVXBsb2FkIG1hbnVzY3JpcHQgKHdpdGggYWN0dWFsIGZpbGUgc3RvcmFnZSlcbiAgICBpZiAocGF0aCA9PT0gJy9tYW51c2NyaXB0cycpIHtcbiAgICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpO1xuICAgICAgY29uc3QgZmlsZSA9IGZvcm1EYXRhLmdldCgnZmlsZScpO1xuICAgICAgY29uc3QgYm9va0lkID0gZm9ybURhdGEuZ2V0KCdib29rSWQnKTtcbiAgICAgIGNvbnN0IGF1dGhvcklkID0gZm9ybURhdGEuZ2V0KCdhdXRob3JJZCcpO1xuICAgICAgY29uc3Qgbm90ZXMgPSBmb3JtRGF0YS5nZXQoJ25vdGVzJyk7XG5cbiAgICAgIGlmICghZmlsZSB8fCAhYm9va0lkIHx8ICFhdXRob3JJZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ0ZpbGUsIGJvb2sgSUQsIGFuZCBhdXRob3IgSUQgYXJlIHJlcXVpcmVkJyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBmaWxlIHR5cGUgZm9yIFdvcmQgZG9jdW1lbnRzXG4gICAgICBjb25zdCB2YWxpZFR5cGVzID0gW1xuICAgICAgICAnYXBwbGljYXRpb24vbXN3b3JkJywgXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCdcbiAgICAgIF07XG4gICAgICBpZiAoIXZhbGlkVHlwZXMuaW5jbHVkZXMoZmlsZS50eXBlKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ09ubHkgV29yZCBkb2N1bWVudHMgKC5kb2MsIC5kb2N4KSBhcmUgYWxsb3dlZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgZmlsZSBzaXplICgxME1CIG1heClcbiAgICAgIGlmIChmaWxlLnNpemUgPiAxMCAqIDEwMjQgKiAxMDI0KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnRmlsZSBzaXplIGNhbm5vdCBleGNlZWQgMTBNQicgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IGN1cnJlbnQgdmVyc2lvblxuICAgICAgY29uc3QgbGF0ZXN0TWFudXNjcmlwdCA9IGF3YWl0IHByaXNtYS5tYW51c2NyaXB0LmZpbmRGaXJzdCh7XG4gICAgICAgIHdoZXJlOiB7IGJvb2tJZCB9LFxuICAgICAgICBvcmRlckJ5OiB7IHZlcnNpb246ICdkZXNjJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHZlcnNpb24gPSAobGF0ZXN0TWFudXNjcmlwdD8udmVyc2lvbiB8fCAwKSArIDE7XG5cbiAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBmaWxlbmFtZSBhbmQgc3RvcmUgdGhlIGZpbGVcbiAgICAgIGNvbnN0IGZpbGVJZCA9IHV1aWR2NCgpO1xuICAgICAgY29uc3QgZXh0ID0gZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCk7XG4gICAgICBjb25zdCBzYWZlRmlsZU5hbWUgPSBgJHtmaWxlSWR9LiR7ZXh0fWA7XG4gICAgICBjb25zdCBmaWxlVXJsID0gYC91cGxvYWRzL21hbnVzY3JpcHRzLyR7c2FmZUZpbGVOYW1lfWA7XG4gICAgICBcbiAgICAgIC8vIFdyaXRlIGZpbGUgdG8gZGlza1xuICAgICAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuICAgICAgY29uc3QgcGF0aE1vZHVsZSA9IHJlcXVpcmUoJ3BhdGgnKTtcbiAgICAgIGNvbnN0IHVwbG9hZHNEaXIgPSBwYXRoTW9kdWxlLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICd1cGxvYWRzJywgJ21hbnVzY3JpcHRzJyk7XG4gICAgICBcbiAgICAgIC8vIEVuc3VyZSBkaXJlY3RvcnkgZXhpc3RzXG4gICAgICBpZiAoIWZzLmV4aXN0c1N5bmModXBsb2Fkc0RpcikpIHtcbiAgICAgICAgZnMubWtkaXJTeW5jKHVwbG9hZHNEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBXcml0ZSB0aGUgZmlsZVxuICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpKTtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMocGF0aE1vZHVsZS5qb2luKHVwbG9hZHNEaXIsIHNhZmVGaWxlTmFtZSksIGJ1ZmZlcik7XG5cbiAgICAgIGNvbnN0IG1hbnVzY3JpcHQgPSBhd2FpdCBwcmlzbWEubWFudXNjcmlwdC5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgYm9va0lkLFxuICAgICAgICAgIGF1dGhvcklkLFxuICAgICAgICAgIGZpbGVOYW1lOiBmaWxlLm5hbWUsXG4gICAgICAgICAgZmlsZVVybCxcbiAgICAgICAgICBmaWxlU2l6ZTogZmlsZS5zaXplLFxuICAgICAgICAgIGZpbGVUeXBlOiBmaWxlLnR5cGUsXG4gICAgICAgICAgdmVyc2lvbixcbiAgICAgICAgICBzdGF0dXM6ICdVUExPQURFRCcsXG4gICAgICAgICAgbm90ZXMsXG4gICAgICAgICAgaXNXb3JkVXBsb2FkOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBib29rIHN0YXR1cyBpZiBmaXJzdCBtYW51c2NyaXB0XG4gICAgICBpZiAodmVyc2lvbiA9PT0gMSkge1xuICAgICAgICBhd2FpdCBwcmlzbWEuYm9vay51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBib29rSWQgfSxcbiAgICAgICAgICBkYXRhOiB7IHN0YXR1czogJ0lOX1BST0dSRVNTJyB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWFudXNjcmlwdCB9KTtcbiAgICB9XG5cbiAgICAvLyBQYXJzZSBib2R5IG9uY2UgZm9yIHJvdXRlcyB0aGF0IG5lZWQgaXRcbiAgICBsZXQgYm9keSA9IHt9O1xuICAgIHRyeSB7XG4gICAgICBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gQm9keSBtaWdodCBiZSBmb3JtIGRhdGEgb3IgZW1wdHksIHdoaWNoIGlzIGZpbmVcbiAgICB9XG5cbiAgICAvLyBVc2VyIHJlZ2lzdHJhdGlvblxuICAgIGlmIChwYXRoID09PSAnL2F1dGgvcmVnaXN0ZXInKSB7XG4gICAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCwgbmFtZSwgcGhvbmUgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkIHx8ICFuYW1lKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnRW1haWwsIHBhc3N3b3JkLCBhbmQgbmFtZSBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzXG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgZW1haWwgfSB9KTtcbiAgICAgIGlmIChleGlzdGluZ1VzZXIpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6ICdVc2VyIHdpdGggdGhpcyBlbWFpbCBhbHJlYWR5IGV4aXN0cycgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gSGFzaCBwYXNzd29yZFxuICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTIpO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBwdWJsaWMgVVJMIGZyb20gbmFtZVxuICAgICAgY29uc3QgYmFzZVVybCA9IG5hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0vZywgJy0nKS5yZXBsYWNlKC8tKy9nLCAnLScpO1xuICAgICAgbGV0IHB1YmxpY1VybCA9IGJhc2VVcmw7XG4gICAgICBsZXQgY291bnRlciA9IDE7XG4gICAgICB3aGlsZSAoYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IHB1YmxpY1VybCB9IH0pKSB7XG4gICAgICAgIHB1YmxpY1VybCA9IGAke2Jhc2VVcmx9LSR7Y291bnRlcn1gO1xuICAgICAgICBjb3VudGVyKys7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSB1c2VyXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXNzd29yZCxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIHBob25lLFxuICAgICAgICAgIHJvbGU6ICdBVVRIT1InLFxuICAgICAgICAgIHB1YmxpY1VybCxcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICByb2xlOiB0cnVlLFxuICAgICAgICAgIHB1YmxpY1VybDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB1c2VyLCBtZXNzYWdlOiAnUmVnaXN0cmF0aW9uIHN1Y2Nlc3NmdWwnIH0pO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBib29rXG4gICAgaWYgKHBhdGggPT09ICcvYm9va3MnKSB7XG4gICAgICBjb25zdCB7IHRpdGxlLCBzdWJ0aXRsZSwgYXV0aG9ySWQsIGRlc2NyaXB0aW9uLCBjYXRlZ29yeSwgZ2VucmUgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghdGl0bGUgfHwgIWF1dGhvcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnVGl0bGUgYW5kIGF1dGhvciBJRCBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBib29rIHdpdGggcHVibGlzaGluZyBzdGFnZXNcbiAgICAgIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgc3VidGl0bGUsXG4gICAgICAgICAgYXV0aG9ySWQsXG4gICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgY2F0ZWdvcnksXG4gICAgICAgICAgZ2VucmUsXG4gICAgICAgICAgc3RhdHVzOiAnRFJBRlQnLFxuICAgICAgICAgIHB1Ymxpc2hpbmdTdGFnZXM6IHtcbiAgICAgICAgICAgIGNyZWF0ZTogUFVCTElTSElOR19TVEFHRVMubWFwKChzdGFnZSkgPT4gKHtcbiAgICAgICAgICAgICAgc3RhZ2VUeXBlOiBzdGFnZS50eXBlLFxuICAgICAgICAgICAgICBzdGFnZU9yZGVyOiBzdGFnZS5vcmRlcixcbiAgICAgICAgICAgICAgc3RhdHVzOiBzdGFnZS5vcmRlciA9PT0gMSA/ICdJTl9QUk9HUkVTUycgOiAnUEVORElORycsXG4gICAgICAgICAgICB9KSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHB1Ymxpc2hpbmdTdGFnZXM6IHsgb3JkZXJCeTogeyBzdGFnZU9yZGVyOiAnYXNjJyB9IH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbiBmb3IgYXV0aG9yXG4gICAgICBhd2FpdCBwcmlzbWEubm90aWZpY2F0aW9uLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB1c2VySWQ6IGF1dGhvcklkLFxuICAgICAgICAgIHR5cGU6ICdTWVNURU0nLFxuICAgICAgICAgIHRpdGxlOiAnQm9vayBDcmVhdGVkJyxcbiAgICAgICAgICBtZXNzYWdlOiBgWW91ciBib29rIFwiJHt0aXRsZX1cIiBoYXMgYmVlbiBjcmVhdGVkLiBTdGFydCBieSB1cGxvYWRpbmcgeW91ciBtYW51c2NyaXB0LmAsXG4gICAgICAgICAgbGluazogYC9hdXRob3IvYm9va3MvJHtib29rLmlkfWAsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYm9vayB9KTtcbiAgICB9XG5cbiAgICAvLyBBcHByb3ZlIHN0YWdlXG4gICAgaWYgKHBhdGggPT09ICcvc3RhZ2VzL2FwcHJvdmUnKSB7XG4gICAgICBcbiAgICAgIGNvbnN0IHsgc3RhZ2VJZCwgYXV0aG9yTm90ZXMgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IHN0YWdlID0gYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdTdGFnZS51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogc3RhZ2VJZCB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3RhdHVzOiAnQVBQUk9WRUQnLFxuICAgICAgICAgIGF1dGhvck5vdGVzLFxuICAgICAgICAgIGNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vdmUgdG8gbmV4dCBzdGFnZVxuICAgICAgY29uc3QgbmV4dFN0YWdlID0gYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdTdGFnZS5maW5kRmlyc3Qoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIGJvb2tJZDogc3RhZ2UuYm9va0lkLFxuICAgICAgICAgIHN0YWdlT3JkZXI6IHN0YWdlLnN0YWdlT3JkZXIgKyAxLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChuZXh0U3RhZ2UpIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdTdGFnZS51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBuZXh0U3RhZ2UuaWQgfSxcbiAgICAgICAgICBkYXRhOiB7IHN0YXR1czogJ0lOX1BST0dSRVNTJywgc3RhcnRlZEF0OiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdGFnZSwgbWVzc2FnZTogJ1N0YWdlIGFwcHJvdmVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyBSYWlzZSBxdWVyeVxuICAgIGlmIChwYXRoID09PSAnL3F1ZXJpZXMnKSB7XG4gICAgICBcbiAgICAgIGNvbnN0IHsgYXV0aG9ySWQsIGJvb2tJZCwgc3RhZ2VJZCwgdHlwZSwgc3ViamVjdCwgZGVzY3JpcHRpb24sIHByaW9yaXR5IH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWF1dGhvcklkIHx8ICFzdWJqZWN0IHx8ICFkZXNjcmlwdGlvbikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ0F1dGhvciBJRCwgc3ViamVjdCwgYW5kIGRlc2NyaXB0aW9uIGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcXVlcnkgPSBhd2FpdCBwcmlzbWEucXVlcnkuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGF1dGhvcklkLFxuICAgICAgICAgIGJvb2tJZCxcbiAgICAgICAgICBzdGFnZUlkLFxuICAgICAgICAgIHR5cGU6IHR5cGUgfHwgJ0dFTkVSQUwnLFxuICAgICAgICAgIHByaW9yaXR5OiBwcmlvcml0eSB8fCAnTUVESVVNJyxcbiAgICAgICAgICBzdWJqZWN0LFxuICAgICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICAgIHN0YXR1czogJ09QRU4nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBzdGFnZSBzdGF0dXMgaWYgc3RhZ2Utc3BlY2lmaWMgcXVlcnlcbiAgICAgIGlmIChzdGFnZUlkKSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nU3RhZ2UudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogc3RhZ2VJZCB9LFxuICAgICAgICAgIGRhdGE6IHsgc3RhdHVzOiAnUVVFUllfUkFJU0VEJyB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcXVlcnkgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHF1ZXJ5IGNvbW1lbnRcbiAgICBpZiAocGF0aCA9PT0gJy9xdWVyaWVzL2NvbW1lbnQnKSB7XG4gICAgICBcbiAgICAgIGNvbnN0IHsgcXVlcnlJZCwgdXNlcklkLCB1c2VyTmFtZSwgdXNlclJvbGUsIGNvbW1lbnQsIGlzSW50ZXJuYWwgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IHF1ZXJ5Q29tbWVudCA9IGF3YWl0IHByaXNtYS5xdWVyeUNvbW1lbnQuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHF1ZXJ5SWQsXG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHVzZXJOYW1lLFxuICAgICAgICAgIHVzZXJSb2xlLFxuICAgICAgICAgIGNvbW1lbnQsXG4gICAgICAgICAgaXNJbnRlcm5hbDogaXNJbnRlcm5hbCB8fCBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBVcGRhdGUgcXVlcnkgc3RhdHVzXG4gICAgICBhd2FpdCBwcmlzbWEucXVlcnkudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHF1ZXJ5SWQgfSxcbiAgICAgICAgZGF0YTogeyBzdGF0dXM6ICdJTl9QUk9HUkVTUycgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBjb21tZW50OiBxdWVyeUNvbW1lbnQgfSk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIG9yZGVyXG4gICAgaWYgKHBhdGggPT09ICcvb3JkZXJzJykge1xuICAgICAgXG4gICAgICBjb25zdCB7XG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgaXRlbXMsXG4gICAgICAgIHNoaXBwaW5nTmFtZSxcbiAgICAgICAgc2hpcHBpbmdFbWFpbCxcbiAgICAgICAgc2hpcHBpbmdQaG9uZSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzLFxuICAgICAgICBzaGlwcGluZ0NpdHksXG4gICAgICAgIHNoaXBwaW5nU3RhdGUsXG4gICAgICAgIHNoaXBwaW5nWmlwQ29kZSxcbiAgICAgICAgc2hpcHBpbmdDb3VudHJ5LFxuICAgICAgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghdXNlcklkIHx8ICFpdGVtcyB8fCBpdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6ICdVc2VyIElEIGFuZCBpdGVtcyBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIENhbGN1bGF0ZSB0b3RhbFxuICAgICAgbGV0IHRvdGFsQW1vdW50ID0gMDtcbiAgICAgIGNvbnN0IG9yZGVySXRlbXMgPSBbXTtcblxuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICAgIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IGl0ZW0uYm9va0lkIH0gfSk7XG4gICAgICAgIGlmICghYm9vaykge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgIHsgZXJyb3I6IGBCb29rICR7aXRlbS5ib29rSWR9IG5vdCBmb3VuZGAgfSxcbiAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1bml0UHJpY2UgPSBpdGVtLmlzQXV0aG9yQ29weSAmJiBib29rLmF1dGhvckNvcHlQcmljZVxuICAgICAgICAgID8gYm9vay5hdXRob3JDb3B5UHJpY2VcbiAgICAgICAgICA6IGJvb2suZGlzY291bnRQcmljZSB8fCBib29rLnByaWNlO1xuICAgICAgICBjb25zdCBpdGVtVG90YWwgPSB1bml0UHJpY2UgKiBpdGVtLnF1YW50aXR5O1xuICAgICAgICB0b3RhbEFtb3VudCArPSBpdGVtVG90YWw7XG5cbiAgICAgICAgb3JkZXJJdGVtcy5wdXNoKHtcbiAgICAgICAgICBib29rSWQ6IGl0ZW0uYm9va0lkLFxuICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgIHVuaXRQcmljZSxcbiAgICAgICAgICB0b3RhbFByaWNlOiBpdGVtVG90YWwsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgb3JkZXJcbiAgICAgIGNvbnN0IG9yZGVyID0gYXdhaXQgcHJpc21hLm9yZGVyLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgb3JkZXJOdW1iZXI6IGdlbmVyYXRlT3JkZXJOdW1iZXIoKSxcbiAgICAgICAgICB0b3RhbEFtb3VudCxcbiAgICAgICAgICBzdGF0dXM6ICdQRU5ESU5HJyxcbiAgICAgICAgICBzaGlwcGluZ05hbWUsXG4gICAgICAgICAgc2hpcHBpbmdFbWFpbCxcbiAgICAgICAgICBzaGlwcGluZ1Bob25lLFxuICAgICAgICAgIHNoaXBwaW5nQWRkcmVzcyxcbiAgICAgICAgICBzaGlwcGluZ0NpdHksXG4gICAgICAgICAgc2hpcHBpbmdTdGF0ZSxcbiAgICAgICAgICBzaGlwcGluZ1ppcENvZGUsXG4gICAgICAgICAgc2hpcHBpbmdDb3VudHJ5OiBzaGlwcGluZ0NvdW50cnkgfHwgJ0luZGlhJyxcbiAgICAgICAgICBpdGVtczogeyBjcmVhdGU6IG9yZGVySXRlbXMgfSxcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZTogeyBpdGVtczogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSBSYXpvcnBheSBvcmRlciBpZiBjb25maWd1cmVkXG4gICAgICBpZiAoaXNSYXpvcnBheUNvbmZpZ3VyZWQoKSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJhem9ycGF5T3JkZXIgPSBhd2FpdCBjcmVhdGVPcmRlcihcbiAgICAgICAgICAgIHRvdGFsQW1vdW50LFxuICAgICAgICAgICAgJ0lOUicsXG4gICAgICAgICAgICBvcmRlci5vcmRlck51bWJlcixcbiAgICAgICAgICAgIHsgb3JkZXJJZDogb3JkZXIuaWQsIHVzZXJJZCB9XG4gICAgICAgICAgKTtcblxuICAgICAgICAgIGF3YWl0IHByaXNtYS5vcmRlci51cGRhdGUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IG9yZGVyLmlkIH0sXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIHJhem9ycGF5T3JkZXJJZDogcmF6b3JwYXlPcmRlci5pZCxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnUEFZTUVOVF9QRU5ESU5HJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgb3JkZXIsXG4gICAgICAgICAgICByYXpvcnBheU9yZGVySWQ6IHJhem9ycGF5T3JkZXIuaWQsXG4gICAgICAgICAgICByYXpvcnBheUtleUlkOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19SQVpPUlBBWV9LRVlfSUQsXG4gICAgICAgICAgICBhbW91bnQ6IHRvdGFsQW1vdW50LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Jhem9ycGF5IG9yZGVyIGNyZWF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgb3JkZXIsXG4gICAgICAgIHBheW1lbnREaXNhYmxlZDogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ09yZGVyIGNyZWF0ZWQgYnV0IHBheW1lbnQgZ2F0ZXdheSBub3QgY29uZmlndXJlZCcsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZnkgcGF5bWVudFxuICAgIGlmIChwYXRoID09PSAnL3BheW1lbnQvdmVyaWZ5Jykge1xuICAgICAgXG4gICAgICBjb25zdCB7IHJhem9ycGF5X29yZGVyX2lkLCByYXpvcnBheV9wYXltZW50X2lkLCByYXpvcnBheV9zaWduYXR1cmUsIG9yZGVySWQgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghaXNSYXpvcnBheUNvbmZpZ3VyZWQoKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ1BheW1lbnQgZ2F0ZXdheSBub3QgY29uZmlndXJlZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmVyaWZ5IHNpZ25hdHVyZVxuICAgICAgY29uc3QgaXNWYWxpZCA9IHZlcmlmeVBheW1lbnRTaWduYXR1cmUoXG4gICAgICAgIHJhem9ycGF5X29yZGVyX2lkLFxuICAgICAgICByYXpvcnBheV9wYXltZW50X2lkLFxuICAgICAgICByYXpvcnBheV9zaWduYXR1cmVcbiAgICAgICk7XG5cbiAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgcGF5bWVudCBzaWduYXR1cmUnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSBvcmRlclxuICAgICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBwcmlzbWEub3JkZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgcmF6b3JwYXlPcmRlcklkOiByYXpvcnBheV9vcmRlcl9pZCB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3RhdHVzOiAnUEFJRCcsXG4gICAgICAgICAgcmF6b3JwYXlQYXltZW50SWQ6IHJhem9ycGF5X3BheW1lbnRfaWQsXG4gICAgICAgICAgcmF6b3JwYXlTaWduYXR1cmU6IHJhem9ycGF5X3NpZ25hdHVyZSxcbiAgICAgICAgICBwYWlkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgaXRlbXM6IHsgaW5jbHVkZTogeyBib29rOiB0cnVlIH0gfSwgdXNlcjogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSByb3lhbHR5IHJlY29yZHMgZm9yIGVhY2ggaXRlbVxuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIG9yZGVyLml0ZW1zKSB7XG4gICAgICAgIGNvbnN0IHJveWFsdHlSYXRlID0gMC4xMDsgLy8gMTAlXG4gICAgICAgIGNvbnN0IHJveWFsdHlBbW91bnQgPSBpdGVtLnRvdGFsUHJpY2UgKiByb3lhbHR5UmF0ZTtcblxuICAgICAgICBhd2FpdCBwcmlzbWEucm95YWx0eS5jcmVhdGUoe1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGF1dGhvcklkOiBpdGVtLmJvb2suYXV0aG9ySWQsXG4gICAgICAgICAgICBib29rSWQ6IGl0ZW0uYm9va0lkLFxuICAgICAgICAgICAgb3JkZXJJZDogb3JkZXIuaWQsXG4gICAgICAgICAgICBhbW91bnQ6IHJveWFsdHlBbW91bnQsXG4gICAgICAgICAgICByb3lhbHR5UmF0ZSxcbiAgICAgICAgICAgIHNhbGVBbW91bnQ6IGl0ZW0udG90YWxQcmljZSxcbiAgICAgICAgICAgIHBlcmlvZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCA3KSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgb3JkZXIgfSk7XG4gICAgfVxuXG4gICAgLy8gQ1JNOiBDcmVhdGUgbGVhZFxuICAgIGlmIChwYXRoID09PSAnL2xlYWRzJykge1xuICAgICAgXG4gICAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwaG9uZSwgc291cmNlLCBpbnRlcmVzdEFyZWEsIG5vdGVzLCBjcmVhdGVkQnlJZCB9ID0gYm9keTtcblxuICAgICAgaWYgKCFuYW1lIHx8ICFlbWFpbCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ05hbWUgYW5kIGVtYWlsIGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbGVhZCA9IGF3YWl0IHByaXNtYS5sZWFkLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgIHBob25lLFxuICAgICAgICAgIHNvdXJjZTogc291cmNlIHx8ICdXRUJTSVRFJyxcbiAgICAgICAgICBpbnRlcmVzdEFyZWEsXG4gICAgICAgICAgbm90ZXMsXG4gICAgICAgICAgY3JlYXRlZEJ5SWQsXG4gICAgICAgICAgc3RhdHVzOiAnTkVXJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBsZWFkIH0pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBwcm9maWxlXG4gICAgaWYgKHBhdGggPT09ICcvcHJvZmlsZScpIHtcbiAgICAgIFxuICAgICAgY29uc3QgeyB1c2VySWQsIG5hbWUsIHBob25lLCBiaW8sIHdlYnNpdGUsIHNvY2lhbExpbmtzLCBwdWJsaWNVcmwgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVXNlciBJRCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgcHVibGljIFVSTCB1bmlxdWVuZXNzXG4gICAgICBpZiAocHVibGljVXJsKSB7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZEZpcnN0KHtcbiAgICAgICAgICB3aGVyZTogeyBwdWJsaWNVcmwsIGlkOiB7IG5vdDogdXNlcklkIH0gfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChleGlzdGluZykge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgIHsgZXJyb3I6ICdUaGlzIHByb2ZpbGUgVVJMIGlzIGFscmVhZHkgdGFrZW4nIH0sXG4gICAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogdXNlcklkIH0sXG4gICAgICAgIGRhdGE6IHsgbmFtZSwgcGhvbmUsIGJpbywgd2Vic2l0ZSwgc29jaWFsTGlua3MsIHB1YmxpY1VybCB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIHBob25lOiB0cnVlLFxuICAgICAgICAgIGJpbzogdHJ1ZSxcbiAgICAgICAgICB3ZWJzaXRlOiB0cnVlLFxuICAgICAgICAgIHNvY2lhbExpbmtzOiB0cnVlLFxuICAgICAgICAgIHB1YmxpY1VybDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB1c2VyIH0pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBiYW5rIGRldGFpbHNcbiAgICBpZiAocGF0aCA9PT0gJy9iYW5rLWRldGFpbHMnKSB7XG4gICAgICBcbiAgICAgIGNvbnN0IHsgdXNlcklkLCBhY2NvdW50TmFtZSwgYWNjb3VudE51bWJlciwgYmFua05hbWUsIGlmc2NDb2RlLCBicmFuY2hOYW1lIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIXVzZXJJZCB8fCAhYWNjb3VudE5hbWUgfHwgIWFjY291bnROdW1iZXIgfHwgIWJhbmtOYW1lIHx8ICFpZnNjQ29kZSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ0FsbCBiYW5rIGRldGFpbHMgYXJlIHJlcXVpcmVkJyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBiYW5rRGV0YWlscyA9IGF3YWl0IHByaXNtYS5iYW5rRGV0YWlscy51cHNlcnQoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgICAgY3JlYXRlOiB7IHVzZXJJZCwgYWNjb3VudE5hbWUsIGFjY291bnROdW1iZXIsIGJhbmtOYW1lLCBpZnNjQ29kZSwgYnJhbmNoTmFtZSB9LFxuICAgICAgICB1cGRhdGU6IHsgYWNjb3VudE5hbWUsIGFjY291bnROdW1iZXIsIGJhbmtOYW1lLCBpZnNjQ29kZSwgYnJhbmNoTmFtZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGJhbmtEZXRhaWxzIH0pO1xuICAgIH1cblxuICAgIC8vIE1hcmsgbm90aWZpY2F0aW9ucyBhcyByZWFkXG4gICAgaWYgKHBhdGggPT09ICcvbm90aWZpY2F0aW9ucy9yZWFkJykge1xuICAgICAgXG4gICAgICBjb25zdCB7IG5vdGlmaWNhdGlvbklkcywgdXNlcklkIH0gPSBib2R5O1xuXG4gICAgICBpZiAobm90aWZpY2F0aW9uSWRzICYmIG5vdGlmaWNhdGlvbklkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5ub3RpZmljYXRpb24udXBkYXRlTWFueSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IHsgaW46IG5vdGlmaWNhdGlvbklkcyB9IH0sXG4gICAgICAgICAgZGF0YTogeyBpc1JlYWQ6IHRydWUsIHJlYWRBdDogbmV3IERhdGUoKSB9LFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAodXNlcklkKSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5ub3RpZmljYXRpb24udXBkYXRlTWFueSh7XG4gICAgICAgICAgd2hlcmU6IHsgdXNlcklkLCBpc1JlYWQ6IGZhbHNlIH0sXG4gICAgICAgICAgZGF0YTogeyBpc1JlYWQ6IHRydWUsIHJlYWRBdDogbmV3IERhdGUoKSB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vbm90aWZpY2F0aW9ucyAtIFNlbmQgbm90aWZpY2F0aW9uIHRvIGF1dGhvcnNcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9ub3RpZmljYXRpb25zJykge1xuICAgICAgY29uc3QgeyB0YXJnZXRVc2VySWRzLCB0YXJnZXRBbGwsIHR5cGUsIHRpdGxlLCBtZXNzYWdlLCBsaW5rLCBjdGFUZXh0IH0gPSBib2R5O1xuXG4gICAgICBpZiAoIXRpdGxlIHx8ICFtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAndGl0bGUgYW5kIG1lc3NhZ2UgYXJlIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlcklkcyA9IFtdO1xuXG4gICAgICBpZiAodGFyZ2V0QWxsKSB7XG4gICAgICAgIC8vIFNlbmQgdG8gYWxsIGF1dGhvcnNcbiAgICAgICAgY29uc3QgYXV0aG9ycyA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRNYW55KHtcbiAgICAgICAgICB3aGVyZTogeyByb2xlOiAnQVVUSE9SJywgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHVzZXJJZHMgPSBhdXRob3JzLm1hcChhID0+IGEuaWQpO1xuICAgICAgfSBlbHNlIGlmICh0YXJnZXRVc2VySWRzICYmIEFycmF5LmlzQXJyYXkodGFyZ2V0VXNlcklkcykpIHtcbiAgICAgICAgdXNlcklkcyA9IHRhcmdldFVzZXJJZHM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ3RhcmdldFVzZXJJZHMgb3IgdGFyZ2V0QWxsIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgbm90aWZpY2F0aW9uc1xuICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IFtdO1xuICAgICAgZm9yIChjb25zdCB1c2VySWQgb2YgdXNlcklkcykge1xuICAgICAgICBjb25zdCBub3RpZmljYXRpb24gPSBhd2FpdCBwcmlzbWEubm90aWZpY2F0aW9uLmNyZWF0ZSh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgdHlwZTogdHlwZSB8fCAnR0VORVJBTCcsXG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGN0YVRleHQgPyBgJHttZXNzYWdlfVxcblxcbiR7Y3RhVGV4dH1gIDogbWVzc2FnZSxcbiAgICAgICAgICAgIGxpbmssXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIG5vdGlmaWNhdGlvbnMucHVzaChub3RpZmljYXRpb24pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBjb3VudDogbm90aWZpY2F0aW9ucy5sZW5ndGggfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT0gTkVXIFBPU1QgUk9VVEVTID09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBQT1NUIC9hcGkvc2V0dGluZ3NcbiAgICBpZiAocGF0aCA9PT0gJy9zZXR0aW5ncycpIHtcbiAgICAgIGNvbnN0IHsga2V5LCB2YWx1ZSwgc2V0dGluZ3MgfSA9IGJvZHk7XG5cbiAgICAgIGlmIChzZXR0aW5ncykge1xuICAgICAgICBjb25zdCByZXN1bHRzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKHNldHRpbmdzKSkge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNldFNldHRpbmcoaywgdik7XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgY291bnQ6IHJlc3VsdHMubGVuZ3RoIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNldFNldHRpbmcoa2V5LCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIHNldHRpbmc6IHJlc3VsdCB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdLZXkgb3Igc2V0dGluZ3MgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvYXBpL2Vucm9sbG1lbnRzXG4gICAgaWYgKHBhdGggPT09ICcvZW5yb2xsbWVudHMnKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHNlcnZpY2VUeXBlLFxuICAgICAgICBuYW1lLFxuICAgICAgICBlbWFpbCxcbiAgICAgICAgcGhvbmUsXG4gICAgICAgIGFtb3VudCxcbiAgICAgICAgYWRkT25zLFxuICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBkaXNjb3VudENvZGUsXG4gICAgICB9ID0gYm9keTtcblxuICAgICAgaWYgKCFzZXJ2aWNlVHlwZSB8fCAhbmFtZSB8fCAhZW1haWwgfHwgIXBob25lKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnU2VydmljZSB0eXBlLCBuYW1lLCBlbWFpbCwgYW5kIHBob25lIGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHRvdGFsQW1vdW50ID0gYW1vdW50IHx8IDA7XG4gICAgICBsZXQgYWRkT25EZXRhaWxzID0gW107XG5cbiAgICAgIGlmIChhZGRPbnMgJiYgT2JqZWN0LmtleXMoYWRkT25zKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgW2FkZE9uSWQsIHF1YW50aXR5XSBvZiBPYmplY3QuZW50cmllcyhhZGRPbnMpKSB7XG4gICAgICAgICAgY29uc3QgYWRkT24gPSBhd2FpdCBwcmlzbWEuc2VydmljZUFkZE9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFkZE9uSWQgfSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoYWRkT24pIHtcbiAgICAgICAgICAgIGNvbnN0IGFkZE9uVG90YWwgPSBhZGRPbi5iYXNlUHJpY2UgKiAocXVhbnRpdHkgfHwgMSk7XG4gICAgICAgICAgICB0b3RhbEFtb3VudCArPSBhZGRPblRvdGFsO1xuICAgICAgICAgICAgYWRkT25EZXRhaWxzLnB1c2goe1xuICAgICAgICAgICAgICBhZGRPbklkLFxuICAgICAgICAgICAgICBuYW1lOiBhZGRPbi5uYW1lLFxuICAgICAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHkgfHwgMSxcbiAgICAgICAgICAgICAgcHJpY2U6IGFkZE9uLmJhc2VQcmljZSxcbiAgICAgICAgICAgICAgdG90YWw6IGFkZE9uVG90YWwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IGRpc2NvdW50QW1vdW50ID0gMDtcbiAgICAgIGlmIChkaXNjb3VudENvZGUpIHtcbiAgICAgICAgY29uc3QgZGlzY291bnQgPSBhd2FpdCBwcmlzbWEuZGlzY291bnQuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgY29kZTogZGlzY291bnRDb2RlIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZGlzY291bnQgJiYgZGlzY291bnQuaXNBY3RpdmUpIHtcbiAgICAgICAgICBpZiAoZGlzY291bnQuZGlzY291bnRUeXBlID09PSAncGVyY2VudGFnZScpIHtcbiAgICAgICAgICAgIGRpc2NvdW50QW1vdW50ID0gdG90YWxBbW91bnQgKiAoZGlzY291bnQuZGlzY291bnRWYWx1ZSAvIDEwMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRpc2NvdW50QW1vdW50ID0gZGlzY291bnQuZGlzY291bnRWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdG90YWxBbW91bnQgLT0gZGlzY291bnRBbW91bnQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgZW5yb2xsbWVudCA9IGF3YWl0IHByaXNtYS5zZXJ2aWNlRW5yb2xsbWVudC5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHNlcnZpY2VUeXBlLFxuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgZW1haWwsXG4gICAgICAgICAgcGhvbmUsXG4gICAgICAgICAgYW1vdW50OiBib2R5LmFtb3VudCB8fCAwLFxuICAgICAgICAgIGRpc2NvdW50Q29kZSxcbiAgICAgICAgICBkaXNjb3VudEFtb3VudCxcbiAgICAgICAgICBmaW5hbEFtb3VudDogTWF0aC5tYXgoMCwgdG90YWxBbW91bnQpLFxuICAgICAgICAgIGFkZE9uczogYWRkT25EZXRhaWxzLmxlbmd0aCA+IDAgPyBhZGRPbkRldGFpbHMgOiBudWxsLFxuICAgICAgICAgIG1ldGFkYXRhLFxuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHByaXNtYS5sZWFkLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgIHBob25lLFxuICAgICAgICAgIHNvdXJjZTogJ1dFQlNJVEUnLFxuICAgICAgICAgIGludGVyZXN0QXJlYTogc2VydmljZVR5cGUgPT09ICdmcmVlX3B1Ymxpc2hpbmcnID8gJ0ZyZWUgUHVibGlzaGluZycgOiAnV3JpdGluZyBDaGFsbGVuZ2UnLFxuICAgICAgICAgIG5vdGVzOiBgRW5yb2xsbWVudCBJRDogJHtlbnJvbGxtZW50LmlkfWAsXG4gICAgICAgICAgc3RhdHVzOiAnTkVXJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBzeW5jTGVhZFRvU2hlZXRzKHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIHBob25lLFxuICAgICAgICBzb3VyY2U6ICdXRUJTSVRFJyxcbiAgICAgICAgaW50ZXJlc3RBcmVhOiBzZXJ2aWNlVHlwZSxcbiAgICAgICAgc3RhdHVzOiAnTkVXJyxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBlbnJvbGxtZW50LFxuICAgICAgICBwYXltZW50UmVxdWlyZWQ6IHRvdGFsQW1vdW50ID4gMCxcbiAgICAgICAgYW1vdW50OiB0b3RhbEFtb3VudCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hbnRob2xvZ3lcbiAgICBpZiAocGF0aCA9PT0gJy9hbnRob2xvZ3knKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIG5hbWU6IGFudGhOYW1lLFxuICAgICAgICBwaG9uZTogYW50aFBob25lLFxuICAgICAgICBpc1doYXRzQXBwLFxuICAgICAgICB3aGF0c0FwcE51bWJlcixcbiAgICAgICAgZW1haWw6IGFudGhFbWFpbCxcbiAgICAgICAgaW5zdGFncmFtVXNlcm5hbWUsXG4gICAgICAgIHBvZXRyeVRpdGxlLFxuICAgICAgICBwb2V0cnlDb250ZW50LFxuICAgICAgICBiaW8sXG4gICAgICAgIGNvbnRhY3RQcmVmZXJlbmNlLFxuICAgICAgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghYW50aE5hbWUgfHwgIWFudGhQaG9uZSB8fCAhYW50aEVtYWlsIHx8ICFwb2V0cnlUaXRsZSB8fCAhcG9ldHJ5Q29udGVudCB8fCAhY29udGFjdFByZWZlcmVuY2UpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6ICdBbGwgcmVxdWlyZWQgZmllbGRzIG11c3QgYmUgZmlsbGVkJyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzdWJtaXNzaW9uID0gYXdhaXQgcHJpc21hLmFudGhvbG9neVN1Ym1pc3Npb24uY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIG5hbWU6IGFudGhOYW1lLFxuICAgICAgICAgIHBob25lOiBhbnRoUGhvbmUsXG4gICAgICAgICAgaXNXaGF0c0FwcDogaXNXaGF0c0FwcCAhPT0gZmFsc2UsXG4gICAgICAgICAgd2hhdHNBcHBOdW1iZXI6IGlzV2hhdHNBcHAgPT09IGZhbHNlID8gd2hhdHNBcHBOdW1iZXIgOiBudWxsLFxuICAgICAgICAgIGVtYWlsOiBhbnRoRW1haWwsXG4gICAgICAgICAgaW5zdGFncmFtVXNlcm5hbWUsXG4gICAgICAgICAgcG9ldHJ5VGl0bGUsXG4gICAgICAgICAgcG9ldHJ5Q29udGVudCxcbiAgICAgICAgICBiaW8sXG4gICAgICAgICAgY29udGFjdFByZWZlcmVuY2UsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgc3luY0FudGhvbG9neVRvU2hlZXRzKHN1Ym1pc3Npb24pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWJtaXNzaW9uLCBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFNUQUdFIFRFTVBMQVRFUyBQT1NUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUE9TVCAvYXBpL2FkbWluL3N0YWdlLXRlbXBsYXRlcyAtIENyZWF0ZSBuZXcgc3RhZ2UgdGVtcGxhdGVcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9zdGFnZS10ZW1wbGF0ZXMnKSB7XG4gICAgICBjb25zdCB7IHN0YWdlVHlwZSwgbmFtZSwgZGVzY3JpcHRpb24sIGlzRGVmYXVsdCwgc29ydE9yZGVyIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIXN0YWdlVHlwZSB8fCAhbmFtZSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ3N0YWdlVHlwZSBhbmQgbmFtZSBhcmUgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHN0YWdlVHlwZSBhbHJlYWR5IGV4aXN0c1xuICAgICAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBwcmlzbWEuc3RhZ2VUZW1wbGF0ZS5maW5kVW5pcXVlKHsgd2hlcmU6IHsgc3RhZ2VUeXBlIH0gfSk7XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdTdGFnZSB0eXBlIGFscmVhZHkgZXhpc3RzJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHByaXNtYS5zdGFnZVRlbXBsYXRlLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdGFnZVR5cGUsXG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICBpc0RlZmF1bHQ6IGlzRGVmYXVsdCB8fCBmYWxzZSxcbiAgICAgICAgICBzb3J0T3JkZXI6IHNvcnRPcmRlciB8fCA5OSxcbiAgICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0ZW1wbGF0ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vYm9va3MvW2Jvb2tJZF0vc3RhZ2VzIC0gQWRkIGEgc3RhZ2UgdG8gYSBib29rXG4gICAgaWYgKHBhdGgubWF0Y2goL1xcL2FkbWluXFwvYm9va3NcXC9bXi9dK1xcL3N0YWdlcyQvKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSA0KSB7XG4gICAgICBjb25zdCBib29rSWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCB7IHN0YWdlVHlwZSwgc3RhZ2VPcmRlciB9ID0gYm9keTtcblxuICAgICAgaWYgKCFzdGFnZVR5cGUpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdzdGFnZVR5cGUgaXMgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHN0YWdlIGFscmVhZHkgZXhpc3RzIGZvciB0aGlzIGJvb2tcbiAgICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdTdGFnZS5maW5kRmlyc3Qoe1xuICAgICAgICB3aGVyZTogeyBib29rSWQsIHN0YWdlVHlwZSB9LFxuICAgICAgfSk7XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdTdGFnZSBhbHJlYWR5IGV4aXN0cyBmb3IgdGhpcyBib29rJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgbWF4IG9yZGVyIGlmIG5vdCBwcm92aWRlZFxuICAgICAgbGV0IG9yZGVyID0gc3RhZ2VPcmRlcjtcbiAgICAgIGlmICghb3JkZXIpIHtcbiAgICAgICAgY29uc3QgbWF4U3RhZ2UgPSBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1N0YWdlLmZpbmRGaXJzdCh7XG4gICAgICAgICAgd2hlcmU6IHsgYm9va0lkIH0sXG4gICAgICAgICAgb3JkZXJCeTogeyBzdGFnZU9yZGVyOiAnZGVzYycgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIG9yZGVyID0gKG1heFN0YWdlPy5zdGFnZU9yZGVyIHx8IDApICsgMTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3RhZ2UgPSBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1N0YWdlLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBib29rSWQsXG4gICAgICAgICAgc3RhZ2VUeXBlLFxuICAgICAgICAgIHN0YWdlT3JkZXI6IG9yZGVyLFxuICAgICAgICAgIHN0YXR1czogJ1BFTkRJTkcnLFxuICAgICAgICAgIGlzVmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdGFnZSB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vYm9va3MvW2Jvb2tJZF0vc3RhZ2VzL3RvZ2dsZSAtIEVuYWJsZS9kaXNhYmxlIHN0YWdlcyBmb3IgYSBib29rXG4gICAgaWYgKHBhdGgubWF0Y2goL1xcL2FkbWluXFwvYm9va3NcXC9bXi9dK1xcL3N0YWdlc1xcL3RvZ2dsZSQvKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSA0KSB7XG4gICAgICBjb25zdCBib29rSWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCB7IHN0YWdlSWRzLCB2aXNpYmxlIH0gPSBib2R5OyAvLyBzdGFnZUlkczogYXJyYXkgb2Ygc3RhZ2UgSURzLCB2aXNpYmxlOiBib29sZWFuXG5cbiAgICAgIGlmICghc3RhZ2VJZHMgfHwgIUFycmF5LmlzQXJyYXkoc3RhZ2VJZHMpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnc3RhZ2VJZHMgYXJyYXkgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nU3RhZ2UudXBkYXRlTWFueSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgaWQ6IHsgaW46IHN0YWdlSWRzIH0sXG4gICAgICAgICAgYm9va0lkOiBib29rSWQsXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHsgaXNWaXNpYmxlOiB2aXNpYmxlIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgY291bnQ6IHN0YWdlSWRzLmxlbmd0aCB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vYm9va3MvW2Jvb2tJZF0vc3RhZ2VzL1tzdGFnZUlkXS9hcHByb3ZlIC0gQXV0aG9yIGFwcHJvdmVzIGEgc3RhZ2UgKGxvY2tzIGl0KVxuICAgIGlmIChwYXRoLm1hdGNoKC9cXC9hZG1pblxcL2Jvb2tzXFwvW14vXStcXC9zdGFnZXNcXC9bXi9dK1xcL2FwcHJvdmUkLykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gNSkge1xuICAgICAgY29uc3QgYm9va0lkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3Qgc3RhZ2VJZCA9IHBhdGhTZWdtZW50c1s0XTtcblxuICAgICAgY29uc3Qgc3RhZ2UgPSBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1N0YWdlLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogc3RhZ2VJZCB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghc3RhZ2UgfHwgc3RhZ2UuYm9va0lkICE9PSBib29rSWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdTdGFnZSBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGFnZS5zdGF0dXMgIT09ICdBV0FJVElOR19BUFBST1ZBTCcpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdTdGFnZSBpcyBub3QgYXdhaXRpbmcgYXBwcm92YWwnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWRTdGFnZSA9IGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nU3RhZ2UudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHN0YWdlSWQgfSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHN0YXR1czogJ0FQUFJPVkVEJyxcbiAgICAgICAgICBpc0xvY2tlZDogdHJ1ZSxcbiAgICAgICAgICBjb21wbGV0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdGFnZTogdXBkYXRlZFN0YWdlIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFVTRVJTIFBPU1QgUk9VVEVTID09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vdXNlcnMgLSBDcmVhdGUgdXNlciAobWFudWFsIGFkZClcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi91c2VycycpIHtcbiAgICAgIGNvbnN0IHsgZW1haWwsIG5hbWUsIHBob25lLCByb2xlLCBpc0Jsb2dXcml0ZXIsIGFsdGVybmF0ZUVtYWlsLCBhbHRlcm5hdGVQaG9uZSB9ID0gYm9keTtcblxuICAgICAgaWYgKCFlbWFpbCB8fCAhbmFtZSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0VtYWlsIGFuZCBuYW1lIGFyZSByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdXNlciBleGlzdHNcbiAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSB9IH0pO1xuICAgICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VzZXIgd2l0aCB0aGlzIGVtYWlsIGFscmVhZHkgZXhpc3RzJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBHZW5lcmF0ZSBBdXRob3IgVUlEXG4gICAgICBjb25zdCBhdXRob3JVaWQgPSBhd2FpdCBnZW5lcmF0ZUF1dGhvclVpZCgpO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBwdWJsaWMgVVJMXG4gICAgICBjb25zdCBiYXNlVXJsID0gbmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XS9nLCAnLScpLnJlcGxhY2UoLy0rL2csICctJyk7XG4gICAgICBsZXQgcHVibGljVXJsID0gYmFzZVVybDtcbiAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgIHdoaWxlIChhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgcHVibGljVXJsIH0gfSkpIHtcbiAgICAgICAgcHVibGljVXJsID0gYCR7YmFzZVVybH0tJHtjb3VudGVyfWA7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIHBhc3N3b3JkOiAnJywgLy8gTm8gcGFzc3dvcmQgLSB1c2VyIG5lZWRzIHRvIHNldCB1cFxuICAgICAgICAgIHBob25lLFxuICAgICAgICAgIGFsdGVybmF0ZUVtYWlsLFxuICAgICAgICAgIGFsdGVybmF0ZVBob25lLFxuICAgICAgICAgIHJvbGU6IHJvbGUgfHwgJ0FVVEhPUicsXG4gICAgICAgICAgaXNCbG9nV3JpdGVyOiBpc0Jsb2dXcml0ZXIgfHwgZmFsc2UsXG4gICAgICAgICAgYXV0aG9yVWlkLFxuICAgICAgICAgIHB1YmxpY1VybCxcbiAgICAgICAgICBpbXBvcnRTb3VyY2U6ICdtYW51YWwnLFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlLCBlbWFpbDogdHJ1ZSwgbmFtZTogdHJ1ZSwgcm9sZTogdHJ1ZSwgcGhvbmU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdXNlciB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vdXNlcnMvaW1wb3J0IC0gQ1NWIGltcG9ydCB1c2Vyc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3VzZXJzL2ltcG9ydCcpIHtcbiAgICAgIGNvbnN0IHsgdXNlcnM6IHVzZXJzRGF0YSwgaW1wb3J0ZWRCeUlkIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIXVzZXJzRGF0YSB8fCAhQXJyYXkuaXNBcnJheSh1c2Vyc0RhdGEpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVXNlcnMgYXJyYXkgaXMgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSB7IHN1Y2Nlc3M6IFtdLCBlcnJvcnM6IFtdLCBza2lwcGVkOiBbXSB9O1xuXG4gICAgICBmb3IgKGNvbnN0IHVzZXJEYXRhIG9mIHVzZXJzRGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgZW1haWwsIG5hbWUsIHBob25lLCByb2xlIH0gPSB1c2VyRGF0YTtcbiAgICAgICAgICBpZiAoIWVtYWlsIHx8ICFuYW1lKSB7XG4gICAgICAgICAgICByZXN1bHRzLmVycm9ycy5wdXNoKHsgZW1haWwsIGVycm9yOiAnTWlzc2luZyBlbWFpbCBvciBuYW1lJyB9KTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENoZWNrIGlmIGV4aXN0c1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGVtYWlsOiBlbWFpbC50b0xvd2VyQ2FzZSgpIH0gfSk7XG4gICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICByZXN1bHRzLnNraXBwZWQucHVzaCh7IGVtYWlsLCByZWFzb246ICdBbHJlYWR5IGV4aXN0cycsIGV4aXN0aW5nSWQ6IGV4aXN0aW5nLmlkIH0pO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgYXV0aG9yVWlkID0gYXdhaXQgZ2VuZXJhdGVBdXRob3JVaWQoKTtcbiAgICAgICAgICBjb25zdCBiYXNlVXJsID0gbmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XS9nLCAnLScpLnJlcGxhY2UoLy0rL2csICctJyk7XG4gICAgICAgICAgbGV0IHB1YmxpY1VybCA9IGJhc2VVcmw7XG4gICAgICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgICAgIHdoaWxlIChhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgcHVibGljVXJsIH0gfSkpIHtcbiAgICAgICAgICAgIHB1YmxpY1VybCA9IGAke2Jhc2VVcmx9LSR7Y291bnRlcn1gO1xuICAgICAgICAgICAgY291bnRlcisrO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5jcmVhdGUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICAgICAgICBwaG9uZSxcbiAgICAgICAgICAgICAgcm9sZTogcm9sZSB8fCAnQVVUSE9SJyxcbiAgICAgICAgICAgICAgYXV0aG9yVWlkLFxuICAgICAgICAgICAgICBwdWJsaWNVcmwsXG4gICAgICAgICAgICAgIGltcG9ydFNvdXJjZTogJ2NzdicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmVzdWx0cy5zdWNjZXNzLnB1c2goeyBlbWFpbCwgYXV0aG9yVWlkOiB1c2VyLmF1dGhvclVpZCwgaWQ6IHVzZXIuaWQgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goeyBlbWFpbDogdXNlckRhdGEuZW1haWwsIGVycm9yOiBlcnIubWVzc2FnZSB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgaW1wb3J0IGJhdGNoIHJlY29yZFxuICAgICAgYXdhaXQgcHJpc21hLmltcG9ydEJhdGNoLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0eXBlOiAndXNlcnMnLFxuICAgICAgICAgIHRvdGFsUm93czogdXNlcnNEYXRhLmxlbmd0aCxcbiAgICAgICAgICBzdWNjZXNzQ291bnQ6IHJlc3VsdHMuc3VjY2Vzcy5sZW5ndGgsXG4gICAgICAgICAgZXJyb3JDb3VudDogcmVzdWx0cy5lcnJvcnMubGVuZ3RoLFxuICAgICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgaW1wb3J0ZWRCeUlkOiBpbXBvcnRlZEJ5SWQgfHwgJ3N5c3RlbScsXG4gICAgICAgICAgc3VtbWFyeTogcmVzdWx0cyxcbiAgICAgICAgICBjb21wbGV0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByZXN1bHRzIH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi91c2Vycy9baWRdL2xpbmstYm9va3MgLSBMaW5rIGJvb2tzIHRvIHVzZXJcbiAgICBpZiAocGF0aC5tYXRjaCgvXlxcL2FkbWluXFwvdXNlcnNcXC9bXi9dK1xcL2xpbmstYm9va3MkLykpIHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIGNvbnN0IHsgYm9va0lkcyB9ID0gYm9keTtcblxuICAgICAgaWYgKCFib29rSWRzIHx8ICFBcnJheS5pc0FycmF5KGJvb2tJZHMpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnYm9va0lkcyBhcnJheSByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogdXNlcklkIH0gfSk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGxpbmtBdXRob3JzVG9Cb29rKGJvb2tJZHNbMF0sIFt1c2VySWRdKTsgLy8gRm9yIG5vdywgbGluayBvbmUgYm9vayBhdCBhIHRpbWVcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbGlua2VkOiByZXN1bHRzLmxlbmd0aCB9KTtcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBBVVRIT1IgUE9TVCBST1VURVMgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIFBPU1QgL2FwaS9hdXRob3IvcXVlcmllcyAtIENyZWF0ZSBxdWVyeVxuICAgIGlmIChwYXRoID09PSAnL2F1dGhvci9xdWVyaWVzJykge1xuICAgICAgY29uc3QgdXNlcklkID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWlkJyk7XG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBzdWJqZWN0LCBkZXNjcmlwdGlvbiwgdHlwZSwgYm9va0lkLCBwcmlvcml0eSB9ID0gYm9keTtcblxuICAgICAgaWYgKCFzdWJqZWN0IHx8ICFkZXNjcmlwdGlvbikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1N1YmplY3QgYW5kIGRlc2NyaXB0aW9uIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBxdWVyeSA9IGF3YWl0IHByaXNtYS5xdWVyeS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgYXV0aG9ySWQ6IHVzZXJJZCxcbiAgICAgICAgICBzdWJqZWN0LFxuICAgICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICAgIHR5cGU6IHR5cGUgfHwgJ0dFTkVSQUwnLFxuICAgICAgICAgIGJvb2tJZDogYm9va0lkIHx8IG51bGwsXG4gICAgICAgICAgcHJpb3JpdHk6IHByaW9yaXR5IHx8ICdNRURJVU0nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHF1ZXJ5IH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hdXRob3IvcXVlcmllcy9baWRdL2NvbW1lbnRzIC0gQWRkIGNvbW1lbnQgdG8gcXVlcnlcbiAgICBpZiAocGF0aC5tYXRjaCgvXlxcL2F1dGhvclxcL3F1ZXJpZXNcXC9bXi9dK1xcL2NvbW1lbnRzJC8pKSB7XG4gICAgICBjb25zdCBxdWVyeUlkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3QgdXNlcklkID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWlkJyk7XG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBjb21tZW50IH0gPSBib2R5O1xuICAgICAgaWYgKCFjb21tZW50KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQ29tbWVudCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogdXNlcklkIH0gfSk7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV3Q29tbWVudCA9IGF3YWl0IHByaXNtYS5xdWVyeUNvbW1lbnQuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHF1ZXJ5SWQsXG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHVzZXJOYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgdXNlclJvbGU6IHVzZXIucm9sZSxcbiAgICAgICAgICBjb21tZW50LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBxdWVyeSBzdGF0dXNcbiAgICAgIGF3YWl0IHByaXNtYS5xdWVyeS51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogcXVlcnlJZCB9LFxuICAgICAgICBkYXRhOiB7IHN0YXR1czogJ1dBSVRJTkdfUkVTUE9OU0UnIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgY29tbWVudDogbmV3Q29tbWVudCB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYXV0aG9yL21hbnVzY3JpcHRzIC0gQ3JlYXRlIG9yIHVwZGF0ZSBtYW51c2NyaXB0XG4gICAgaWYgKHBhdGggPT09ICcvYXV0aG9yL21hbnVzY3JpcHRzJykge1xuICAgICAgY29uc3QgdXNlcklkID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWlkJyk7XG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBpZCwgYm9va0lkLCBjb250ZW50LCBmaWxlTmFtZSwgZmlsZVVybCwgaXNXb3JkVXBsb2FkLCBzdGF0dXMgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghYm9va0lkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnYm9va0lkIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiB1cGRhdGluZyBleGlzdGluZyBtYW51c2NyaXB0XG4gICAgICBpZiAoaWQpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IHByaXNtYS5tYW51c2NyaXB0LnVwZGF0ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBjb250ZW50OiBjb250ZW50IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlTmFtZSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBmaWxlVXJsOiBmaWxlVXJsIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGlzV29yZFVwbG9hZDogaXNXb3JkVXBsb2FkIHx8IGZhbHNlLFxuICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMgfHwgJ0RSQUZUJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWFudXNjcmlwdDogdXBkYXRlZCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIG5ldyBtYW51c2NyaXB0XG4gICAgICBjb25zdCBtYW51c2NyaXB0ID0gYXdhaXQgcHJpc21hLm1hbnVzY3JpcHQuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGJvb2tJZCxcbiAgICAgICAgICBhdXRob3JJZDogdXNlcklkLFxuICAgICAgICAgIGZpbGVOYW1lOiBmaWxlTmFtZSB8fCAnbWFudXNjcmlwdCcsXG4gICAgICAgICAgZmlsZVVybDogZmlsZVVybCB8fCAnJyxcbiAgICAgICAgICBjb250ZW50OiBjb250ZW50IHx8IG51bGwsXG4gICAgICAgICAgaXNXb3JkVXBsb2FkOiBpc1dvcmRVcGxvYWQgfHwgZmFsc2UsXG4gICAgICAgICAgc3RhdHVzOiBzdGF0dXMgfHwgJ0RSQUZUJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBtYW51c2NyaXB0IH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi9jb250ZW50IC0gU2F2ZSBzaXRlIGNvbnRlbnRcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9jb250ZW50Jykge1xuICAgICAgY29uc3QgeyBrZXksIGNvbnRlbnQgfSA9IGJvZHk7XG5cbiAgICAgIGlmICgha2V5KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnS2V5IHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS5zaXRlQ29udGVudC5maW5kVW5pcXVlKHsgd2hlcmU6IHsga2V5IH0gfSk7XG5cbiAgICAgIGlmIChleGlzdGluZykge1xuICAgICAgICBhd2FpdCBwcmlzbWEuc2l0ZUNvbnRlbnQudXBkYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBrZXkgfSxcbiAgICAgICAgICBkYXRhOiB7IGNvbnRlbnQgfSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCBwcmlzbWEuc2l0ZUNvbnRlbnQuY3JlYXRlKHtcbiAgICAgICAgICBkYXRhOiB7IGtleSwgY29udGVudCB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vaW1wb3J0cy92YWxpZGF0ZSAtIFZhbGlkYXRlIGltcG9ydCBkYXRhXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vaW1wb3J0cy92YWxpZGF0ZScpIHtcbiAgICAgIGNvbnN0IHsgdHlwZSwgZGF0YSwgbWFwcGluZyB9ID0gYm9keTtcblxuICAgICAgaWYgKCF0eXBlIHx8ICFkYXRhKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVHlwZSBhbmQgZGF0YSByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZXJyb3JzID0gW107XG4gICAgICBjb25zdCB3YXJuaW5ncyA9IFtdO1xuICAgICAgbGV0IHZhbGlkQ291bnQgPSAwO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBiYXNlZCBvbiB0eXBlXG4gICAgICBpZiAodHlwZSA9PT0gJ3VzZXJzJykge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCByb3cgPSBkYXRhW2ldO1xuICAgICAgICAgIGNvbnN0IGVtYWlsID0gcm93W21hcHBpbmdbJ0VtYWlsKiddXTtcbiAgICAgICAgICBjb25zdCBuYW1lID0gcm93W21hcHBpbmdbJ05hbWUqJ11dO1xuXG4gICAgICAgICAgaWYgKCFlbWFpbCkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiAnRW1haWwgaXMgcmVxdWlyZWQnIH0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIS9cXFMrQFxcUytcXC5cXFMrLy50ZXN0KGVtYWlsKSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiBgSW52YWxpZCBlbWFpbDogJHtlbWFpbH1gIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbCB9IH0pO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiBgVXNlciBhbHJlYWR5IGV4aXN0czogJHtlbWFpbH1gIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFsaWRDb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghbmFtZSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiAnTmFtZSBpcyByZXF1aXJlZCcgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdib29rcycpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3Qgcm93ID0gZGF0YVtpXTtcbiAgICAgICAgICBjb25zdCB0aXRsZSA9IHJvd1ttYXBwaW5nWydUaXRsZSonXV07XG4gICAgICAgICAgY29uc3QgYXV0aG9yUmVmID0gcm93W21hcHBpbmdbJ0F1dGhvciBVSUQvRW1haWwqJ11dO1xuXG4gICAgICAgICAgaWYgKCF0aXRsZSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiAnVGl0bGUgaXMgcmVxdWlyZWQnIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWxpZENvdW50Kys7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFhdXRob3JSZWYpIHtcbiAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiAnTm8gYXV0aG9yIHNwZWNpZmllZCcgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzYWxlcycpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3Qgcm93ID0gZGF0YVtpXTtcbiAgICAgICAgICBjb25zdCBpc2JuID0gcm93W21hcHBpbmdbJ0lTQk4qJ11dO1xuICAgICAgICAgIGNvbnN0IHBsYXRmb3JtID0gcm93W21hcHBpbmdbJ1BsYXRmb3JtKiddXTtcbiAgICAgICAgICBjb25zdCBhbW91bnQgPSByb3dbbWFwcGluZ1snQW1vdW50KiddXTtcblxuICAgICAgICAgIGlmICghaXNibikge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiAnSVNCTiBpcyByZXF1aXJlZCcgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghcGxhdGZvcm0pIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgcm93OiBpICsgMiwgbWVzc2FnZTogJ1BsYXRmb3JtIGlzIHJlcXVpcmVkJyB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFhbW91bnQgfHwgaXNOYU4ocGFyc2VGbG9hdChhbW91bnQpKSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyByb3c6IGkgKyAyLCBtZXNzYWdlOiAnVmFsaWQgYW1vdW50IGlzIHJlcXVpcmVkJyB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaXNibiAmJiBwbGF0Zm9ybSAmJiBhbW91bnQgJiYgIWlzTmFOKHBhcnNlRmxvYXQoYW1vdW50KSkpIHtcbiAgICAgICAgICAgIHZhbGlkQ291bnQrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdmFsaWRDb3VudCwgZXJyb3JzLCB3YXJuaW5ncyB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vaW1wb3J0cy9leGVjdXRlIC0gRXhlY3V0ZSBpbXBvcnRcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9pbXBvcnRzL2V4ZWN1dGUnKSB7XG4gICAgICBjb25zdCB7IHR5cGUsIGRhdGEsIG1hcHBpbmcgfSA9IGJvZHk7XG4gICAgICBjb25zdCBpbXBvcnRlZEJ5SWQgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXVzZXItaWQnKSB8fCAnc3lzdGVtJztcblxuICAgICAgaWYgKCF0eXBlIHx8ICFkYXRhKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVHlwZSBhbmQgZGF0YSByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgbGV0IHN1Y2Nlc3NDb3VudCA9IDA7XG4gICAgICBsZXQgZXJyb3JDb3VudCA9IDA7XG4gICAgICBjb25zdCBlcnJvcnMgPSBbXTtcblxuICAgICAgLy8gRXhlY3V0ZSBpbXBvcnQgYmFzZWQgb24gdHlwZVxuICAgICAgaWYgKHR5cGUgPT09ICd1c2VycycpIHtcbiAgICAgICAgZm9yIChjb25zdCByb3cgb2YgZGF0YSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlbWFpbCA9IHJvd1ttYXBwaW5nWydFbWFpbConXV07XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gcm93W21hcHBpbmdbJ05hbWUqJ11dO1xuICAgICAgICAgICAgY29uc3QgcGhvbmUgPSByb3dbbWFwcGluZ1snUGhvbmUnXV07XG4gICAgICAgICAgICBjb25zdCByb2xlID0gcm93W21hcHBpbmdbJ1JvbGUnXV0gfHwgJ0FVVEhPUic7XG5cbiAgICAgICAgICAgIGlmICghZW1haWwgfHwgIW5hbWUpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbCB9IH0pO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICAgIGVycm9yQ291bnQrKztcbiAgICAgICAgICAgICAgZXJyb3JzLnB1c2goeyBlbWFpbCwgbWVzc2FnZTogJ0FscmVhZHkgZXhpc3RzJyB9KTtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIGF1dGhvciBVSURcbiAgICAgICAgICAgIGNvbnN0IHNlcSA9IGF3YWl0IHByaXNtYS5hdXRob3JVaWRTZXF1ZW5jZS51cHNlcnQoe1xuICAgICAgICAgICAgICB3aGVyZTogeyBpZDogJ3NpbmdsZXRvbicgfSxcbiAgICAgICAgICAgICAgdXBkYXRlOiB7IGxhc3RWYWx1ZTogeyBpbmNyZW1lbnQ6IDEgfSB9LFxuICAgICAgICAgICAgICBjcmVhdGU6IHsgaWQ6ICdzaW5nbGV0b24nLCBsYXN0VmFsdWU6IDEgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgYXV0aG9yVWlkID0gYFdQJHtTdHJpbmcoc2VxLmxhc3RWYWx1ZSkucGFkU3RhcnQoNSwgJzAnKX1gO1xuXG4gICAgICAgICAgICBhd2FpdCBwcmlzbWEudXNlci5jcmVhdGUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBwaG9uZSxcbiAgICAgICAgICAgICAgICByb2xlOiByb2xlLnRvVXBwZXJDYXNlKCkgPT09ICdBRE1JTicgPyAnQURNSU4nIDogcm9sZS50b1VwcGVyQ2FzZSgpID09PSAnVEVBTScgPyAnVEVBTScgOiAnQVVUSE9SJyxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogYXdhaXQgYmNyeXB0Lmhhc2goJ3RlbXAxMjMnLCAxMiksXG4gICAgICAgICAgICAgICAgYXV0aG9yVWlkLFxuICAgICAgICAgICAgICAgIGltcG9ydFNvdXJjZTogJ2NzdicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN1Y2Nlc3NDb3VudCsrO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGVycm9yQ291bnQrKztcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgbWVzc2FnZTogZS5tZXNzYWdlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnYm9va3MnKSB7XG4gICAgICAgIGZvciAoY29uc3Qgcm93IG9mIGRhdGEpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdGl0bGUgPSByb3dbbWFwcGluZ1snVGl0bGUqJ11dO1xuICAgICAgICAgICAgY29uc3QgYXV0aG9yUmVmID0gcm93W21hcHBpbmdbJ0F1dGhvciBVSUQvRW1haWwqJ11dO1xuICAgICAgICAgICAgY29uc3QgaXNiblBhcGVyYmFjayA9IHJvd1ttYXBwaW5nWydQYXBlcmJhY2sgSVNCTiddXTtcbiAgICAgICAgICAgIGNvbnN0IGlzYm5IYXJkY292ZXIgPSByb3dbbWFwcGluZ1snSGFyZGNvdmVyIElTQk4nXV07XG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yeSA9IHJvd1ttYXBwaW5nWydDYXRlZ29yeSddXTtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcm93W21hcHBpbmdbJ0Rlc2NyaXB0aW9uJ11dO1xuXG4gICAgICAgICAgICBpZiAoIXRpdGxlKSBjb250aW51ZTtcblxuICAgICAgICAgICAgLy8gRmluZCBhdXRob3JcbiAgICAgICAgICAgIGxldCBhdXRob3IgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGF1dGhvclJlZikge1xuICAgICAgICAgICAgICBhdXRob3IgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgICAgICAgICB7IGVtYWlsOiBhdXRob3JSZWYgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBhdXRob3JVaWQ6IGF1dGhvclJlZiB9LFxuICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFhdXRob3IpIHtcbiAgICAgICAgICAgICAgLy8gQ3JlYXRlIHBsYWNlaG9sZGVyIGF1dGhvciBvciBza2lwXG4gICAgICAgICAgICAgIGVycm9yQ291bnQrKztcbiAgICAgICAgICAgICAgZXJyb3JzLnB1c2goeyB0aXRsZSwgbWVzc2FnZTogJ0F1dGhvciBub3QgZm91bmQnIH0pO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcHJpc21hLmJvb2suY3JlYXRlKHtcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICAgIGF1dGhvcklkOiBhdXRob3IuaWQsXG4gICAgICAgICAgICAgICAgaXNiblBhcGVyYmFjayxcbiAgICAgICAgICAgICAgICBpc2JuSGFyZGNvdmVyLFxuICAgICAgICAgICAgICAgIGNhdGVnb3J5LFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgIHN0YXR1czogJ0RSQUZUJyxcbiAgICAgICAgICAgICAgICBpbXBvcnRTb3VyY2U6ICdjc3YnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzdWNjZXNzQ291bnQrKztcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBlcnJvckNvdW50Kys7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6IGUubWVzc2FnZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3NhbGVzJykge1xuICAgICAgICBjb25zdCBiYXRjaElkID0gYGltcG9ydC0ke0RhdGUubm93KCl9YDtcbiAgICAgICAgZm9yIChjb25zdCByb3cgb2YgZGF0YSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBpc2JuID0gcm93W21hcHBpbmdbJ0lTQk4qJ11dO1xuICAgICAgICAgICAgY29uc3QgcGxhdGZvcm0gPSByb3dbbWFwcGluZ1snUGxhdGZvcm0qJ11dO1xuICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHJvd1ttYXBwaW5nWydEYXRlKiddXTtcbiAgICAgICAgICAgIGNvbnN0IHF1YW50aXR5ID0gcGFyc2VJbnQocm93W21hcHBpbmdbJ1F1YW50aXR5KiddXSB8fCAnMScpO1xuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gcGFyc2VGbG9hdChyb3dbbWFwcGluZ1snQW1vdW50KiddXSk7XG5cbiAgICAgICAgICAgIGlmICghaXNibiB8fCAhcGxhdGZvcm0gfHwgaXNOYU4oYW1vdW50KSkgY29udGludWU7XG5cbiAgICAgICAgICAgIC8vIEZpbmQgYm9vayBieSBJU0JOXG4gICAgICAgICAgICBjb25zdCBib29rID0gYXdhaXQgcHJpc21hLmJvb2suZmluZEZpcnN0KHtcbiAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgICAgICAgeyBpc2JuIH0sXG4gICAgICAgICAgICAgICAgICB7IGlzYm5QYXBlcmJhY2s6IGlzYm4gfSxcbiAgICAgICAgICAgICAgICAgIHsgaXNibkhhcmRjb3ZlcjogaXNibiB9LFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFib29rKSB7XG4gICAgICAgICAgICAgIGVycm9yQ291bnQrKztcbiAgICAgICAgICAgICAgZXJyb3JzLnB1c2goeyBpc2JuLCBtZXNzYWdlOiAnQm9vayBub3QgZm91bmQnIH0pO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgcHJpc21hLnNhbGUuY3JlYXRlKHtcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGJvb2tJZDogYm9vay5pZCxcbiAgICAgICAgICAgICAgICBpc2JuVXNlZDogaXNibixcbiAgICAgICAgICAgICAgICBwbGF0Zm9ybSxcbiAgICAgICAgICAgICAgICBzYWxlRGF0ZTogZGF0ZVN0ciA/IG5ldyBEYXRlKGRhdGVTdHIpIDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICBxdWFudGl0eSxcbiAgICAgICAgICAgICAgICB1bml0UHJpY2U6IGFtb3VudCAvIHF1YW50aXR5LFxuICAgICAgICAgICAgICAgIHRvdGFsQW1vdW50OiBhbW91bnQsXG4gICAgICAgICAgICAgICAgaW1wb3J0QmF0Y2hJZDogYmF0Y2hJZCxcbiAgICAgICAgICAgICAgICBpbXBvcnRTb3VyY2U6ICdjc3YnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHJveWFsdHlcbiAgICAgICAgICAgIGNvbnN0IGJ1Y2tldCA9IHBsYXRmb3JtLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3dlYnNpdGUnKSA/ICdXRUJTSVRFJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdlYm9vaycpIHx8IHBsYXRmb3JtLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2tpbmRsZScpID8gJ0VCT09LJyA6ICdFQ09NTUVSQ0UnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhd2FpdCBwcmlzbWEucm95YWx0eS5jcmVhdGUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgYXV0aG9ySWQ6IGJvb2suYXV0aG9ySWQsXG4gICAgICAgICAgICAgICAgYm9va0lkOiBib29rLmlkLFxuICAgICAgICAgICAgICAgIHNhbGVBbW91bnQ6IGFtb3VudCxcbiAgICAgICAgICAgICAgICBhbW91bnQ6IGFtb3VudCAqIDAuMTAsIC8vIDEwJSBkZWZhdWx0IHJveWFsdHlcbiAgICAgICAgICAgICAgICByb3lhbHR5UmF0ZTogMC4xMCxcbiAgICAgICAgICAgICAgICBidWNrZXQsXG4gICAgICAgICAgICAgICAgcGxhdGZvcm0sXG4gICAgICAgICAgICAgICAgcGVyaW9kOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgNyksIC8vIFlZWVktTU1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzdWNjZXNzQ291bnQrKztcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBlcnJvckNvdW50Kys7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCh7IG1lc3NhZ2U6IGUubWVzc2FnZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIGltcG9ydCBiYXRjaCByZWNvcmRcbiAgICAgIGF3YWl0IHByaXNtYS5pbXBvcnRCYXRjaC5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICB0b3RhbFJvd3M6IGRhdGEubGVuZ3RoLFxuICAgICAgICAgIHN1Y2Nlc3NDb3VudCxcbiAgICAgICAgICBlcnJvckNvdW50LFxuICAgICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgaW1wb3J0ZWRCeUlkLFxuICAgICAgICAgIGVycm9yczogZXJyb3JzLmxlbmd0aCA+IDAgPyBlcnJvcnMgOiBudWxsLFxuICAgICAgICAgIGNvbXBsZXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3NDb3VudCwgZXJyb3JDb3VudCwgZXJyb3JzIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIE9SREVSUyBQT1NUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUE9TVCAvYXBpL2FkbWluL29yZGVycy9zdGFnZXMgLSBDcmVhdGUgb3JkZXIgc3RhZ2VcbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9vcmRlcnMvc3RhZ2VzJykge1xuICAgICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgY29sb3IsIHNvcnRPcmRlciB9ID0gYm9keTtcblxuICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU3RhZ2UgbmFtZSBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3RhZ2UgPSBhd2FpdCBwcmlzbWEub3JkZXJTdGFnZS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7IG5hbWUsIGRlc2NyaXB0aW9uLCBjb2xvciwgc29ydE9yZGVyOiBzb3J0T3JkZXIgfHwgMCB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN0YWdlIH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi9vcmRlcnMvW2lkXS9tb3ZlLXN0YWdlIC0gTW92ZSBvcmRlciB0byBzdGFnZVxuICAgIGlmIChwYXRoLm1hdGNoKC9eXFwvYWRtaW5cXC9vcmRlcnNcXC9bXi9dK1xcL21vdmUtc3RhZ2UkLykpIHtcbiAgICAgIGNvbnN0IG9yZGVySWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCB7IHN0YWdlSWQsIG5vdGVzLCBtb3ZlZEJ5SWQgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IG9yZGVyID0gYXdhaXQgcHJpc21hLm9yZGVyLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICAgIGRhdGE6IHsgY3VycmVudFN0YWdlSWQ6IHN0YWdlSWQgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBSZWNvcmQgaGlzdG9yeVxuICAgICAgYXdhaXQgcHJpc21hLm9yZGVyU3RhZ2VIaXN0b3J5LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBvcmRlcklkLFxuICAgICAgICAgIHN0YWdlSWQsXG4gICAgICAgICAgbm90ZXMsXG4gICAgICAgICAgbW92ZWRCeUlkLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9yZGVyIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFJPWUFMVElFUyBQT1NUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUE9TVCAvYXBpL2FkbWluL3JveWFsdGllcy9tYXJrLXBhaWQgLSBNYXJrIHJveWFsdGllcyBhcyBwYWlkIGFuZCBub3RpZnkgYXV0aG9yc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3JveWFsdGllcy9tYXJrLXBhaWQnKSB7XG4gICAgICBjb25zdCB7IHJveWFsdHlJZHMsIHBheW1lbnRSZWYsIG1hcmtlZEJ5SWQgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghcm95YWx0eUlkcyB8fCAhQXJyYXkuaXNBcnJheShyb3lhbHR5SWRzKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ3JveWFsdHlJZHMgYXJyYXkgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCByb3lhbHRpZXMgd2l0aCBhdXRob3IgaW5mbyBiZWZvcmUgdXBkYXRpbmdcbiAgICAgIGNvbnN0IHJveWFsdGllc1RvTWFyayA9IGF3YWl0IHByaXNtYS5yb3lhbHR5LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHsgaW46IHJveWFsdHlJZHMgfSB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgYm9vazogeyBzZWxlY3Q6IHsgdGl0bGU6IHRydWUgfSB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZSByb3lhbHRpZXNcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCBwcmlzbWEucm95YWx0eS51cGRhdGVNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHsgaW46IHJveWFsdHlJZHMgfSB9LFxuICAgICAgICBkYXRhOiB7IGlzUGFpZDogdHJ1ZSwgcGFpZEF0OiBuZXcgRGF0ZSgpLCBwYXltZW50UmVmIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbnMgZm9yIGVhY2ggdW5pcXVlIGF1dGhvclxuICAgICAgY29uc3QgYXV0aG9yR3JvdXBzID0ge307XG4gICAgICBmb3IgKGNvbnN0IHIgb2Ygcm95YWx0aWVzVG9NYXJrKSB7XG4gICAgICAgIGlmICghYXV0aG9yR3JvdXBzW3IuYXV0aG9ySWRdKSB7XG4gICAgICAgICAgYXV0aG9yR3JvdXBzW3IuYXV0aG9ySWRdID0geyBhbW91bnQ6IDAsIGJvb2tzOiBbXSB9O1xuICAgICAgICB9XG4gICAgICAgIGF1dGhvckdyb3Vwc1tyLmF1dGhvcklkXS5hbW91bnQgKz0gci5hbW91bnQ7XG4gICAgICAgIGlmICghYXV0aG9yR3JvdXBzW3IuYXV0aG9ySWRdLmJvb2tzLmluY2x1ZGVzKHIuYm9vaz8udGl0bGUpKSB7XG4gICAgICAgICAgYXV0aG9yR3JvdXBzW3IuYXV0aG9ySWRdLmJvb2tzLnB1c2goci5ib29rPy50aXRsZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbiBmb3IgZWFjaCBhdXRob3JcbiAgICAgIGZvciAoY29uc3QgW2F1dGhvcklkLCBkYXRhXSBvZiBPYmplY3QuZW50cmllcyhhdXRob3JHcm91cHMpKSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5ub3RpZmljYXRpb24uY3JlYXRlKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICB1c2VySWQ6IGF1dGhvcklkLFxuICAgICAgICAgICAgdHlwZTogJ1JPWUFMVFlfUEFZTUVOVCcsXG4gICAgICAgICAgICB0aXRsZTogJ1JveWFsdHkgUGF5bWVudCBQcm9jZXNzZWQnLFxuICAgICAgICAgICAgbWVzc2FnZTogYFlvdXIgcm95YWx0eSBwYXltZW50IG9mIOKCuSR7ZGF0YS5hbW91bnQudG9Mb2NhbGVTdHJpbmcoKX0gaGFzIGJlZW4gcHJvY2Vzc2VkIGZvciAke2RhdGEuYm9va3Muam9pbignLCAnKX0uYCxcbiAgICAgICAgICAgIGxpbms6ICcvYXV0aG9yL3JveWFsdGllcycsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIHVwZGF0ZWQ6IHVwZGF0ZWQuY291bnQsIG5vdGlmaWVkOiBPYmplY3Qua2V5cyhhdXRob3JHcm91cHMpLmxlbmd0aCB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vYm9va3Mve2Jvb2tJZH0vcm95YWx0eS1jb25maWcgLSBDcmVhdGUvVXBkYXRlIHJveWFsdHkgY29uZmlnXG4gICAgaWYgKHBhdGgubWF0Y2goL15cXC9hZG1pblxcL2Jvb2tzXFwvW14vXStcXC9yb3lhbHR5LWNvbmZpZyQvKSkge1xuICAgICAgY29uc3QgYm9va0lkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3QgeyBwbGF0Zm9ybSwgcm95YWx0eUFtb3VudCB9ID0gYm9keTtcblxuICAgICAgaWYgKCFwbGF0Zm9ybSB8fCByb3lhbHR5QW1vdW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdwbGF0Zm9ybSBhbmQgcm95YWx0eUFtb3VudCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgY29uZmlnIGV4aXN0c1xuICAgICAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBwcmlzbWEuYm9va1JveWFsdHlDb25maWcuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGJvb2tJZF9wbGF0Zm9ybTogeyBib29rSWQsIHBsYXRmb3JtIH0gfSxcbiAgICAgIH0pO1xuXG4gICAgICBsZXQgY29uZmlnO1xuICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgIGNvbmZpZyA9IGF3YWl0IHByaXNtYS5ib29rUm95YWx0eUNvbmZpZy51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZy5pZCB9LFxuICAgICAgICAgIGRhdGE6IHsgcm95YWx0eUFtb3VudDogcGFyc2VGbG9hdChyb3lhbHR5QW1vdW50KSwgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25maWcgPSBhd2FpdCBwcmlzbWEuYm9va1JveWFsdHlDb25maWcuY3JlYXRlKHtcbiAgICAgICAgICBkYXRhOiB7IGJvb2tJZCwgcGxhdGZvcm0sIHJveWFsdHlBbW91bnQ6IHBhcnNlRmxvYXQocm95YWx0eUFtb3VudCkgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNvbmZpZyB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vcm95YWx0aWVzL2dlbmVyYXRlIC0gR2VuZXJhdGUgcm95YWx0aWVzIGZyb20gc2FsZXMgdXNpbmcgQU1PVU5ULUJBU0VEIG1vZGVsXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vcm95YWx0aWVzL2dlbmVyYXRlJykge1xuICAgICAgY29uc3QgeyBib29rSWQsIHF1YW50aXR5LCBwbGF0Zm9ybSwgcGVyaW9kIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWJvb2tJZCB8fCAhcXVhbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdib29rSWQgYW5kIHF1YW50aXR5IHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBidWNrZXQgPSBnZXRSb3lhbHR5QnVja2V0KHBsYXRmb3JtKTtcbiAgICAgIFxuICAgICAgLy8gR2V0IGJvb2ssIGl0cyBhdXRob3JzLCBhbmQgcm95YWx0eSBjb25maWdcbiAgICAgIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGJvb2tJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yczogeyBpbmNsdWRlOiB7IGF1dGhvcjogdHJ1ZSB9IH0sXG4gICAgICAgICAgYXV0aG9yOiB0cnVlLFxuICAgICAgICAgIHJveWFsdHlDb25maWdzOiB7XG4gICAgICAgICAgICB3aGVyZTogeyBwbGF0Zm9ybSwgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghYm9vaykge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0Jvb2sgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgcm95YWx0eSBhbW91bnQgZnJvbSBjb25maWdcbiAgICAgIGNvbnN0IHJveWFsdHlDb25maWcgPSBib29rLnJveWFsdHlDb25maWdzWzBdO1xuICAgICAgY29uc3Qgcm95YWx0eVBlclVuaXQgPSByb3lhbHR5Q29uZmlnPy5yb3lhbHR5QW1vdW50IHx8IDA7XG4gICAgICBcbiAgICAgIGlmIChyb3lhbHR5UGVyVW5pdCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ05vIHJveWFsdHkgYW1vdW50IGNvbmZpZ3VyZWQgZm9yIHRoaXMgYm9vay9wbGF0Zm9ybSBjb21iaW5hdGlvbicsXG4gICAgICAgICAgaGludDogJ0NvbmZpZ3VyZSByb3lhbHR5IGFtb3VudCBmaXJzdCBpbiBTYWxlcyA+IFJveWFsdHkgQ29uZmlndXJhdGlvbidcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gRGV0ZXJtaW5lIGF1dGhvcnNcbiAgICAgIGxldCBhdXRob3JzID0gYm9vay5hdXRob3JzLm1hcChiYSA9PiAoe1xuICAgICAgICBpZDogYmEuYXV0aG9yLmlkLFxuICAgICAgICBhdXRob3JVaWQ6IGJhLmF1dGhvci5hdXRob3JVaWQsXG4gICAgICAgIHNoYXJlOiBiYS5yb3lhbHR5U2hhcmUsXG4gICAgICB9KSk7XG5cbiAgICAgIGlmIChhdXRob3JzLmxlbmd0aCA9PT0gMCAmJiBib29rLmF1dGhvcikge1xuICAgICAgICBhdXRob3JzID0gW3sgaWQ6IGJvb2suYXV0aG9yLmlkLCBhdXRob3JVaWQ6IGJvb2suYXV0aG9yLmF1dGhvclVpZCwgc2hhcmU6IDEwMCB9XTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG90YWxSb3lhbHR5ID0gcm95YWx0eVBlclVuaXQgKiBxdWFudGl0eTtcbiAgICAgIGNvbnN0IHJveWFsdGllcyA9IFtdO1xuXG4gICAgICBmb3IgKGNvbnN0IGF1dGhvciBvZiBhdXRob3JzKSB7XG4gICAgICAgIGNvbnN0IHNoYXJlID0gYXV0aG9yLnNoYXJlICE9PSBudWxsID8gYXV0aG9yLnNoYXJlIC8gMTAwIDogMSAvIGF1dGhvcnMubGVuZ3RoO1xuICAgICAgICBjb25zdCByb3lhbHR5ID0gYXdhaXQgcHJpc21hLnJveWFsdHkuY3JlYXRlKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBhdXRob3JJZDogYXV0aG9yLmlkLFxuICAgICAgICAgICAgYXV0aG9yVWlkOiBhdXRob3IuYXV0aG9yVWlkLFxuICAgICAgICAgICAgYm9va0lkLFxuICAgICAgICAgICAgYW1vdW50OiB0b3RhbFJveWFsdHkgKiBzaGFyZSxcbiAgICAgICAgICAgIHJveWFsdHlSYXRlOiAwLCAvLyBOb3QgdXNlZCBpbiBhbW91bnQtYmFzZWQgbW9kZWxcbiAgICAgICAgICAgIHNhbGVBbW91bnQ6IDAsIC8vIE5vdCByZWxldmFudCBpbiBhbW91bnQtYmFzZWQgbW9kZWxcbiAgICAgICAgICAgIHF1YW50aXR5LFxuICAgICAgICAgICAgYnVja2V0LFxuICAgICAgICAgICAgcGxhdGZvcm0sXG4gICAgICAgICAgICBwZXJpb2Q6IHBlcmlvZCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgNyksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJveWFsdGllcy5wdXNoKHJveWFsdHkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByb3lhbHRpZXMsIHJveWFsdHlQZXJVbml0LCB0b3RhbFJveWFsdHkgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvYXBpL2FkbWluL3NhbGVzL2ltcG9ydCAtIEltcG9ydCBzYWxlcyBkYXRhIGFuZCBhdXRvLWdlbmVyYXRlIHJveWFsdGllc1xuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3NhbGVzL2ltcG9ydCcpIHtcbiAgICAgIGNvbnN0IHsgc2FsZXM6IHNhbGVzRGF0YSB9ID0gYm9keTtcblxuICAgICAgaWYgKCFzYWxlc0RhdGEgfHwgIUFycmF5LmlzQXJyYXkoc2FsZXNEYXRhKSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ3NhbGVzIGFycmF5IHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHRzID0ge1xuICAgICAgICBzdWNjZXNzOiBbXSxcbiAgICAgICAgZXJyb3JzOiBbXSxcbiAgICAgICAgcm95YWx0aWVzR2VuZXJhdGVkOiAwLFxuICAgICAgfTtcblxuICAgICAgZm9yIChjb25zdCBzYWxlSXRlbSBvZiBzYWxlc0RhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IGlzYm4sIHBsYXRmb3JtLCBxdWFudGl0eSwgc2FsZURhdGUsIHVuaXRQcmljZSB9ID0gc2FsZUl0ZW07XG5cbiAgICAgICAgICAvLyBGaW5kIGJvb2sgYnkgSVNCTlxuICAgICAgICAgIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICB7IGlzYm46IGlzYm4gfSxcbiAgICAgICAgICAgICAgICB7IGlzYm5QYXBlcmJhY2s6IGlzYm4gfSxcbiAgICAgICAgICAgICAgICB7IGlzYm5IYXJkY292ZXI6IGlzYm4gfSxcbiAgICAgICAgICAgICAgICB7IGlzYm5FYm9vazogaXNibiB9LFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgYXV0aG9yczogeyBpbmNsdWRlOiB7IGF1dGhvcjogdHJ1ZSB9IH0sXG4gICAgICAgICAgICAgIGF1dGhvcjogdHJ1ZSxcbiAgICAgICAgICAgICAgcm95YWx0eUNvbmZpZ3M6IHtcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwbGF0Zm9ybSwgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAoIWJvb2spIHtcbiAgICAgICAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goeyBpc2JuLCBlcnJvcjogJ0Jvb2sgbm90IGZvdW5kJyB9KTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENyZWF0ZSBzYWxlIHJlY29yZFxuICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCBwcmlzbWEuc2FsZS5jcmVhdGUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBib29rSWQ6IGJvb2suaWQsXG4gICAgICAgICAgICAgIGlzYm5Vc2VkOiBpc2JuLFxuICAgICAgICAgICAgICBwbGF0Zm9ybSxcbiAgICAgICAgICAgICAgcXVhbnRpdHk6IHBhcnNlSW50KHF1YW50aXR5KSB8fCAxLFxuICAgICAgICAgICAgICB1bml0UHJpY2U6IHBhcnNlRmxvYXQodW5pdFByaWNlKSB8fCAwLFxuICAgICAgICAgICAgICB0b3RhbEFtb3VudDogKHBhcnNlRmxvYXQodW5pdFByaWNlKSB8fCAwKSAqIChwYXJzZUludChxdWFudGl0eSkgfHwgMSksXG4gICAgICAgICAgICAgIHNhbGVEYXRlOiBuZXcgRGF0ZShzYWxlRGF0ZSksXG4gICAgICAgICAgICAgIGltcG9ydFNvdXJjZTogJ0NTVicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmVzdWx0cy5zdWNjZXNzLnB1c2goeyBpc2JuLCBzYWxlSWQ6IHNhbGUuaWQgfSk7XG5cbiAgICAgICAgICAvLyBBdXRvLWdlbmVyYXRlIHJveWFsdGllcyBpZiBjb25maWcgZXhpc3RzXG4gICAgICAgICAgY29uc3Qgcm95YWx0eUNvbmZpZyA9IGJvb2sucm95YWx0eUNvbmZpZ3NbMF07XG4gICAgICAgICAgaWYgKHJveWFsdHlDb25maWcpIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1Y2tldCA9IGdldFJveWFsdHlCdWNrZXQocGxhdGZvcm0pO1xuICAgICAgICAgICAgbGV0IGF1dGhvcnMgPSBib29rLmF1dGhvcnMubWFwKGJhID0+ICh7XG4gICAgICAgICAgICAgIGlkOiBiYS5hdXRob3IuaWQsXG4gICAgICAgICAgICAgIGF1dGhvclVpZDogYmEuYXV0aG9yLmF1dGhvclVpZCxcbiAgICAgICAgICAgICAgc2hhcmU6IGJhLnJveWFsdHlTaGFyZSxcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgaWYgKGF1dGhvcnMubGVuZ3RoID09PSAwICYmIGJvb2suYXV0aG9yKSB7XG4gICAgICAgICAgICAgIGF1dGhvcnMgPSBbeyBpZDogYm9vay5hdXRob3IuaWQsIGF1dGhvclVpZDogYm9vay5hdXRob3IuYXV0aG9yVWlkLCBzaGFyZTogMTAwIH1dO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB0b3RhbFJveWFsdHkgPSByb3lhbHR5Q29uZmlnLnJveWFsdHlBbW91bnQgKiAocGFyc2VJbnQocXVhbnRpdHkpIHx8IDEpO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGF1dGhvciBvZiBhdXRob3JzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHNoYXJlID0gYXV0aG9yLnNoYXJlICE9PSBudWxsID8gYXV0aG9yLnNoYXJlIC8gMTAwIDogMSAvIGF1dGhvcnMubGVuZ3RoO1xuICAgICAgICAgICAgICBhd2FpdCBwcmlzbWEucm95YWx0eS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgIGF1dGhvcklkOiBhdXRob3IuaWQsXG4gICAgICAgICAgICAgICAgICBhdXRob3JVaWQ6IGF1dGhvci5hdXRob3JVaWQsXG4gICAgICAgICAgICAgICAgICBib29rSWQ6IGJvb2suaWQsXG4gICAgICAgICAgICAgICAgICBzYWxlSWQ6IHNhbGUuaWQsXG4gICAgICAgICAgICAgICAgICBhbW91bnQ6IHRvdGFsUm95YWx0eSAqIHNoYXJlLFxuICAgICAgICAgICAgICAgICAgcm95YWx0eVJhdGU6IDAsXG4gICAgICAgICAgICAgICAgICBzYWxlQW1vdW50OiBzYWxlLnRvdGFsQW1vdW50LFxuICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHBhcnNlSW50KHF1YW50aXR5KSB8fCAxLFxuICAgICAgICAgICAgICAgICAgYnVja2V0LFxuICAgICAgICAgICAgICAgICAgcGxhdGZvcm0sXG4gICAgICAgICAgICAgICAgICBwZXJpb2Q6IG5ldyBEYXRlKHNhbGVEYXRlKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDcpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXN1bHRzLnJveWFsdGllc0dlbmVyYXRlZCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXN1bHRzLmVycm9ycy5wdXNoKHsgLi4uc2FsZUl0ZW0sIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJlc3VsdHMgfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT0gQURNSU4gTEVBRFMgUE9TVCBST1VURVMgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi9sZWFkcyAtIENyZWF0ZSBsZWFkXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vbGVhZHMnKSB7XG4gICAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwaG9uZSwgYWx0ZXJuYXRlRW1haWwsIGFsdGVybmF0ZVBob25lLCBzb3VyY2UsIGludGVyZXN0QXJlYSwgY29udHJhY3RBbW91bnQsIGRlYWRsaW5lLCBkZWFkbGluZVNldmVyaXR5LCBhc3NpZ25lZFRvSWQsIG5vdGVzLCBjcmVhdGVkQnlJZCwgc3RhZ2UgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghbmFtZSB8fCAhZW1haWwpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOYW1lIGFuZCBlbWFpbCBhcmUgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEhhbmRsZSBlbXB0eSBzdHJpbmdzIC0gY29udmVydCB0byBudWxsIGZvciBVVUlEIGZpZWxkc1xuICAgICAgY29uc3QgY2xlYW5Bc3NpZ25lZFRvSWQgPSBhc3NpZ25lZFRvSWQgJiYgYXNzaWduZWRUb0lkLnRyaW0oKSAhPT0gJycgPyBhc3NpZ25lZFRvSWQgOiBudWxsO1xuICAgICAgY29uc3QgY2xlYW5DcmVhdGVkQnlJZCA9IGNyZWF0ZWRCeUlkICYmIGNyZWF0ZWRCeUlkLnRyaW0oKSAhPT0gJycgPyBjcmVhdGVkQnlJZCA6IG51bGw7XG5cbiAgICAgIGNvbnN0IGxlYWQgPSBhd2FpdCBwcmlzbWEubGVhZC5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICBwaG9uZTogcGhvbmUgfHwgbnVsbCxcbiAgICAgICAgICBhbHRlcm5hdGVFbWFpbDogYWx0ZXJuYXRlRW1haWwgfHwgbnVsbCxcbiAgICAgICAgICBhbHRlcm5hdGVQaG9uZTogYWx0ZXJuYXRlUGhvbmUgfHwgbnVsbCxcbiAgICAgICAgICBzb3VyY2U6IHNvdXJjZSB8fCAnV0VCU0lURScsXG4gICAgICAgICAgaW50ZXJlc3RBcmVhOiBpbnRlcmVzdEFyZWEgfHwgbnVsbCxcbiAgICAgICAgICBjb250cmFjdEFtb3VudDogY29udHJhY3RBbW91bnQgPyBwYXJzZUZsb2F0KGNvbnRyYWN0QW1vdW50KSA6IG51bGwsXG4gICAgICAgICAgZGVhZGxpbmU6IGRlYWRsaW5lID8gbmV3IERhdGUoZGVhZGxpbmUpIDogbnVsbCxcbiAgICAgICAgICBkZWFkbGluZVNldmVyaXR5OiBkZWFkbGluZVNldmVyaXR5IHx8ICdNRURJVU0nLFxuICAgICAgICAgIGFzc2lnbmVkVG9JZDogY2xlYW5Bc3NpZ25lZFRvSWQsXG4gICAgICAgICAgY3JlYXRlZEJ5SWQ6IGNsZWFuQ3JlYXRlZEJ5SWQsXG4gICAgICAgICAgc3RhdHVzOiBzdGFnZSB8fCAnTkVXJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZGQgaW5pdGlhbCBub3RlIGlmIHByb3ZpZGVkXG4gICAgICBpZiAobm90ZXMpIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLmxlYWROb3RlLmNyZWF0ZSh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgbGVhZElkOiBsZWFkLmlkLFxuICAgICAgICAgICAgY29udGVudDogbm90ZXMsXG4gICAgICAgICAgICBjcmVhdGVkQnlJZCxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbGVhZDogeyAuLi5sZWFkLCBzdGFnZTogbGVhZC5zdGF0dXMgfSB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vbGVhZHMvW2lkXS9ub3RlcyAtIEFkZCBub3RlIHRvIGxlYWRcbiAgICBpZiAocGF0aC5tYXRjaCgvXlxcL2FkbWluXFwvbGVhZHNcXC9bXi9dK1xcL25vdGVzJC8pKSB7XG4gICAgICBjb25zdCBsZWFkSWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCB7IGNvbnRlbnQsIGNyZWF0ZWRCeUlkLCBjcmVhdGVkQnlOYW1lIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdDb250ZW50IGlzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBsZWFkID0gYXdhaXQgcHJpc21hLmxlYWQuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBsZWFkSWQgfSB9KTtcbiAgICAgIGlmICghbGVhZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0xlYWQgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBub3RlID0gYXdhaXQgcHJpc21hLmxlYWROb3RlLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBsZWFkSWQsXG4gICAgICAgICAgY29udGVudCxcbiAgICAgICAgICBjcmVhdGVkQnlJZCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBub3RlIH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi9zaXRlLXNldHRpbmdzIC0gU2F2ZSBzaXRlIHNldHRpbmdzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vc2l0ZS1zZXR0aW5ncycpIHtcbiAgICAgIGNvbnN0IHNldHRpbmdzID0gYm9keTtcblxuICAgICAgLy8gU2F2ZSBlYWNoIGNhdGVnb3J5IG9mIHNldHRpbmdzXG4gICAgICBmb3IgKGNvbnN0IFtjYXRlZ29yeSwgdmFsdWVzXSBvZiBPYmplY3QuZW50cmllcyhzZXR0aW5ncykpIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLnNpdGVTZXR0aW5nLnVwc2VydCh7XG4gICAgICAgICAgd2hlcmU6IHsga2V5OiBjYXRlZ29yeSB9LFxuICAgICAgICAgIHVwZGF0ZTogeyB2YWx1ZTogdmFsdWVzIH0sXG4gICAgICAgICAgY3JlYXRlOiB7IGtleTogY2F0ZWdvcnksIHZhbHVlOiB2YWx1ZXMgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT0gQURNSU4gQk9PS1MgUE9TVCBST1VURVMgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi9ib29rcyAtIENyZWF0ZSBib29rIGZyb20gYWRtaW5cbiAgICBpZiAocGF0aCA9PT0gJy9hZG1pbi9ib29rcycpIHtcbiAgICAgIGNvbnN0IHsgdGl0bGUsIGF1dGhvcklkLCBhdXRob3JVaWQsIGF1dGhvckVtYWlsLCBjYXRlZ29yeSwgZGVzY3JpcHRpb24sIGlzYm5QYXBlcmJhY2ssIGlzYm5IYXJkY292ZXIsIGFsbG93V29yZFVwbG9hZCB9ID0gYm9keTtcblxuICAgICAgLy8gVmFsaWRhdGlvbjogVGl0bGUgcmVxdWlyZWRcbiAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdUaXRsZSBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGlvbjogRXhhY3RseSBvbmUgb2YgYXV0aG9ySWQsIGF1dGhvclVpZCwgb3IgYXV0aG9yRW1haWwgcmVxdWlyZWRcbiAgICAgIGNvbnN0IGF1dGhvcklkZW50aWZpZXJzID0gW2F1dGhvcklkLCBhdXRob3JVaWQsIGF1dGhvckVtYWlsXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICBpZiAoYXV0aG9ySWRlbnRpZmllcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnQXV0aG9yIGlkZW50aWZpY2F0aW9uIHJlcXVpcmVkLiBQcm92aWRlIG9uZSBvZjogYXV0aG9ySWQsIGF1dGhvclVpZCwgb3IgYXV0aG9yRW1haWwnIFxuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBGaW5kIGF1dGhvciBieSBJRCwgVUlELCBvciBFbWFpbFxuICAgICAgbGV0IGF1dGhvciA9IG51bGw7XG4gICAgICBpZiAoYXV0aG9ySWQpIHtcbiAgICAgICAgYXV0aG9yID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBhdXRob3JJZCB9IH0pO1xuICAgICAgICBpZiAoIWF1dGhvcikge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQXV0aG9yIG5vdCBmb3VuZCB3aXRoIHByb3ZpZGVkIElEJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGF1dGhvclVpZCkge1xuICAgICAgICBhdXRob3IgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgYXV0aG9yVWlkIH0gfSk7XG4gICAgICAgIGlmICghYXV0aG9yKSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGBBdXRob3Igbm90IGZvdW5kIHdpdGggVUlEOiAke2F1dGhvclVpZH1gIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYXV0aG9yRW1haWwpIHtcbiAgICAgICAgYXV0aG9yID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGVtYWlsOiBhdXRob3JFbWFpbC50b0xvd2VyQ2FzZSgpIH0gfSk7XG4gICAgICAgIGlmICghYXV0aG9yKSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGBBdXRob3Igbm90IGZvdW5kIHdpdGggZW1haWw6ICR7YXV0aG9yRW1haWx9YCB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBib29rIHdpdGggcHVibGlzaGluZyBzdGFnZXMgKElTQk4gaXMgb3B0aW9uYWwpXG4gICAgICAvLyBPbmx5IElOSVRJQUxfUkVWSUVXIGlzIHZpc2libGUgYnkgZGVmYXVsdCwgb3RoZXJzIGFyZSBoaWRkZW5cbiAgICAgIGNvbnN0IHB1Ymxpc2hpbmdTdGFnZVR5cGVzID0gW1xuICAgICAgICB7IHR5cGU6ICdNQU5VU0NSSVBUX1JFQ0VJVkVEJywgdmlzaWJsZTogZmFsc2UgfSxcbiAgICAgICAgeyB0eXBlOiAnSU5JVElBTF9SRVZJRVcnLCB2aXNpYmxlOiB0cnVlIH0sIC8vIE9ubHkgdGhpcyBvbmUgdmlzaWJsZSBvbiBzdWJtaXNzaW9uXG4gICAgICAgIHsgdHlwZTogJ0VESVRJTkcnLCB2aXNpYmxlOiBmYWxzZSB9LFxuICAgICAgICB7IHR5cGU6ICdQUk9PRlJFQURJTkcnLCB2aXNpYmxlOiBmYWxzZSB9LFxuICAgICAgICB7IHR5cGU6ICdDT1ZFUl9ERVNJR04nLCB2aXNpYmxlOiBmYWxzZSB9LFxuICAgICAgICB7IHR5cGU6ICdJTlRFUklPUl9GT1JNQVRUSU5HJywgdmlzaWJsZTogZmFsc2UgfSxcbiAgICAgICAgeyB0eXBlOiAnRklOQUxfUkVWSUVXJywgdmlzaWJsZTogZmFsc2UgfSxcbiAgICAgICAgeyB0eXBlOiAnSVNCTl9BU1NJR05NRU5UJywgdmlzaWJsZTogZmFsc2UgfSxcbiAgICAgICAgeyB0eXBlOiAnUFJJTlRJTkcnLCB2aXNpYmxlOiBmYWxzZSB9LFxuICAgICAgICB7IHR5cGU6ICdESVNUUklCVVRJT04nLCB2aXNpYmxlOiBmYWxzZSB9LFxuICAgICAgICB7IHR5cGU6ICdDT01QTEVURUQnLCB2aXNpYmxlOiBmYWxzZSB9LFxuICAgICAgXTtcblxuICAgICAgY29uc3QgYm9vayA9IGF3YWl0IHByaXNtYS5ib29rLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICBhdXRob3JJZDogYXV0aG9yLmlkLFxuICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSB8fCBudWxsLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCBudWxsLFxuICAgICAgICAgIGlzYm5QYXBlcmJhY2s6IGlzYm5QYXBlcmJhY2sgfHwgbnVsbCxcbiAgICAgICAgICBpc2JuSGFyZGNvdmVyOiBpc2JuSGFyZGNvdmVyIHx8IG51bGwsXG4gICAgICAgICAgaXNibjogaXNiblBhcGVyYmFjayB8fCBudWxsLCAvLyBMZWdhY3kgZmllbGQgc3luY2VkIHdpdGggcGFwZXJiYWNrXG4gICAgICAgICAgc3RhdHVzOiAnRFJBRlQnLFxuICAgICAgICAgIGFsbG93V29yZFVwbG9hZDogYWxsb3dXb3JkVXBsb2FkIHx8IGZhbHNlLFxuICAgICAgICAgIHB1Ymxpc2hpbmdTdGFnZXM6IHtcbiAgICAgICAgICAgIGNyZWF0ZTogcHVibGlzaGluZ1N0YWdlVHlwZXMubWFwKChzdGFnZSwgaW5kZXgpID0+ICh7XG4gICAgICAgICAgICAgIHN0YWdlVHlwZTogc3RhZ2UudHlwZSxcbiAgICAgICAgICAgICAgc3RhZ2VPcmRlcjogaW5kZXggKyAxLFxuICAgICAgICAgICAgICBzdGF0dXM6IHN0YWdlLnR5cGUgPT09ICdJTklUSUFMX1JFVklFVycgPyAnUEVORElORycgOiAnUEVORElORycsXG4gICAgICAgICAgICAgIGlzVmlzaWJsZTogc3RhZ2UudmlzaWJsZSxcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlIH0gfSxcbiAgICAgICAgICBwdWJsaXNoaW5nU3RhZ2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGJvb2sgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvYXBpL2FkbWluL2Jvb2tzL2ltcG9ydCAtIEJ1bGsgaW1wb3J0IGJvb2tzXG4gICAgaWYgKHBhdGggPT09ICcvYWRtaW4vYm9va3MvaW1wb3J0Jykge1xuICAgICAgY29uc3QgeyBib29rczogYm9va3NEYXRhIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWJvb2tzRGF0YSB8fCAhQXJyYXkuaXNBcnJheShib29rc0RhdGEpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQm9va3MgYXJyYXkgaXMgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSB7IHN1Y2Nlc3M6IFtdLCBlcnJvcnM6IFtdLCBza2lwcGVkOiBbXSB9O1xuXG4gICAgICBmb3IgKGNvbnN0IGJvb2tEYXRhIG9mIGJvb2tzRGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgdGl0bGUsIGF1dGhvclVpZCwgYXV0aG9yRW1haWwsIGlzYm5QYXBlcmJhY2ssIGlzYm5IYXJkY292ZXIsIGNhdGVnb3J5IH0gPSBib29rRGF0YTtcblxuICAgICAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goeyB0aXRsZTogdGl0bGUgfHwgJ1Vua25vd24nLCBlcnJvcjogJ1RpdGxlIGlzIHJlcXVpcmVkJyB9KTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEZpbmQgYXV0aG9yIGJ5IFVJRCBvciBlbWFpbCAoYXQgbGVhc3Qgb25lIHJlcXVpcmVkKVxuICAgICAgICAgIGxldCBhdXRob3IgPSBudWxsO1xuICAgICAgICAgIGlmIChhdXRob3JVaWQpIHtcbiAgICAgICAgICAgIGF1dGhvciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBhdXRob3JVaWQgfSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFhdXRob3IgJiYgYXV0aG9yRW1haWwpIHtcbiAgICAgICAgICAgIGF1dGhvciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBlbWFpbDogYXV0aG9yRW1haWwudG9Mb3dlckNhc2UoKSB9IH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghYXV0aG9yKSB7XG4gICAgICAgICAgICByZXN1bHRzLmVycm9ycy5wdXNoKHsgXG4gICAgICAgICAgICAgIHRpdGxlLCBcbiAgICAgICAgICAgICAgZXJyb3I6IGBBdXRob3Igbm90IGZvdW5kLiBQcm92aWRlZDogJHthdXRob3JVaWQgPyBgVUlEPSR7YXV0aG9yVWlkfWAgOiAnJ30gJHthdXRob3JFbWFpbCA/IGBFbWFpbD0ke2F1dGhvckVtYWlsfWAgOiAnJ31gLnRyaW0oKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBDaGVjayBmb3IgZHVwbGljYXRlIElTQk5cbiAgICAgICAgICBpZiAoaXNiblBhcGVyYmFjaykge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaXNiblBhcGVyYmFjayB9IH0pO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICAgIHJlc3VsdHMuc2tpcHBlZC5wdXNoKHsgdGl0bGUsIHJlYXNvbjogYFBhcGVyYmFjayBJU0JOICR7aXNiblBhcGVyYmFja30gYWxyZWFkeSBleGlzdHNgIH0pO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBwdWJsaXNoaW5nU3RhZ2VUeXBlcyA9IFtcbiAgICAgICAgICAgICdNQU5VU0NSSVBUX1JFQ0VJVkVEJywgJ0lOSVRJQUxfUkVWSUVXJywgJ0VESVRJTkcnLCAnUFJPT0ZSRUFESU5HJyxcbiAgICAgICAgICAgICdDT1ZFUl9ERVNJR04nLCAnSU5URVJJT1JfRk9STUFUVElORycsICdGSU5BTF9SRVZJRVcnLCAnSVNCTl9BU1NJR05NRU5UJyxcbiAgICAgICAgICAgICdQUklOVElORycsICdESVNUUklCVVRJT04nLCAnQ09NUExFVEVEJyxcbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgY29uc3QgYm9vayA9IGF3YWl0IHByaXNtYS5ib29rLmNyZWF0ZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICBhdXRob3JJZDogYXV0aG9yLmlkLFxuICAgICAgICAgICAgICBjYXRlZ29yeTogY2F0ZWdvcnkgfHwgbnVsbCxcbiAgICAgICAgICAgICAgaXNiblBhcGVyYmFjazogaXNiblBhcGVyYmFjayB8fCBudWxsLFxuICAgICAgICAgICAgICBpc2JuSGFyZGNvdmVyOiBpc2JuSGFyZGNvdmVyIHx8IG51bGwsXG4gICAgICAgICAgICAgIGlzYm46IGlzYm5QYXBlcmJhY2sgfHwgbnVsbCxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnRFJBRlQnLFxuICAgICAgICAgICAgICBwdWJsaXNoaW5nU3RhZ2VzOiB7XG4gICAgICAgICAgICAgICAgY3JlYXRlOiBwdWJsaXNoaW5nU3RhZ2VUeXBlcy5tYXAoKHR5cGUsIGluZGV4KSA9PiAoe1xuICAgICAgICAgICAgICAgICAgc3RhZ2VUeXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgICAgc3RhZ2VPcmRlcjogaW5kZXggKyAxLFxuICAgICAgICAgICAgICAgICAgc3RhdHVzOiBpbmRleCA9PT0gMCA/ICdJTl9QUk9HUkVTUycgOiAnUEVORElORycsXG4gICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHJlc3VsdHMuc3VjY2Vzcy5wdXNoKHsgdGl0bGUsIGlkOiBib29rLmlkIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goeyB0aXRsZTogYm9va0RhdGEudGl0bGUgfHwgJ1Vua25vd24nLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByZXN1bHRzIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFBBQ0tBR0VTIFBPU1QgUk9VVEVTID09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vcGFja2FnZXMgLSBDcmVhdGUgcGFja2FnZVxuICAgIGlmIChwYXRoID09PSAnL2FkbWluL3BhY2thZ2VzJykge1xuICAgICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGZlYXR1cmVzLCBpc1BvcHVsYXIsIHNvcnRPcmRlciB9ID0gYm9keTtcblxuICAgICAgaWYgKCFuYW1lIHx8IHByaWNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOYW1lIGFuZCBwcmljZSBhcmUgcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBrZyA9IGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nUGFja2FnZS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICBwcmljZSxcbiAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZXMgfHwgW10sXG4gICAgICAgICAgaXNQb3B1bGFyOiBpc1BvcHVsYXIgfHwgZmFsc2UsXG4gICAgICAgICAgc29ydE9yZGVyOiBzb3J0T3JkZXIgfHwgMCxcbiAgICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBwYWNrYWdlOiBwa2cgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvYXBpL2NhdGVnb3JpZXNcbiAgICBpZiAocGF0aCA9PT0gJy9jYXRlZ29yaWVzJykge1xuICAgICAgY29uc3QgeyBuYW1lOiBjYXROYW1lLCBkZXNjcmlwdGlvbjogY2F0RGVzYywgcGFyZW50SWQsIHNlb1RpdGxlLCBzZW9EZXNjIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWNhdE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOYW1lIGlzIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBsZXQgc2x1ZyA9IGNhdE5hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csICctJykucmVwbGFjZSgvLSsvZywgJy0nKTtcbiAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgIHdoaWxlIChhd2FpdCBwcmlzbWEuY2F0ZWdvcnkuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IHNsdWcgfSB9KSkge1xuICAgICAgICBzbHVnID0gYCR7Y2F0TmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XSsvZywgJy0nKX0tJHtjb3VudGVyfWA7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBwcmlzbWEuY2F0ZWdvcnkuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIG5hbWU6IGNhdE5hbWUsXG4gICAgICAgICAgc2x1ZyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogY2F0RGVzYyxcbiAgICAgICAgICBwYXJlbnRJZCxcbiAgICAgICAgICBzZW9UaXRsZTogc2VvVGl0bGUgfHwgY2F0TmFtZSxcbiAgICAgICAgICBzZW9EZXNjLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNhdGVnb3J5IH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEJMT0cgUE9TVCBST1VURVMgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIFBPU1QgL2FwaS9ibG9nIC0gQ3JlYXRlIGJsb2cgcG9zdCAoYWRtaW4vYmxvZyB3cml0ZXIpXG4gICAgaWYgKHBhdGggPT09ICcvYmxvZycpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdGl0bGU6IGJsb2dUaXRsZSxcbiAgICAgICAgY29udGVudDogYmxvZ0NvbnRlbnQsXG4gICAgICAgIGV4Y2VycHQsXG4gICAgICAgIGNvdmVySW1hZ2UsXG4gICAgICAgIGF1dGhvck5hbWUsXG4gICAgICAgIGF1dGhvcklkOiBibG9nQXV0aG9ySWQsXG4gICAgICAgIGNhdGVnb3J5OiBibG9nQ2F0ZWdvcnksXG4gICAgICAgIHRhZ3MsXG4gICAgICAgIGlzUHVibGlzaGVkLFxuICAgICAgICBsaW5rZWRCb29rSWQsXG4gICAgICAgIHNlb1RpdGxlLFxuICAgICAgICBzZW9EZXNjLFxuICAgICAgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghYmxvZ1RpdGxlIHx8ICFibG9nQ29udGVudCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ1RpdGxlIGFuZCBjb250ZW50IGFyZSByZXF1aXJlZCcgfSxcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2VuZXJhdGUgc2x1Z1xuICAgICAgbGV0IHNsdWcgPSBibG9nVGl0bGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csICctJykucmVwbGFjZSgvLSsvZywgJy0nKS5yZXBsYWNlKC9eLXwtJC9nLCAnJyk7XG4gICAgICBsZXQgY291bnRlciA9IDE7XG4gICAgICB3aGlsZSAoYXdhaXQgcHJpc21hLmJsb2dQb3N0LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBzbHVnIH0gfSkpIHtcbiAgICAgICAgc2x1ZyA9IGAke2Jsb2dUaXRsZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XSsvZywgJy0nKS5yZXBsYWNlKC8tKy9nLCAnLScpfS0ke2NvdW50ZXJ9YDtcbiAgICAgICAgY291bnRlcisrO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwb3N0ID0gYXdhaXQgcHJpc21hLmJsb2dQb3N0LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0aXRsZTogYmxvZ1RpdGxlLFxuICAgICAgICAgIHNsdWcsXG4gICAgICAgICAgY29udGVudDogYmxvZ0NvbnRlbnQsXG4gICAgICAgICAgZXhjZXJwdDogZXhjZXJwdCB8fCBibG9nQ29udGVudC5zdWJzdHJpbmcoMCwgMjAwKSArICcuLi4nLFxuICAgICAgICAgIGNvdmVySW1hZ2UsXG4gICAgICAgICAgYXV0aG9yTmFtZTogYXV0aG9yTmFtZSB8fCAnQWRtaW4nLFxuICAgICAgICAgIGF1dGhvcklkOiBibG9nQXV0aG9ySWQsXG4gICAgICAgICAgY2F0ZWdvcnk6IGJsb2dDYXRlZ29yeSxcbiAgICAgICAgICB0YWdzOiB0YWdzID8gKEFycmF5LmlzQXJyYXkodGFncykgPyB0YWdzIDogdGFncy5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKSkgOiBudWxsLFxuICAgICAgICAgIGlzUHVibGlzaGVkOiBpc1B1Ymxpc2hlZCB8fCBmYWxzZSxcbiAgICAgICAgICBwdWJsaXNoZWRBdDogaXNQdWJsaXNoZWQgPyBuZXcgRGF0ZSgpIDogbnVsbCxcbiAgICAgICAgICBsaW5rZWRCb29rSWQsXG4gICAgICAgICAgc2VvVGl0bGU6IHNlb1RpdGxlIHx8IGJsb2dUaXRsZSxcbiAgICAgICAgICBzZW9EZXNjOiBzZW9EZXNjIHx8IGV4Y2VycHQsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcG9zdCB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYmxvZy9bc2x1Z10vY29tbWVudCAtIEFkZCBjb21tZW50IHRvIGJsb2cgcG9zdFxuICAgIGlmIChwYXRoLm1hdGNoKC9eXFwvYmxvZ1xcL1teL10rXFwvY29tbWVudCQvKSkge1xuICAgICAgY29uc3Qgc2x1ZyA9IHBhdGhTZWdtZW50c1sxXTtcbiAgICAgIGNvbnN0IHsgYXV0aG9yTmFtZTogY29tbWVudEF1dGhvciwgYXV0aG9yRW1haWwsIGNvbnRlbnQ6IGNvbW1lbnRDb250ZW50IH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWNvbW1lbnRBdXRob3IgfHwgIWNvbW1lbnRDb250ZW50KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnTmFtZSBhbmQgY29tbWVudCBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBwcmlzbWEuYmxvZ1Bvc3QuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IHNsdWcgfSB9KTtcbiAgICAgIGlmICghcG9zdCB8fCAhcG9zdC5pc1B1Ymxpc2hlZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1Bvc3Qgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjb21tZW50ID0gYXdhaXQgcHJpc21hLmJsb2dDb21tZW50LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBwb3N0SWQ6IHBvc3QuaWQsXG4gICAgICAgICAgYXV0aG9yTmFtZTogY29tbWVudEF1dGhvcixcbiAgICAgICAgICBhdXRob3JFbWFpbCxcbiAgICAgICAgICBjb250ZW50OiBjb21tZW50Q29udGVudCxcbiAgICAgICAgICBpc0FwcHJvdmVkOiBmYWxzZSwgLy8gUmVxdWlyZXMgYWRtaW4gbW9kZXJhdGlvblxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNvbW1lbnQsIG1lc3NhZ2U6ICdDb21tZW50IHN1Ym1pdHRlZCBmb3IgbW9kZXJhdGlvbicgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvYXBpL2Jsb2cvW3NsdWddL2xpa2UgLSBMaWtlIGEgYmxvZyBwb3N0XG4gICAgaWYgKHBhdGgubWF0Y2goL15cXC9ibG9nXFwvW14vXStcXC9saWtlJC8pKSB7XG4gICAgICBjb25zdCBzbHVnID0gcGF0aFNlZ21lbnRzWzFdO1xuICAgICAgY29uc3QgeyB2aXNpdG9ySWQgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghdmlzaXRvcklkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVmlzaXRvciBJRCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IHByaXNtYS5ibG9nUG9zdC5maW5kVW5pcXVlKHsgd2hlcmU6IHsgc2x1ZyB9IH0pO1xuICAgICAgaWYgKCFwb3N0IHx8ICFwb3N0LmlzUHVibGlzaGVkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnUG9zdCBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIGFscmVhZHkgbGlrZWRcbiAgICAgIGNvbnN0IGV4aXN0aW5nTGlrZSA9IGF3YWl0IHByaXNtYS5ibG9nTGlrZS5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgcG9zdElkX3Zpc2l0b3JJZDogeyBwb3N0SWQ6IHBvc3QuaWQsIHZpc2l0b3JJZCB9IH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKGV4aXN0aW5nTGlrZSkge1xuICAgICAgICAvLyBVbmxpa2VcbiAgICAgICAgYXdhaXQgcHJpc21hLmJsb2dMaWtlLmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBleGlzdGluZ0xpa2UuaWQgfSB9KTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbGlrZWQ6IGZhbHNlIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBBZGQgbGlrZVxuICAgICAgYXdhaXQgcHJpc21hLmJsb2dMaWtlLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHsgcG9zdElkOiBwb3N0LmlkLCB2aXNpdG9ySWQgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBsaWtlZDogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvZ3Vlc3QtcG9zdHMgLSBTdWJtaXQgZ3Vlc3QgcG9zdFxuICAgIGlmIChwYXRoID09PSAnL2d1ZXN0LXBvc3RzJykge1xuICAgICAgY29uc3Qge1xuICAgICAgICB0aXRsZTogZ3Vlc3RUaXRsZSxcbiAgICAgICAgY29udGVudDogZ3Vlc3RDb250ZW50LFxuICAgICAgICB3cml0ZXJOYW1lLFxuICAgICAgICBlbWFpbDogZ3Vlc3RFbWFpbCxcbiAgICAgICAgcGhvbmU6IGd1ZXN0UGhvbmUsXG4gICAgICAgIHNvY2lhbExpbmtzOiBndWVzdFNvY2lhbExpbmtzLFxuICAgICAgfSA9IGJvZHk7XG5cbiAgICAgIGlmICghZ3Vlc3RUaXRsZSB8fCAhZ3Vlc3RDb250ZW50IHx8ICF3cml0ZXJOYW1lIHx8ICFndWVzdEVtYWlsKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnVGl0bGUsIGNvbnRlbnQsIHdyaXRlciBuYW1lLCBhbmQgZW1haWwgYXJlIHJlcXVpcmVkJyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBndWVzdFBvc3QgPSBhd2FpdCBwcmlzbWEuZ3Vlc3RQb3N0LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0aXRsZTogZ3Vlc3RUaXRsZSxcbiAgICAgICAgICBjb250ZW50OiBndWVzdENvbnRlbnQsXG4gICAgICAgICAgd3JpdGVyTmFtZSxcbiAgICAgICAgICBlbWFpbDogZ3Vlc3RFbWFpbCxcbiAgICAgICAgICBwaG9uZTogZ3Vlc3RQaG9uZSxcbiAgICAgICAgICBzb2NpYWxMaW5rczogZ3Vlc3RTb2NpYWxMaW5rcyxcbiAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBndWVzdFBvc3QsIG1lc3NhZ2U6ICdHdWVzdCBwb3N0IHN1Ym1pdHRlZCBmb3IgcmV2aWV3JyB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRtaW4vYmxvZy9jb21tZW50cy9baWRdL2FwcHJvdmUgLSBBcHByb3ZlIGNvbW1lbnRcbiAgICBpZiAocGF0aC5tYXRjaCgvXlxcL2FkbWluXFwvYmxvZ1xcL2NvbW1lbnRzXFwvW14vXStcXC9hcHByb3ZlJC8pKSB7XG4gICAgICBjb25zdCBjb21tZW50SWQgPSBwYXRoU2VnbWVudHNbM107XG4gICAgICBjb25zdCB7IGFwcHJvdmVkIH0gPSBib2R5O1xuXG4gICAgICBjb25zdCBjb21tZW50ID0gYXdhaXQgcHJpc21hLmJsb2dDb21tZW50LnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBjb21tZW50SWQgfSxcbiAgICAgICAgZGF0YTogeyBpc0FwcHJvdmVkOiBhcHByb3ZlZCAhPT0gZmFsc2UgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBjb21tZW50IH0pO1xuICAgIH1cblxuICAgIC8vIFBPU1QgL2FwaS9hZG1pbi9ndWVzdC1wb3N0cy9baWRdL3JldmlldyAtIFJldmlldyBndWVzdCBwb3N0XG4gICAgaWYgKHBhdGgubWF0Y2goL15cXC9hZG1pblxcL2d1ZXN0LXBvc3RzXFwvW14vXStcXC9yZXZpZXckLykpIHtcbiAgICAgIGNvbnN0IGd1ZXN0UG9zdElkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3QgeyBzdGF0dXM6IHJldmlld1N0YXR1cywgcmVqZWN0UmVhc29uLCByZXZpZXdlZEJ5IH0gPSBib2R5O1xuXG4gICAgICBpZiAoIVsnYXBwcm92ZWQnLCAncmVqZWN0ZWQnXS5pbmNsdWRlcyhyZXZpZXdTdGF0dXMpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnSW52YWxpZCBzdGF0dXMnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGd1ZXN0UG9zdCA9IGF3YWl0IHByaXNtYS5ndWVzdFBvc3QudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGd1ZXN0UG9zdElkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdGF0dXM6IHJldmlld1N0YXR1cyxcbiAgICAgICAgICByZWplY3RSZWFzb246IHJldmlld1N0YXR1cyA9PT0gJ3JlamVjdGVkJyA/IHJlamVjdFJlYXNvbiA6IG51bGwsXG4gICAgICAgICAgcmV2aWV3ZWRCeSxcbiAgICAgICAgICByZXZpZXdlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIElmIGFwcHJvdmVkLCBjcmVhdGUgYSBibG9nIHBvc3RcbiAgICAgIGlmIChyZXZpZXdTdGF0dXMgPT09ICdhcHByb3ZlZCcpIHtcbiAgICAgICAgbGV0IHNsdWcgPSBndWVzdFBvc3QudGl0bGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csICctJykucmVwbGFjZSgvLSsvZywgJy0nKTtcbiAgICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgICB3aGlsZSAoYXdhaXQgcHJpc21hLmJsb2dQb3N0LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBzbHVnIH0gfSkpIHtcbiAgICAgICAgICBzbHVnID0gYCR7Z3Vlc3RQb3N0LnRpdGxlLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTldKy9nLCAnLScpfS0ke2NvdW50ZXJ9YDtcbiAgICAgICAgICBjb3VudGVyKys7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCBwcmlzbWEuYmxvZ1Bvc3QuY3JlYXRlKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICB0aXRsZTogZ3Vlc3RQb3N0LnRpdGxlLFxuICAgICAgICAgICAgc2x1ZyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGd1ZXN0UG9zdC5jb250ZW50LFxuICAgICAgICAgICAgZXhjZXJwdDogZ3Vlc3RQb3N0LmNvbnRlbnQuc3Vic3RyaW5nKDAsIDIwMCkgKyAnLi4uJyxcbiAgICAgICAgICAgIGF1dGhvck5hbWU6IGd1ZXN0UG9zdC53cml0ZXJOYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnk6ICdHdWVzdCBQb3N0JyxcbiAgICAgICAgICAgIGlzUHVibGlzaGVkOiB0cnVlLFxuICAgICAgICAgICAgcHVibGlzaGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGd1ZXN0UG9zdCB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvYWRkb25zXG4gICAgaWYgKHBhdGggPT09ICcvYWRkb25zJykge1xuICAgICAgY29uc3QgeyBuYW1lOiBhZGRvbk5hbWUsIGRlc2NyaXB0aW9uOiBhZGRvbkRlc2MsIHNlcnZpY2VUeXBlOiBhZGRvblNlcnZpY2UsIGJhc2VQcmljZSwgcHJpY2luZ1R5cGUsIHByaWNpbmdUaWVycyB9ID0gYm9keTtcblxuICAgICAgaWYgKCFhZGRvbk5hbWUgfHwgIWFkZG9uU2VydmljZSB8fCBiYXNlUHJpY2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ05hbWUsIHNlcnZpY2UgdHlwZSwgYW5kIGJhc2UgcHJpY2UgYXJlIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhZGRPbiA9IGF3YWl0IHByaXNtYS5zZXJ2aWNlQWRkT24uY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIG5hbWU6IGFkZG9uTmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogYWRkb25EZXNjLFxuICAgICAgICAgIHNlcnZpY2VUeXBlOiBhZGRvblNlcnZpY2UsXG4gICAgICAgICAgYmFzZVByaWNlLFxuICAgICAgICAgIHByaWNpbmdUeXBlOiBwcmljaW5nVHlwZSB8fCAnZml4ZWQnLFxuICAgICAgICAgIHByaWNpbmdUaWVycyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBhZGRPbiB9KTtcbiAgICB9XG5cbiAgICAvLyBQT1NUIC9hcGkvcmV2aWV3c1xuICAgIGlmIChwYXRoID09PSAnL3Jldmlld3MnKSB7XG4gICAgICBjb25zdCB7IGJvb2tJZDogcmV2aWV3Qm9va0lkLCBhdXRob3JOYW1lOiByZXZpZXdBdXRob3IsIGJvb2tUaXRsZTogcmV2aWV3Qm9va1RpdGxlLCByYXRpbmcsIGNvbnRlbnQ6IHJldmlld0NvbnRlbnQsIHNvdXJjZSwgZGlzcGxheU9uIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIXJldmlld0F1dGhvciB8fCAhcmF0aW5nIHx8ICFyZXZpZXdDb250ZW50KSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQXV0aG9yIG5hbWUsIHJhdGluZywgYW5kIGNvbnRlbnQgYXJlIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXZpZXcgPSBhd2FpdCBwcmlzbWEucmV2aWV3LmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBib29rSWQ6IHJldmlld0Jvb2tJZCxcbiAgICAgICAgICBhdXRob3JOYW1lOiByZXZpZXdBdXRob3IsXG4gICAgICAgICAgYm9va1RpdGxlOiByZXZpZXdCb29rVGl0bGUsXG4gICAgICAgICAgcmF0aW5nLFxuICAgICAgICAgIGNvbnRlbnQ6IHJldmlld0NvbnRlbnQsXG4gICAgICAgICAgc291cmNlLFxuICAgICAgICAgIGRpc3BsYXlPbixcbiAgICAgICAgICBpc0FwcHJvdmVkOiBmYWxzZSwgLy8gTmVlZHMgYWRtaW4gYXBwcm92YWxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyByZXZpZXcgfSk7XG4gICAgfVxuXG4gICAgLy8gUE9TVCAvYXBpL2Rpc2NvdW50c1xuICAgIGlmIChwYXRoID09PSAnL2Rpc2NvdW50cycpIHtcbiAgICAgIGNvbnN0IHsgbmFtZTogZGlzY05hbWUsIGNvZGU6IGRpc2NDb2RlLCBkaXNjb3VudFR5cGUsIGRpc2NvdW50VmFsdWUsIGFwcGxpZXNUbywgc3RhcnRzQXQsIGV4cGlyZXNBdCwgc2hvd1RpbWVyLCBtYXhVc2VzIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWRpc2NOYW1lIHx8ICFkaXNjb3VudFZhbHVlIHx8ICFhcHBsaWVzVG8pIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOYW1lLCBkaXNjb3VudCB2YWx1ZSwgYW5kIGFwcGxpZXMgdG8gYXJlIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkaXNjb3VudCA9IGF3YWl0IHByaXNtYS5kaXNjb3VudC5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgbmFtZTogZGlzY05hbWUsXG4gICAgICAgICAgY29kZTogZGlzY0NvZGUsXG4gICAgICAgICAgZGlzY291bnRUeXBlOiBkaXNjb3VudFR5cGUgfHwgJ3BlcmNlbnRhZ2UnLFxuICAgICAgICAgIGRpc2NvdW50VmFsdWUsXG4gICAgICAgICAgYXBwbGllc1RvLFxuICAgICAgICAgIHN0YXJ0c0F0OiBzdGFydHNBdCA/IG5ldyBEYXRlKHN0YXJ0c0F0KSA6IG51bGwsXG4gICAgICAgICAgZXhwaXJlc0F0OiBleHBpcmVzQXQgPyBuZXcgRGF0ZShleHBpcmVzQXQpIDogbnVsbCxcbiAgICAgICAgICBzaG93VGltZXI6IHNob3dUaW1lciB8fCBmYWxzZSxcbiAgICAgICAgICBtYXhVc2VzLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGRpc2NvdW50IH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBQT1NUIEVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKHJlcXVlc3QsIGNvbnRleHQpIHtcbiAgY29uc3QgcGFyYW1zID0gYXdhaXQgY29udGV4dC5wYXJhbXM7XG4gIGNvbnN0IHBhdGhTZWdtZW50cyA9IHBhcmFtcz8ucGF0aCB8fCBbXTtcbiAgY29uc3QgcGF0aCA9ICcvJyArIHBhdGhTZWdtZW50cy5qb2luKCcvJyk7XG5cbiAgdHJ5IHtcbiAgICAvLyBQYXJzZSBib2R5XG4gICAgbGV0IGJvZHkgPSB7fTtcbiAgICB0cnkge1xuICAgICAgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIEJvZHkgbWlnaHQgYmUgZW1wdHlcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBBVVRIT1IgUFVUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUFVUIC9hcGkvYXV0aG9yL3NldHRpbmdzL3Byb2ZpbGUgLSBVcGRhdGUgYXV0aG9yIHByb2ZpbGVcbiAgICBpZiAocGF0aCA9PT0gJy9hdXRob3Ivc2V0dGluZ3MvcHJvZmlsZScpIHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtdXNlci1pZCcpO1xuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgbmFtZSwgcGhvbmUsIGFsdGVybmF0ZUVtYWlsLCBhbHRlcm5hdGVQaG9uZSwgYmlvLCB3ZWJzaXRlLCBwdWJsaWNVcmwsIHNvY2lhbExpbmtzIH0gPSBib2R5O1xuXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge307XG4gICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBuYW1lO1xuICAgICAgaWYgKHBob25lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGhvbmUgPSBwaG9uZTtcbiAgICAgIGlmIChhbHRlcm5hdGVFbWFpbCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmFsdGVybmF0ZUVtYWlsID0gYWx0ZXJuYXRlRW1haWw7XG4gICAgICBpZiAoYWx0ZXJuYXRlUGhvbmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hbHRlcm5hdGVQaG9uZSA9IGFsdGVybmF0ZVBob25lO1xuICAgICAgaWYgKGJpbyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmJpbyA9IGJpbztcbiAgICAgIGlmICh3ZWJzaXRlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEud2Vic2l0ZSA9IHdlYnNpdGU7XG4gICAgICBpZiAocHVibGljVXJsICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucHVibGljVXJsID0gcHVibGljVXJsO1xuICAgICAgaWYgKHNvY2lhbExpbmtzICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc29jaWFsTGlua3MgPSBzb2NpYWxMaW5rcztcblxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiB1c2VySWQgfSxcbiAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCB1c2VyIH0pO1xuICAgIH1cblxuICAgIC8vIFBVVCAvYXBpL2F1dGhvci9zZXR0aW5ncy9iYW5rIC0gVXBkYXRlIGF1dGhvciBiYW5rIGRldGFpbHNcbiAgICBpZiAocGF0aCA9PT0gJy9hdXRob3Ivc2V0dGluZ3MvYmFuaycpIHtcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtdXNlci1pZCcpO1xuICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgYWNjb3VudE5hbWUsIGFjY291bnROdW1iZXIsIGJhbmtOYW1lLCBpZnNjQ29kZSwgYnJhbmNoTmFtZSB9ID0gYm9keTtcblxuICAgICAgY29uc3QgZXhpc3RpbmcgPSBhd2FpdCBwcmlzbWEuYmFua0RldGFpbHMuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IHVzZXJJZCB9IH0pO1xuXG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLmJhbmtEZXRhaWxzLnVwZGF0ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICAgICAgZGF0YTogeyBhY2NvdW50TmFtZSwgYWNjb3VudE51bWJlciwgYmFua05hbWUsIGlmc2NDb2RlLCBicmFuY2hOYW1lIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgcHJpc21hLmJhbmtEZXRhaWxzLmNyZWF0ZSh7XG4gICAgICAgICAgZGF0YTogeyB1c2VySWQsIGFjY291bnROYW1lLCBhY2NvdW50TnVtYmVyLCBiYW5rTmFtZSwgaWZzY0NvZGUsIGJyYW5jaE5hbWUgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gUFVUIC9hcGkvYXV0aG9yL21hbnVzY3JpcHRzIC0gVXBkYXRlIG1hbnVzY3JpcHQgc3RhdHVzXG4gICAgaWYgKHBhdGggPT09ICcvYXV0aG9yL21hbnVzY3JpcHRzJykge1xuICAgICAgY29uc3QgdXNlcklkID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWlkJyk7XG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBpZCwgc3RhdHVzLCBjb250ZW50LCBmaWxlTmFtZSwgZmlsZVVybCwgaXNXb3JkVXBsb2FkIH0gPSBib2R5O1xuXG4gICAgICBpZiAoIWlkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWFudXNjcmlwdCBJRCByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9O1xuICAgICAgaWYgKHN0YXR1cyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgIGlmIChjb250ZW50ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29udGVudCA9IGNvbnRlbnQ7XG4gICAgICBpZiAoZmlsZU5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5maWxlTmFtZSA9IGZpbGVOYW1lO1xuICAgICAgaWYgKGZpbGVVcmwgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5maWxlVXJsID0gZmlsZVVybDtcbiAgICAgIGlmIChpc1dvcmRVcGxvYWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc1dvcmRVcGxvYWQgPSBpc1dvcmRVcGxvYWQ7XG5cbiAgICAgIGNvbnN0IG1hbnVzY3JpcHQgPSBhd2FpdCBwcmlzbWEubWFudXNjcmlwdC51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgICBkYXRhOiB1cGRhdGVEYXRhLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG1hbnVzY3JpcHQgfSk7XG4gICAgfVxuXG4gICAgLy8gUFVUIC9hcGkvYXV0aG9yL3NldHRpbmdzL25vdGlmaWNhdGlvbnMgLSBVcGRhdGUgbm90aWZpY2F0aW9uIHByZWZlcmVuY2VzXG4gICAgaWYgKHBhdGggPT09ICcvYXV0aG9yL3NldHRpbmdzL25vdGlmaWNhdGlvbnMnKSB7XG4gICAgICAvLyBGb3Igbm93LCBqdXN0IGFja25vd2xlZGdlIC0gdGhlc2Ugd291bGQgbm9ybWFsbHkgYmUgc3RvcmVkIGluIGEgc2V0dGluZ3MgdGFibGVcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT0gQURNSU4gTEVBRFMgUFVUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUFVUIC9hcGkvYWRtaW4vbGVhZHMvW2lkXSAtIFVwZGF0ZSBsZWFkXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2FkbWluL2xlYWRzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIGNvbnN0IGxlYWRJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIGNvbnN0IHsgc3RhZ2UsIHN0YXR1cywgY29udHJhY3RBbW91bnQsIGRlYWRsaW5lLCBkZWFkbGluZVNldmVyaXR5LCBhc3NpZ25lZFRvSWQsIGludGVyZXN0QXJlYSwgbmFtZSwgZW1haWwsIHBob25lIH0gPSBib2R5O1xuXG4gICAgICBjb25zdCBsZWFkID0gYXdhaXQgcHJpc21hLmxlYWQuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBsZWFkSWQgfSB9KTtcbiAgICAgIGlmICghbGVhZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0xlYWQgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge307XG4gICAgICBcbiAgICAgIC8vIFRyYWNrIHN0YWdlL3N0YXR1cyBjaGFuZ2UgKGFjY2VwdCBib3RoICdzdGFnZScgYW5kICdzdGF0dXMnIGZvciBjb21wYXRpYmlsaXR5KVxuICAgICAgY29uc3QgbmV3U3RhdHVzID0gc3RhZ2UgfHwgc3RhdHVzO1xuICAgICAgaWYgKG5ld1N0YXR1cyAhPT0gdW5kZWZpbmVkICYmIG5ld1N0YXR1cyAhPT0gbGVhZC5zdGF0dXMpIHtcbiAgICAgICAgdXBkYXRlRGF0YS5zdGF0dXMgPSBuZXdTdGF0dXM7XG4gICAgICAgIGlmIChuZXdTdGF0dXMgPT09ICdDT05WRVJURUQnKSB7XG4gICAgICAgICAgdXBkYXRlRGF0YS5jb252ZXJ0ZWRBdCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gbmFtZTtcbiAgICAgIGlmIChlbWFpbCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmVtYWlsID0gZW1haWw7XG4gICAgICBpZiAocGhvbmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5waG9uZSA9IHBob25lO1xuICAgICAgaWYgKGNvbnRyYWN0QW1vdW50ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29udHJhY3RBbW91bnQgPSBjb250cmFjdEFtb3VudCA/IHBhcnNlRmxvYXQoY29udHJhY3RBbW91bnQpIDogbnVsbDtcbiAgICAgIGlmIChkZWFkbGluZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlYWRsaW5lID0gZGVhZGxpbmUgPyBuZXcgRGF0ZShkZWFkbGluZSkgOiBudWxsO1xuICAgICAgaWYgKGRlYWRsaW5lU2V2ZXJpdHkgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZWFkbGluZVNldmVyaXR5ID0gZGVhZGxpbmVTZXZlcml0eTtcbiAgICAgIGlmIChhc3NpZ25lZFRvSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hc3NpZ25lZFRvSWQgPSBhc3NpZ25lZFRvSWQgJiYgYXNzaWduZWRUb0lkLnRyaW0oKSAhPT0gJycgPyBhc3NpZ25lZFRvSWQgOiBudWxsO1xuICAgICAgaWYgKGludGVyZXN0QXJlYSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmludGVyZXN0QXJlYSA9IGludGVyZXN0QXJlYTtcblxuICAgICAgY29uc3QgdXBkYXRlZExlYWQgPSBhd2FpdCBwcmlzbWEubGVhZC51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogbGVhZElkIH0sXG4gICAgICAgIGRhdGE6IHVwZGF0ZURhdGEsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhc3NpZ25lZFRvOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgICAgbm90ZXM6IHsgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB0YWtlOiAxMCB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBsZWFkOiB7XG4gICAgICAgICAgLi4udXBkYXRlZExlYWQsXG4gICAgICAgICAgc3RhZ2U6IHVwZGF0ZWRMZWFkLnN0YXR1cyxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT0gQURNSU4gQ0FURUdPUklFUyBQVVQgUk9VVEVTID09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBVcGRhdGUgY2F0ZWdvcnkgKGFkbWluKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9jYXRlZ29yaWVzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIGNvbnN0IGNhdGVnb3J5SWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCBwYXJlbnRJZCwgaXNBY3RpdmUsIHNlb1RpdGxlLCBzZW9EZXNjLCBzb3J0T3JkZXIgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fTtcbiAgICAgIGlmIChuYW1lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEubmFtZSA9IG5hbWU7XG4gICAgICBpZiAoZGVzY3JpcHRpb24gIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgaWYgKHBhcmVudElkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGFyZW50SWQgPSBwYXJlbnRJZCB8fCBudWxsO1xuICAgICAgaWYgKGlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNBY3RpdmUgPSBpc0FjdGl2ZTtcbiAgICAgIGlmIChzZW9UaXRsZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNlb1RpdGxlID0gc2VvVGl0bGU7XG4gICAgICBpZiAoc2VvRGVzYyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNlb0Rlc2MgPSBzZW9EZXNjO1xuICAgICAgaWYgKHNvcnRPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNvcnRPcmRlciA9IHNvcnRPcmRlcjtcblxuICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBwcmlzbWEuY2F0ZWdvcnkudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNhdGVnb3J5SWQgfSxcbiAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBjYXRlZ29yeSB9KTtcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBBRE1JTiBTVEFHRSBURU1QTEFURVMgUFVUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUFVUIC9hcGkvYWRtaW4vc3RhZ2UtdGVtcGxhdGVzL1tpZF0gLSBVcGRhdGUgYSBzdGFnZSB0ZW1wbGF0ZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9zdGFnZS10ZW1wbGF0ZXMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgdGVtcGxhdGVJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIGlzRGVmYXVsdCwgc29ydE9yZGVyLCBpc0FjdGl2ZSB9ID0gYm9keTtcblxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9O1xuICAgICAgaWYgKG5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gbmFtZTtcbiAgICAgIGlmIChkZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICBpZiAoaXNEZWZhdWx0ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNEZWZhdWx0ID0gaXNEZWZhdWx0O1xuICAgICAgaWYgKHNvcnRPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNvcnRPcmRlciA9IHNvcnRPcmRlcjtcbiAgICAgIGlmIChpc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzQWN0aXZlID0gaXNBY3RpdmU7XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gYXdhaXQgcHJpc21hLnN0YWdlVGVtcGxhdGUudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHRlbXBsYXRlSWQgfSxcbiAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB0ZW1wbGF0ZSB9KTtcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBBRE1JTiBVU0VSUyBQVVQgUk9VVEVTID09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvLyBQVVQgL2FwaS9hZG1pbi91c2Vycy9baWRdIC0gVXBkYXRlIHVzZXJcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvYWRtaW4vdXNlcnMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgdXNlcklkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3QgeyBuYW1lLCBwaG9uZSwgcm9sZSwgaXNBY3RpdmUsIGlzQmxvZ1dyaXRlciwgYWx0ZXJuYXRlRW1haWwsIGFsdGVybmF0ZVBob25lLCBiaW8sIHdlYnNpdGUsIHNvY2lhbExpbmtzIH0gPSBib2R5O1xuXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge307XG4gICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLm5hbWUgPSBuYW1lO1xuICAgICAgaWYgKHBob25lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGhvbmUgPSBwaG9uZTtcbiAgICAgIGlmIChyb2xlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucm9sZSA9IHJvbGU7XG4gICAgICBpZiAoaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc0FjdGl2ZSA9IGlzQWN0aXZlO1xuICAgICAgaWYgKGlzQmxvZ1dyaXRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzQmxvZ1dyaXRlciA9IGlzQmxvZ1dyaXRlcjtcbiAgICAgIGlmIChhbHRlcm5hdGVFbWFpbCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmFsdGVybmF0ZUVtYWlsID0gYWx0ZXJuYXRlRW1haWw7XG4gICAgICBpZiAoYWx0ZXJuYXRlUGhvbmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hbHRlcm5hdGVQaG9uZSA9IGFsdGVybmF0ZVBob25lO1xuICAgICAgaWYgKGJpbyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmJpbyA9IGJpbztcbiAgICAgIGlmICh3ZWJzaXRlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEud2Vic2l0ZSA9IHdlYnNpdGU7XG4gICAgICBpZiAoc29jaWFsTGlua3MgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5zb2NpYWxMaW5rcyA9IHNvY2lhbExpbmtzO1xuXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgICBkYXRhOiB1cGRhdGVEYXRhLFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlLCBlbWFpbDogdHJ1ZSwgbmFtZTogdHJ1ZSwgcm9sZTogdHJ1ZSwgcGhvbmU6IHRydWUsIGlzQWN0aXZlOiB0cnVlLCBpc0Jsb2dXcml0ZXI6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdXNlciB9KTtcbiAgICB9XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PSBBRE1JTiBPUkRFUlMgUFVUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUFVUIC9hcGkvYWRtaW4vb3JkZXJzL3N0YWdlcy9baWRdIC0gVXBkYXRlIG9yZGVyIHN0YWdlXG4gICAgaWYgKHBhdGgubWF0Y2goL15cXC9hZG1pblxcL29yZGVyc1xcL3N0YWdlc1xcL1teL10rJC8pICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDQpIHtcbiAgICAgIGNvbnN0IHN0YWdlSWQgPSBwYXRoU2VnbWVudHNbM107XG4gICAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCBjb2xvciwgc29ydE9yZGVyLCBpc0FjdGl2ZSB9ID0gYm9keTtcblxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9O1xuICAgICAgaWYgKG5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gbmFtZTtcbiAgICAgIGlmIChkZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICBpZiAoY29sb3IgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jb2xvciA9IGNvbG9yO1xuICAgICAgaWYgKHNvcnRPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNvcnRPcmRlciA9IHNvcnRPcmRlcjtcbiAgICAgIGlmIChpc0FjdGl2ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzQWN0aXZlID0gaXNBY3RpdmU7XG5cbiAgICAgIGNvbnN0IHN0YWdlID0gYXdhaXQgcHJpc21hLm9yZGVyU3RhZ2UudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHN0YWdlSWQgfSxcbiAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdGFnZSB9KTtcbiAgICB9XG5cbiAgICAvLyBQVVQgL2FwaS9hZG1pbi9vcmRlcnMvW2lkXSAtIFVwZGF0ZSBvcmRlclxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9vcmRlcnMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMyAmJiBwYXRoU2VnbWVudHNbMl0gIT09ICdzdGFnZXMnKSB7XG4gICAgICBjb25zdCBvcmRlcklkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3QgeyBzdGF0dXMsIGN1cnJlbnRTdGFnZUlkLCBzaGlwcGluZ05hbWUsIHNoaXBwaW5nRW1haWwsIHNoaXBwaW5nUGhvbmUsIHNoaXBwaW5nQWRkcmVzcywgc2hpcHBpbmdDaXR5LCBzaGlwcGluZ1N0YXRlLCBzaGlwcGluZ1ppcENvZGUgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fTtcbiAgICAgIGlmIChzdGF0dXMgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICBpZiAoY3VycmVudFN0YWdlSWQgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jdXJyZW50U3RhZ2VJZCA9IGN1cnJlbnRTdGFnZUlkO1xuICAgICAgaWYgKHNoaXBwaW5nTmFtZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNoaXBwaW5nTmFtZSA9IHNoaXBwaW5nTmFtZTtcbiAgICAgIGlmIChzaGlwcGluZ0VtYWlsICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2hpcHBpbmdFbWFpbCA9IHNoaXBwaW5nRW1haWw7XG4gICAgICBpZiAoc2hpcHBpbmdQaG9uZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNoaXBwaW5nUGhvbmUgPSBzaGlwcGluZ1Bob25lO1xuICAgICAgaWYgKHNoaXBwaW5nQWRkcmVzcyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNoaXBwaW5nQWRkcmVzcyA9IHNoaXBwaW5nQWRkcmVzcztcbiAgICAgIGlmIChzaGlwcGluZ0NpdHkgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5zaGlwcGluZ0NpdHkgPSBzaGlwcGluZ0NpdHk7XG4gICAgICBpZiAoc2hpcHBpbmdTdGF0ZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNoaXBwaW5nU3RhdGUgPSBzaGlwcGluZ1N0YXRlO1xuICAgICAgaWYgKHNoaXBwaW5nWmlwQ29kZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNoaXBwaW5nWmlwQ29kZSA9IHNoaXBwaW5nWmlwQ29kZTtcblxuICAgICAgLy8gVXBkYXRlIHRpbWVzdGFtcHMgYmFzZWQgb24gc3RhdHVzXG4gICAgICBpZiAoc3RhdHVzID09PSAnU0hJUFBFRCcgJiYgIXVwZGF0ZURhdGEuc2hpcHBlZEF0KSB1cGRhdGVEYXRhLnNoaXBwZWRBdCA9IG5ldyBEYXRlKCk7XG4gICAgICBpZiAoc3RhdHVzID09PSAnREVMSVZFUkVEJyAmJiAhdXBkYXRlRGF0YS5kZWxpdmVyZWRBdCkgdXBkYXRlRGF0YS5kZWxpdmVyZWRBdCA9IG5ldyBEYXRlKCk7XG5cbiAgICAgIGNvbnN0IG9yZGVyID0gYXdhaXQgcHJpc21hLm9yZGVyLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBvcmRlcklkIH0sXG4gICAgICAgIGRhdGE6IHVwZGF0ZURhdGEsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb3JkZXIgfSk7XG4gICAgfVxuXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT0gQURNSU4gQk9PS1MgUFVUIFJPVVRFUyA9PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLy8gUFVUIC9hcGkvYWRtaW4vYm9va3MvW2lkXSAtIFVwZGF0ZSBib29rIChpbmNsdWRpbmcgSVNCTiwgZGVhZGxpbmUsIHNldmVyaXR5KVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9ib29rcy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzICYmICFwYXRoLmluY2x1ZGVzKCcvc3RhZ2VzJykpIHtcbiAgICAgIGNvbnN0IGJvb2tJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIGNvbnN0IHsgXG4gICAgICAgIHRpdGxlLCBpc2JuUGFwZXJiYWNrLCBpc2JuSGFyZGNvdmVyLCBpc2JuRWJvb2ssIFxuICAgICAgICBjYXRlZ29yeSwgc3RhdHVzLCBkZXNjcmlwdGlvbixcbiAgICAgICAgZGVhZGxpbmUsIGRlYWRsaW5lU2V2ZXJpdHksXG4gICAgICAgIC8vIFN0b3JlIGxpc3RpbmcgZmllbGRzXG4gICAgICAgIGlzUHVibGljLCBpc0F1dGhvckNvcHksIHByaWNlLCBkaXNjb3VudFByaWNlLFxuICAgICAgICBwYXBlcmJhY2tQcmljZSwgaGFyZGNvdmVyUHJpY2UsIGVib29rUHJpY2UsXG4gICAgICAgIGhhc1BhcGVyYmFjaywgaGFzSGFyZGNvdmVyLCBoYXNFYm9vaywgYXV0aG9yQ29weVByaWNlLCBhdXRob3JDb3B5TU9RLCBhdXRob3JDb3B5VGllcnMsIHNoaXBwaW5nRW5hYmxlZCxcbiAgICAgICAgLy8gU3RvcmUgZGlzcGxheSBvdmVycmlkZXNcbiAgICAgICAgc3RvcmVEaXNwbGF5VGl0bGUsIHN0b3JlRGlzcGxheUF1dGhvciwgc3RvcmVEaXNwbGF5RGVzY3JpcHRpb24sIHN0b3JlRGlzcGxheUNvdmVyXG4gICAgICB9ID0gYm9keTtcblxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9O1xuICAgICAgaWYgKHRpdGxlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEudGl0bGUgPSB0aXRsZTtcbiAgICAgIGlmIChjYXRlZ29yeSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XG4gICAgICBpZiAoZGVzY3JpcHRpb24gIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgaWYgKHN0YXR1cyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgIGlmIChkZWFkbGluZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlYWRsaW5lID0gZGVhZGxpbmUgPyBuZXcgRGF0ZShkZWFkbGluZSkgOiBudWxsO1xuICAgICAgaWYgKGRlYWRsaW5lU2V2ZXJpdHkgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5kZWFkbGluZVNldmVyaXR5ID0gZGVhZGxpbmVTZXZlcml0eTtcblxuICAgICAgLy8gSGFuZGxlIElTQk4gdXBkYXRlcyAtIGltcG9ydGFudCBmb3IgY2Fub25pY2FsIGxpbmtpbmdcbiAgICAgIGlmIChpc2JuUGFwZXJiYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXBkYXRlRGF0YS5pc2JuUGFwZXJiYWNrID0gaXNiblBhcGVyYmFjayB8fCBudWxsO1xuICAgICAgICAvLyBQYXBlcmJhY2sgSVNCTiBzeW5jZWQgdG8gbGVnYWN5IGlzYm4gZmllbGRcbiAgICAgICAgdXBkYXRlRGF0YS5pc2JuID0gaXNiblBhcGVyYmFjayB8fCBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKGlzYm5IYXJkY292ZXIgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc2JuSGFyZGNvdmVyID0gaXNibkhhcmRjb3ZlciB8fCBudWxsO1xuICAgICAgaWYgKGlzYm5FYm9vayAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmlzYm5FYm9vayA9IGlzYm5FYm9vayB8fCBudWxsO1xuXG4gICAgICAvLyBTdG9yZSBsaXN0aW5nIGZpZWxkc1xuICAgICAgaWYgKGlzUHVibGljICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNQdWJsaWMgPSBpc1B1YmxpYztcbiAgICAgIGlmIChpc0F1dGhvckNvcHkgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc0F1dGhvckNvcHkgPSBpc0F1dGhvckNvcHk7XG4gICAgICBpZiAocHJpY2UgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcmljZSA9IHBhcnNlRmxvYXQocHJpY2UpIHx8IDA7XG4gICAgICBpZiAoZGlzY291bnRQcmljZSAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRpc2NvdW50UHJpY2UgPSBkaXNjb3VudFByaWNlID8gcGFyc2VGbG9hdChkaXNjb3VudFByaWNlKSA6IG51bGw7XG4gICAgICBpZiAocGFwZXJiYWNrUHJpY2UgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wYXBlcmJhY2tQcmljZSA9IHBhcGVyYmFja1ByaWNlID8gcGFyc2VGbG9hdChwYXBlcmJhY2tQcmljZSkgOiBudWxsO1xuICAgICAgaWYgKGhhcmRjb3ZlclByaWNlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaGFyZGNvdmVyUHJpY2UgPSBoYXJkY292ZXJQcmljZSA/IHBhcnNlRmxvYXQoaGFyZGNvdmVyUHJpY2UpIDogbnVsbDtcbiAgICAgIGlmIChlYm9va1ByaWNlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZWJvb2tQcmljZSA9IGVib29rUHJpY2UgPyBwYXJzZUZsb2F0KGVib29rUHJpY2UpIDogbnVsbDtcbiAgICAgIGlmIChoYXNQYXBlcmJhY2sgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5oYXNQYXBlcmJhY2sgPSBoYXNQYXBlcmJhY2s7XG4gICAgICBpZiAoaGFzSGFyZGNvdmVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaGFzSGFyZGNvdmVyID0gaGFzSGFyZGNvdmVyO1xuICAgICAgaWYgKGhhc0Vib29rICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaGFzRWJvb2sgPSBoYXNFYm9vaztcbiAgICAgIGlmIChhdXRob3JDb3B5UHJpY2UgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hdXRob3JDb3B5UHJpY2UgPSBhdXRob3JDb3B5UHJpY2UgPyBwYXJzZUZsb2F0KGF1dGhvckNvcHlQcmljZSkgOiBudWxsO1xuICAgICAgaWYgKGF1dGhvckNvcHlNT1EgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hdXRob3JDb3B5TU9RID0gcGFyc2VJbnQoYXV0aG9yQ29weU1PUSkgfHwgMTtcbiAgICAgIGlmIChhdXRob3JDb3B5VGllcnMgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5hdXRob3JDb3B5VGllcnMgPSBhdXRob3JDb3B5VGllcnM7XG4gICAgICBpZiAoc2hpcHBpbmdFbmFibGVkICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2hpcHBpbmdFbmFibGVkID0gc2hpcHBpbmdFbmFibGVkO1xuXG4gICAgICAvLyBTdG9yZSBkaXNwbGF5IG92ZXJyaWRlc1xuICAgICAgaWYgKHN0b3JlRGlzcGxheVRpdGxlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc3RvcmVEaXNwbGF5VGl0bGUgPSBzdG9yZURpc3BsYXlUaXRsZSB8fCBudWxsO1xuICAgICAgaWYgKHN0b3JlRGlzcGxheUF1dGhvciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnN0b3JlRGlzcGxheUF1dGhvciA9IHN0b3JlRGlzcGxheUF1dGhvciB8fCBudWxsO1xuICAgICAgaWYgKHN0b3JlRGlzcGxheURlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc3RvcmVEaXNwbGF5RGVzY3JpcHRpb24gPSBzdG9yZURpc3BsYXlEZXNjcmlwdGlvbiB8fCBudWxsO1xuICAgICAgaWYgKHN0b3JlRGlzcGxheUNvdmVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc3RvcmVEaXNwbGF5Q292ZXIgPSBzdG9yZURpc3BsYXlDb3ZlciB8fCBudWxsO1xuICAgICAgXG4gICAgICAvLyBXb3JkIHVwbG9hZCB0b2dnbGVcbiAgICAgIGlmIChib2R5LmFsbG93V29yZFVwbG9hZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmFsbG93V29yZFVwbG9hZCA9IGJvZHkuYWxsb3dXb3JkVXBsb2FkO1xuXG4gICAgICBjb25zdCBib29rID0gYXdhaXQgcHJpc21hLmJvb2sudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGJvb2tJZCB9LFxuICAgICAgICBkYXRhOiB1cGRhdGVEYXRhLFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgYXV0aG9yOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlIH0gfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBib29rIH0pO1xuICAgIH1cblxuICAgIC8vIFBVVCAvYXBpL2FkbWluL2Jvb2tzL1tib29rSWRdL3N0YWdlcy9bc3RhZ2VJZF0gLSBVcGRhdGUgc3RhZ2Ugc3RhdHVzL2Fzc2lnbm1lbnRcbiAgICBpZiAocGF0aC5tYXRjaCgvXFwvYWRtaW5cXC9ib29rc1xcL1teL10rXFwvc3RhZ2VzXFwvW14vXSskLykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gNSkge1xuICAgICAgY29uc3QgYm9va0lkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3Qgc3RhZ2VJZCA9IHBhdGhTZWdtZW50c1s0XTtcbiAgICAgIGNvbnN0IHsgc3RhdHVzLCBhc3NpZ25lZFRvSWQsIG5vdGVzLCBkdWVEYXRlLCBmaWxlTGluaywgaXNWaXNpYmxlLCBjaGFuZ2VkQnlJZCB9ID0gYm9keTtcblxuICAgICAgLy8gR2V0IGN1cnJlbnQgc3RhZ2UgZm9yIGhpc3RvcnlcbiAgICAgIGNvbnN0IGN1cnJlbnRTdGFnZSA9IGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nU3RhZ2UuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBzdGFnZUlkIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFjdXJyZW50U3RhZ2UgfHwgY3VycmVudFN0YWdlLmJvb2tJZCAhPT0gYm9va0lkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU3RhZ2Ugbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBjaGFuZ2VkQnlJZCBpZiBwcm92aWRlZFxuICAgICAgbGV0IHZhbGlkQ2hhbmdlZEJ5SWQgPSBudWxsO1xuICAgICAgaWYgKGNoYW5nZWRCeUlkKSB7XG4gICAgICAgIGNvbnN0IGNoYW5nZWRCeVVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IGNoYW5nZWRCeUlkIH0gfSk7XG4gICAgICAgIGlmIChjaGFuZ2VkQnlVc2VyKSB7XG4gICAgICAgICAgdmFsaWRDaGFuZ2VkQnlJZCA9IGNoYW5nZWRCeUlkO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fTtcbiAgICAgIGNvbnN0IGhpc3RvcnlFbnRyaWVzID0gW107XG5cbiAgICAgIC8vIEhhbmRsZSB2aXNpYmlsaXR5IGNoYW5nZVxuICAgICAgaWYgKGlzVmlzaWJsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHVwZGF0ZURhdGEuaXNWaXNpYmxlID0gaXNWaXNpYmxlO1xuICAgICAgICBpZiAodmFsaWRDaGFuZ2VkQnlJZCkge1xuICAgICAgICAgIGhpc3RvcnlFbnRyaWVzLnB1c2goe1xuICAgICAgICAgICAgc3RhZ2VJZCxcbiAgICAgICAgICAgIGFjdGlvbjogaXNWaXNpYmxlID8gJ1NUQUdFX0VOQUJMRUQnIDogJ1NUQUdFX0hJRERFTicsXG4gICAgICAgICAgICBub3RlczogaXNWaXNpYmxlID8gJ1N0YWdlIGVuYWJsZWQgYW5kIHZpc2libGUgdG8gYXV0aG9yJyA6ICdTdGFnZSBoaWRkZW4gZnJvbSBhdXRob3IgdmlldycsXG4gICAgICAgICAgICBjaGFuZ2VkQnlJZDogdmFsaWRDaGFuZ2VkQnlJZCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBIYW5kbGUgc3RhdHVzIGNoYW5nZVxuICAgICAgaWYgKHN0YXR1cyAhPT0gdW5kZWZpbmVkICYmIHN0YXR1cyAhPT0gY3VycmVudFN0YWdlLnN0YXR1cykge1xuICAgICAgICB1cGRhdGVEYXRhLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB0aW1lc3RhbXBzIGJhc2VkIG9uIHN0YXR1c1xuICAgICAgICBpZiAoc3RhdHVzID09PSAnSU5fUFJPR1JFU1MnICYmICFjdXJyZW50U3RhZ2Uuc3RhcnRlZEF0KSB7XG4gICAgICAgICAgdXBkYXRlRGF0YS5zdGFydGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdDT01QTEVURUQnIHx8IHN0YXR1cyA9PT0gJ0FQUFJPVkVEJykge1xuICAgICAgICAgIHVwZGF0ZURhdGEuY29tcGxldGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlc2V0IGNvbXBsZXRlZEF0IGlmIG1vdmluZyBiYWNrIHRvIGluLXByb2dyZXNzIHN0YXR1c2VzXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdJTl9QUk9HUkVTUycgfHwgc3RhdHVzID09PSAnUEVORElORycgfHwgc3RhdHVzID09PSAnUVVFUllfUkFJU0VEJykge1xuICAgICAgICAgIHVwZGF0ZURhdGEuY29tcGxldGVkQXQgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbGlkQ2hhbmdlZEJ5SWQpIHtcbiAgICAgICAgICBoaXN0b3J5RW50cmllcy5wdXNoKHtcbiAgICAgICAgICAgIHN0YWdlSWQsXG4gICAgICAgICAgICBhY3Rpb246ICdTVEFUVVNfQ0hBTkdFJyxcbiAgICAgICAgICAgIGZyb21TdGF0dXM6IGN1cnJlbnRTdGFnZS5zdGF0dXMsXG4gICAgICAgICAgICB0b1N0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgY2hhbmdlZEJ5SWQ6IHZhbGlkQ2hhbmdlZEJ5SWQsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gSGFuZGxlIGFzc2lnbm1lbnQgY2hhbmdlXG4gICAgICBpZiAoYXNzaWduZWRUb0lkICE9PSB1bmRlZmluZWQgJiYgYXNzaWduZWRUb0lkICE9PSBjdXJyZW50U3RhZ2UuYXNzaWduZWRUb0lkKSB7XG4gICAgICAgIHVwZGF0ZURhdGEuYXNzaWduZWRUb0lkID0gYXNzaWduZWRUb0lkIHx8IG51bGw7XG4gICAgICAgIGlmICh2YWxpZENoYW5nZWRCeUlkKSB7XG4gICAgICAgICAgaGlzdG9yeUVudHJpZXMucHVzaCh7XG4gICAgICAgICAgICBzdGFnZUlkLFxuICAgICAgICAgICAgYWN0aW9uOiAnQVNTSUdORUQnLFxuICAgICAgICAgICAgZnJvbVVzZXJJZDogY3VycmVudFN0YWdlLmFzc2lnbmVkVG9JZCxcbiAgICAgICAgICAgIHRvVXNlcklkOiBhc3NpZ25lZFRvSWQgfHwgbnVsbCxcbiAgICAgICAgICAgIGNoYW5nZWRCeUlkOiB2YWxpZENoYW5nZWRCeUlkLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEhhbmRsZSBub3Rlc1xuICAgICAgaWYgKG5vdGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXBkYXRlRGF0YS5ub3RlcyA9IG5vdGVzO1xuICAgICAgICBpZiAobm90ZXMgJiYgbm90ZXMgIT09IGN1cnJlbnRTdGFnZS5ub3RlcyAmJiB2YWxpZENoYW5nZWRCeUlkKSB7XG4gICAgICAgICAgaGlzdG9yeUVudHJpZXMucHVzaCh7XG4gICAgICAgICAgICBzdGFnZUlkLFxuICAgICAgICAgICAgYWN0aW9uOiAnTk9URV9BRERFRCcsXG4gICAgICAgICAgICBub3Rlczogbm90ZXMsXG4gICAgICAgICAgICBjaGFuZ2VkQnlJZDogdmFsaWRDaGFuZ2VkQnlJZCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBIYW5kbGUgZmlsZSBsaW5rXG4gICAgICBpZiAoZmlsZUxpbmsgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB1cGRhdGVEYXRhLmZpbGVMaW5rID0gZmlsZUxpbmsgfHwgbnVsbDtcbiAgICAgICAgaWYgKHZhbGlkQ2hhbmdlZEJ5SWQpIHtcbiAgICAgICAgICBoaXN0b3J5RW50cmllcy5wdXNoKHtcbiAgICAgICAgICAgIHN0YWdlSWQsXG4gICAgICAgICAgICBhY3Rpb246ICdGSUxFX0FEREVEJyxcbiAgICAgICAgICAgIG5vdGVzOiBmaWxlTGluayA/IGBGaWxlIGxpbmsgYWRkZWQ6ICR7ZmlsZUxpbmt9YCA6ICdGaWxlIGxpbmsgcmVtb3ZlZCcsXG4gICAgICAgICAgICBjaGFuZ2VkQnlJZDogdmFsaWRDaGFuZ2VkQnlJZCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBIYW5kbGUgZHVlIGRhdGVcbiAgICAgIGlmIChkdWVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXBkYXRlRGF0YS5kdWVEYXRlID0gZHVlRGF0ZSA/IG5ldyBEYXRlKGR1ZURhdGUpIDogbnVsbDtcbiAgICAgICAgaWYgKHZhbGlkQ2hhbmdlZEJ5SWQpIHtcbiAgICAgICAgICBoaXN0b3J5RW50cmllcy5wdXNoKHtcbiAgICAgICAgICAgIHN0YWdlSWQsXG4gICAgICAgICAgICBhY3Rpb246ICdEVUVfREFURV9TRVQnLFxuICAgICAgICAgICAgbm90ZXM6IGR1ZURhdGUgPyBgRHVlIGRhdGUgc2V0IHRvICR7bmV3IERhdGUoZHVlRGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YCA6ICdEdWUgZGF0ZSByZW1vdmVkJyxcbiAgICAgICAgICAgIGNoYW5nZWRCeUlkOiB2YWxpZENoYW5nZWRCeUlkLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSBzdGFnZSAoZXZlbiBpZiBubyBoaXN0b3J5IGVudHJpZXMpXG4gICAgICBjb25zdCB1cGRhdGVkU3RhZ2UgPSBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1N0YWdlLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBzdGFnZUlkIH0sXG4gICAgICAgIGRhdGE6IHVwZGF0ZURhdGEsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBhc3NpZ25lZFRvOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9IH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXRlIGhpc3RvcnkgZW50cmllcyBvbmx5IGlmIHdlIGhhdmUgdmFsaWQgZW50cmllc1xuICAgICAgaWYgKGhpc3RvcnlFbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1N0YWdlSGlzdG9yeS5jcmVhdGVNYW55KHtcbiAgICAgICAgICAgIGRhdGE6IGhpc3RvcnlFbnRyaWVzLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChoaXN0b3J5RXJyb3IpIHtcbiAgICAgICAgICAvLyBIaXN0b3J5IGNyZWF0aW9uIGZhaWxlZCBidXQgc3RhZ2Ugd2FzIHVwZGF0ZWQgLSBsb2cgYnV0IGRvbid0IGZhaWxcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIHN0YWdlIGhpc3Rvcnk6JywgaGlzdG9yeUVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdGFnZTogdXBkYXRlZFN0YWdlIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIFBBQ0tBR0VTIFBVVCBST1VURVMgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIFBVVCAvYXBpL2FkbWluL3BhY2thZ2VzL1tpZF0gLSBVcGRhdGUgcGFja2FnZVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9wYWNrYWdlcy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICBjb25zdCBwYWNrYWdlSWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCBwcmljZSwgZmVhdHVyZXMsIGlzUG9wdWxhciwgaXNBY3RpdmUsIHNvcnRPcmRlciB9ID0gYm9keTtcblxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9O1xuICAgICAgaWYgKG5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5uYW1lID0gbmFtZTtcbiAgICAgIGlmIChkZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICBpZiAocHJpY2UgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5wcmljZSA9IHByaWNlO1xuICAgICAgaWYgKGZlYXR1cmVzICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZmVhdHVyZXMgPSBmZWF0dXJlcztcbiAgICAgIGlmIChpc1BvcHVsYXIgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc1BvcHVsYXIgPSBpc1BvcHVsYXI7XG4gICAgICBpZiAoaXNBY3RpdmUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5pc0FjdGl2ZSA9IGlzQWN0aXZlO1xuICAgICAgaWYgKHNvcnRPcmRlciAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnNvcnRPcmRlciA9IHNvcnRPcmRlcjtcblxuICAgICAgY29uc3QgcGtnID0gYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdQYWNrYWdlLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwYWNrYWdlSWQgfSxcbiAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBwYWNrYWdlOiBwa2cgfSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGJsb2cgcG9zdCAoYWRtaW4pXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2FkbWluL2Jsb2cvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgcG9zdElkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3Qge1xuICAgICAgICB0aXRsZSxcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgZXhjZXJwdCxcbiAgICAgICAgY292ZXJJbWFnZSxcbiAgICAgICAgYXV0aG9yTmFtZSxcbiAgICAgICAgY2F0ZWdvcnk6IGJsb2dDYXRlZ29yeSxcbiAgICAgICAgdGFncyxcbiAgICAgICAgaXNQdWJsaXNoZWQsXG4gICAgICAgIGxpbmtlZEJvb2tJZCxcbiAgICAgICAgc2VvVGl0bGUsXG4gICAgICAgIHNlb0Rlc2MsXG4gICAgICB9ID0gYm9keTtcblxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHt9O1xuICAgICAgaWYgKHRpdGxlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEudGl0bGUgPSB0aXRsZTtcbiAgICAgIGlmIChjb250ZW50ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY29udGVudCA9IGNvbnRlbnQ7XG4gICAgICBpZiAoZXhjZXJwdCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmV4Y2VycHQgPSBleGNlcnB0O1xuICAgICAgaWYgKGNvdmVySW1hZ2UgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jb3ZlckltYWdlID0gY292ZXJJbWFnZTtcbiAgICAgIGlmIChhdXRob3JOYW1lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuYXV0aG9yTmFtZSA9IGF1dGhvck5hbWU7XG4gICAgICBpZiAoYmxvZ0NhdGVnb3J5ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY2F0ZWdvcnkgPSBibG9nQ2F0ZWdvcnk7XG4gICAgICBpZiAodGFncyAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLnRhZ3MgPSBBcnJheS5pc0FycmF5KHRhZ3MpID8gdGFncyA6IHRhZ3M/LnNwbGl0KCcsJykubWFwKHQgPT4gdC50cmltKCkpO1xuICAgICAgaWYgKGxpbmtlZEJvb2tJZCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmxpbmtlZEJvb2tJZCA9IGxpbmtlZEJvb2tJZCB8fCBudWxsO1xuICAgICAgaWYgKHNlb1RpdGxlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2VvVGl0bGUgPSBzZW9UaXRsZTtcbiAgICAgIGlmIChzZW9EZXNjICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuc2VvRGVzYyA9IHNlb0Rlc2M7XG5cbiAgICAgIC8vIEhhbmRsZSBwdWJsaXNoaW5nXG4gICAgICBpZiAoaXNQdWJsaXNoZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB1cGRhdGVEYXRhLmlzUHVibGlzaGVkID0gaXNQdWJsaXNoZWQ7XG4gICAgICAgIGlmIChpc1B1Ymxpc2hlZCkge1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nUG9zdCA9IGF3YWl0IHByaXNtYS5ibG9nUG9zdC5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IHBvc3RJZCB9IH0pO1xuICAgICAgICAgIGlmICghZXhpc3RpbmdQb3N0LnB1Ymxpc2hlZEF0KSB7XG4gICAgICAgICAgICB1cGRhdGVEYXRhLnB1Ymxpc2hlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IHByaXNtYS5ibG9nUG9zdC51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogcG9zdElkIH0sXG4gICAgICAgIGRhdGE6IHVwZGF0ZURhdGEsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcG9zdCB9KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgdXNlciBibG9nIHdyaXRlciBzdGF0dXMgKGFkbWluKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi91c2Vycy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSA0ICYmIHBhdGhTZWdtZW50c1szXSA9PT0gJ2Jsb2ctd3JpdGVyJykge1xuICAgICAgY29uc3QgdXNlcklkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgY29uc3QgeyBpc0Jsb2dXcml0ZXIgfSA9IGJvZHk7XG5cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogdXNlcklkIH0sXG4gICAgICAgIGRhdGE6IHsgaXNCbG9nV3JpdGVyOiBpc0Jsb2dXcml0ZXIgPT09IHRydWUgfSxcbiAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBlbWFpbDogdHJ1ZSwgaXNCbG9nV3JpdGVyOiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgdXNlciB9KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgYm9va1xuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9ib29rcy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBib29rSWQgPSBwYXRoU2VnbWVudHNbMV07XG5cbiAgICAgIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogYm9va0lkIH0sXG4gICAgICAgIGRhdGE6IGJvZHksXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYm9vayB9KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgc3RhZ2VcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvc3RhZ2VzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgIGNvbnN0IHN0YWdlSWQgPSBwYXRoU2VnbWVudHNbMV07XG5cbiAgICAgIGNvbnN0IHN0YWdlID0gYXdhaXQgcHJpc21hLnB1Ymxpc2hpbmdTdGFnZS51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogc3RhZ2VJZCB9LFxuICAgICAgICBkYXRhOiBib2R5LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN0YWdlIH0pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBxdWVyeVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9xdWVyaWVzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgIGNvbnN0IHF1ZXJ5SWQgPSBwYXRoU2VnbWVudHNbMV07XG5cbiAgICAgIGNvbnN0IHF1ZXJ5ID0gYXdhaXQgcHJpc21hLnF1ZXJ5LnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBxdWVyeUlkIH0sXG4gICAgICAgIGRhdGE6IGJvZHksXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcXVlcnkgfSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGxlYWRcbiAgICBpZiAocGF0aC5zdGFydHNXaXRoKCcvbGVhZHMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgbGVhZElkID0gcGF0aFNlZ21lbnRzWzFdO1xuXG4gICAgICBjb25zdCBsZWFkID0gYXdhaXQgcHJpc21hLmxlYWQudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGxlYWRJZCB9LFxuICAgICAgICBkYXRhOiBib2R5LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGxlYWQgfSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIG9yZGVyIHN0YXR1cyAoYWRtaW4pXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL29yZGVycy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBvcmRlcklkID0gcGF0aFNlZ21lbnRzWzFdO1xuXG4gICAgICBjb25zdCBvcmRlciA9IGF3YWl0IHByaXNtYS5vcmRlci51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogb3JkZXJJZCB9LFxuICAgICAgICBkYXRhOiBib2R5LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9yZGVyIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBQVVQgRXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUocmVxdWVzdCwgY29udGV4dCkge1xuICBjb25zdCBwYXJhbXMgPSBhd2FpdCBjb250ZXh0LnBhcmFtcztcbiAgY29uc3QgcGF0aFNlZ21lbnRzID0gcGFyYW1zPy5wYXRoIHx8IFtdO1xuICBjb25zdCBwYXRoID0gJy8nICsgcGF0aFNlZ21lbnRzLmpvaW4oJy8nKTtcblxuICB0cnkge1xuICAgIC8vIERlbGV0ZSBjYXRlZ29yeSAoYWRtaW4pXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2FkbWluL2NhdGVnb3JpZXMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgY2F0ZWdvcnlJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgY2F0ZWdvcnkgaGFzIGJvb2tzXG4gICAgICBjb25zdCBib29rQ291bnQgPSBhd2FpdCBwcmlzbWEuYm9va0NhdGVnb3J5LmNvdW50KHtcbiAgICAgICAgd2hlcmU6IHsgY2F0ZWdvcnlJZCB9LFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmIChib29rQ291bnQgPiAwKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeSB3aXRoIGFzc29jaWF0ZWQgYm9va3MnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGF3YWl0IHByaXNtYS5jYXRlZ29yeS5kZWxldGUoeyB3aGVyZTogeyBpZDogY2F0ZWdvcnlJZCB9IH0pO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBEZWxldGUgc3RhZ2UgdGVtcGxhdGUgKHNvZnQgZGVsZXRlIC0gc2V0IGlzQWN0aXZlIHRvIGZhbHNlKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9zdGFnZS10ZW1wbGF0ZXMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgdGVtcGxhdGVJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIFxuICAgICAgYXdhaXQgcHJpc21hLnN0YWdlVGVtcGxhdGUudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHRlbXBsYXRlSWQgfSxcbiAgICAgICAgZGF0YTogeyBpc0FjdGl2ZTogZmFsc2UgfSxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIC8vIERlbGV0ZSBzdGFnZSBmcm9tIGEgYm9va1xuICAgIGlmIChwYXRoLm1hdGNoKC9cXC9hZG1pblxcL2Jvb2tzXFwvW14vXStcXC9zdGFnZXNcXC9bXi9dKyQvKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSA1KSB7XG4gICAgICBjb25zdCBib29rSWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBjb25zdCBzdGFnZUlkID0gcGF0aFNlZ21lbnRzWzRdO1xuICAgICAgXG4gICAgICBjb25zdCBzdGFnZSA9IGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nU3RhZ2UuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBzdGFnZUlkIH0gfSk7XG4gICAgICBpZiAoIXN0YWdlIHx8IHN0YWdlLmJvb2tJZCAhPT0gYm9va0lkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU3RhZ2Ugbm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBEb24ndCBhbGxvdyBkZWxldGluZyBjb21wbGV0ZWQgb3IgbG9ja2VkIHN0YWdlc1xuICAgICAgaWYgKHN0YWdlLmlzTG9ja2VkIHx8IHN0YWdlLnN0YXR1cyA9PT0gJ0NPTVBMRVRFRCcgfHwgc3RhZ2Uuc3RhdHVzID09PSAnQVBQUk9WRUQnKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBhIGNvbXBsZXRlZCBvciBsb2NrZWQgc3RhZ2UnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGF3YWl0IHByaXNtYS5wdWJsaXNoaW5nU3RhZ2UuZGVsZXRlKHsgd2hlcmU6IHsgaWQ6IHN0YWdlSWQgfSB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gRGVsZXRlIGJsb2cgcG9zdCAoYWRtaW4pXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2FkbWluL2Jsb2cvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgY29uc3QgcG9zdElkID0gcGF0aFNlZ21lbnRzWzJdO1xuICAgICAgYXdhaXQgcHJpc21hLmJsb2dQb3N0LmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBwb3N0SWQgfSB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gRGVsZXRlIGJsb2cgY29tbWVudCAoYWRtaW4pXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2FkbWluL2Jsb2cvY29tbWVudHMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gNCkge1xuICAgICAgY29uc3QgY29tbWVudElkID0gcGF0aFNlZ21lbnRzWzNdO1xuICAgICAgYXdhaXQgcHJpc21hLmJsb2dDb21tZW50LmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBjb21tZW50SWQgfSB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gRGVsZXRlIGd1ZXN0IHBvc3QgKGFkbWluKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9ndWVzdC1wb3N0cy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICBjb25zdCBndWVzdFBvc3RJZCA9IHBhdGhTZWdtZW50c1syXTtcbiAgICAgIGF3YWl0IHByaXNtYS5ndWVzdFBvc3QuZGVsZXRlKHsgd2hlcmU6IHsgaWQ6IGd1ZXN0UG9zdElkIH0gfSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09IEFETUlOIERFTEVURSBST1VURVMgPT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIERFTEVURSAvYXBpL2FkbWluL3VzZXJzL1tpZF0gLSBEZWxldGUgdXNlciAoc29mdCBkZWxldGUgYnkgZGVhY3RpdmF0aW5nKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi91c2Vycy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICBjb25zdCB1c2VySWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICAvLyBTb2Z0IGRlbGV0ZSAtIGp1c3QgZGVhY3RpdmF0ZVxuICAgICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgICBkYXRhOiB7IGlzQWN0aXZlOiBmYWxzZSB9LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIC8vIERFTEVURSAvYXBpL2FkbWluL29yZGVycy9zdGFnZXMvW2lkXSAtIERlbGV0ZSBvcmRlciBzdGFnZVxuICAgIGlmIChwYXRoLm1hdGNoKC9eXFwvYWRtaW5cXC9vcmRlcnNcXC9zdGFnZXNcXC9bXi9dKyQvKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSA0KSB7XG4gICAgICBjb25zdCBzdGFnZUlkID0gcGF0aFNlZ21lbnRzWzNdO1xuICAgICAgYXdhaXQgcHJpc21hLm9yZGVyU3RhZ2UudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHN0YWdlSWQgfSxcbiAgICAgICAgZGF0YTogeyBpc0FjdGl2ZTogZmFsc2UgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBERUxFVEUgL2FwaS9hZG1pbi9wYWNrYWdlcy9baWRdIC0gRGVsZXRlIHBhY2thZ2UgKHNvZnQgZGVsZXRlKVxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9hZG1pbi9wYWNrYWdlcy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICBjb25zdCBwYWNrYWdlSWQgPSBwYXRoU2VnbWVudHNbMl07XG4gICAgICBhd2FpdCBwcmlzbWEucHVibGlzaGluZ1BhY2thZ2UudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHBhY2thZ2VJZCB9LFxuICAgICAgICBkYXRhOiB7IGlzQWN0aXZlOiBmYWxzZSB9LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIC8vIERlbGV0ZSBib29rXG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL2Jvb2tzLycpICYmIHBhdGhTZWdtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgIGNvbnN0IGJvb2tJZCA9IHBhdGhTZWdtZW50c1sxXTtcbiAgICAgIGF3YWl0IHByaXNtYS5ib29rLmRlbGV0ZSh7IHdoZXJlOiB7IGlkOiBib29rSWQgfSB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLy8gRGVsZXRlIHF1ZXJ5XG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnL3F1ZXJpZXMvJykgJiYgcGF0aFNlZ21lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgcXVlcnlJZCA9IHBhdGhTZWdtZW50c1sxXTtcbiAgICAgIGF3YWl0IHByaXNtYS5xdWVyeS5kZWxldGUoeyB3aGVyZTogeyBpZDogcXVlcnlJZCB9IH0pO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICAvLyBEZWxldGUgbGVhZFxuICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoJy9sZWFkcy8nKSAmJiBwYXRoU2VnbWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBsZWFkSWQgPSBwYXRoU2VnbWVudHNbMV07XG4gICAgICBhd2FpdCBwcmlzbWEubGVhZC5kZWxldGUoeyB3aGVyZTogeyBpZDogbGVhZElkIH0gfSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTm90IGZvdW5kJyB9LCB7IHN0YXR1czogNDA0IH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBERUxFVEUgRXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0U2VydmVyU2Vzc2lvbiIsImJjcnlwdCIsInY0IiwidXVpZHY0IiwicHJpc21hIiwiaXNSYXpvcnBheUNvbmZpZ3VyZWQiLCJjcmVhdGVPcmRlciIsInZlcmlmeVBheW1lbnRTaWduYXR1cmUiLCJ2ZXJpZnlXZWJob29rU2lnbmF0dXJlIiwiZ2V0U2V0dGluZyIsImdldFNldHRpbmdzIiwiZ2V0U2V0dGluZ3NCeUNhdGVnb3J5Iiwic2V0U2V0dGluZyIsInN5bmNMZWFkVG9TaGVldHMiLCJzeW5jQW50aG9sb2d5VG9TaGVldHMiLCJnZW5lcmF0ZUF1dGhvclVpZCIsImVuc3VyZUF1dGhvclVpZCIsImdldE9yQ3JlYXRlQXV0aG9yQnlFbWFpbCIsImxpbmtBdXRob3JzVG9Cb29rIiwiZ2V0Um95YWx0eUJ1Y2tldCIsImdldFNlc3Npb24iLCJyZXF1ZXN0IiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJnZXQiLCJzdGFydHNXaXRoIiwiY2hlY2tSb2xlIiwidXNlclJvbGUiLCJhbGxvd2VkUm9sZXMiLCJpbmNsdWRlcyIsImdlbmVyYXRlT3JkZXJOdW1iZXIiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJ0b1VwcGVyQ2FzZSIsInJhbmRvbSIsIk1hdGgiLCJzdWJzdHJpbmciLCJQVUJMSVNISU5HX1NUQUdFUyIsInR5cGUiLCJvcmRlciIsIkdFVCIsImNvbnRleHQiLCJwYXJhbXMiLCJwYXRoU2VnbWVudHMiLCJwYXRoIiwiam9pbiIsImpzb24iLCJzdGF0dXMiLCJ0b0lTT1N0cmluZyIsImRhdGFiYXNlIiwicmF6b3JwYXkiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJpc1B1YmxpYyIsImF1dGhvcklkIiwid2hlcmUiLCJpc0F1dGhvckNvcHkiLCJib29rcyIsImJvb2siLCJmaW5kTWFueSIsImluY2x1ZGUiLCJhdXRob3IiLCJzZWxlY3QiLCJpZCIsIm5hbWUiLCJwdWJsaWNVcmwiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwibGVuZ3RoIiwiYm9va0lkIiwiZmluZFVuaXF1ZSIsImJpbyIsInB1Ymxpc2hpbmdTdGFnZXMiLCJzdGFnZU9yZGVyIiwiZmlsZXMiLCJtYW51c2NyaXB0cyIsInZlcnNpb24iLCJlcnJvciIsInRha2UiLCJleHRlcm5hbExpbmtzIiwidGhpcnR5RGF5c0FnbyIsInNldERhdGUiLCJnZXREYXRlIiwicm95YWx0aWVzIiwicm95YWx0eSIsImd0ZSIsInRpdGxlIiwibW9udGhseVN1bW1hcnkiLCJncm91cEJ5IiwiYnkiLCJfc3VtIiwiYW1vdW50Iiwic2FsZUFtb3VudCIsIl9jb3VudCIsInVucGFpZFJveWFsdGllcyIsImFnZ3JlZ2F0ZSIsImlzUGFpZCIsInJlY2VudFJveWFsdGllcyIsInVucGFpZFRvdGFsIiwib3JkZXJzIiwidXNlcklkIiwiaXRlbXMiLCJjb3ZlckltYWdlIiwicXVlcmllcyIsInF1ZXJ5Iiwic3RhZ2UiLCJzdGFnZVR5cGUiLCJjb21tZW50cyIsIm5vdGlmaWNhdGlvbnMiLCJub3RpZmljYXRpb24iLCJ1bnJlYWRDb3VudCIsImNvdW50IiwiaXNSZWFkIiwidXNlciIsImVtYWlsIiwicGhvbmUiLCJyb2xlIiwicHJvZmlsZUltYWdlIiwid2Vic2l0ZSIsInNvY2lhbExpbmtzIiwiYmFua0RldGFpbHMiLCJkZXNjcmlwdGlvbiIsInByaWNlIiwicHVibGlzaGVkRGF0ZSIsImF1dGhvclVpZCIsImFzc2lnbmVkVG8iLCJoaXN0b3J5IiwiY2hhbmdlZEJ5IiwiaXNiblN0YXR1cyIsImlzYm5QYXBlcmJhY2siLCJ0b3RhbFN0YWdlcyIsImNvbXBsZXRlZFN0YWdlcyIsImZpbHRlciIsInMiLCJwcm9ncmVzc1BlcmNlbnQiLCJyb3VuZCIsImN1cnJlbnRTdGFnZSIsImZpbmQiLCJtZXRhIiwidGVhbSIsImluIiwiaXNBY3RpdmUiLCJ0ZW1wbGF0ZXMiLCJzdGFnZVRlbXBsYXRlIiwic29ydE9yZGVyIiwiZGVmYXVsdFN0YWdlcyIsImlzRGVmYXVsdCIsImNyZWF0ZU1hbnkiLCJkYXRhIiwic3RhdHVzRmlsdGVyIiwiZGF0ZUZyb20iLCJkYXRlVG8iLCJhc3NpZ25lZFRvSWQiLCJub3RJbiIsImx0ZSIsImxlYWRzIiwibGVhZCIsImFjdGl2aXRpZXMiLCJub3RlcyIsInN0YWdlSGlzdG9yeSIsIm1vdmVkQXQiLCJtYXBwZWRMZWFkcyIsIm1hcCIsImFsbExlYWRzIiwic3VtbWFyeSIsInRvdGFsIiwibmV3IiwibCIsImNvbnRhY3RlZCIsImludGVyZXN0ZWQiLCJuZWdvdGlhdGluZyIsImNvbnZlcnRlZCIsImxvc3QiLCJzdGFnZXNTZXR0aW5nIiwic2l0ZVNldHRpbmciLCJrZXkiLCJjb2xvciIsInN0YWdlcyIsInZhbHVlIiwiYWxsU2V0dGluZ3MiLCJzZXR0aW5ncyIsImNhdGVnb3JpZXMiLCJjYXRlZ29yeSIsImNoaWxkcmVuIiwidG9wTGV2ZWwiLCJjIiwicGFyZW50SWQiLCJ0b3RhbEJvb2tzIiwidG90YWxBdXRob3JzIiwidG90YWxPcmRlcnMiLCJwZW5kaW5nUXVlcmllcyIsIm5ld0xlYWRzIiwiUHJvbWlzZSIsImFsbCIsImJvb2tzQnlTdGF0dXMiLCJyZWNlbnRPcmRlcnMiLCJzZWFyY2giLCJwYWdlIiwicGFyc2VJbnQiLCJsaW1pdCIsInNraXAiLCJPUiIsImNvbnRhaW5zIiwibW9kZSIsInVzZXJzIiwiaXNCbG9nV3JpdGVyIiwiaW1wb3J0U291cmNlIiwiYm9va0F1dGhvcnNoaXBzIiwidXNlcnNXaXRoUm95YWx0aWVzIiwicm95YWx0eUFnZyIsInBhaWRBZ2ciLCJ0b3RhbFJveWFsdHkiLCJwYWlkUm95YWx0eSIsInVucGFpZFJveWFsdHkiLCJwYWdpbmF0aW9uIiwidG90YWxQYWdlcyIsImNlaWwiLCJwYXNzd29yZCIsIl8iLCJ1c2VyV2l0aG91dFBhc3N3b3JkIiwib3JkZXJOdW1iZXIiLCJzaGlwcGluZ05hbWUiLCJzaGlwcGluZ0VtYWlsIiwib3JkZXJTdGFnZSIsIm9yZGVySWQiLCJwZXJpb2QiLCJidWNrZXQiLCJhZ2dyZWdhdGVzIiwiYWNjb3VudE51bWJlciIsImlmc2NDb2RlIiwiYWNjb3VudE5hbWUiLCJiYW5rTmFtZSIsImlzYm4iLCJpc2JuSGFyZGNvdmVyIiwidG90YWxBbW91bnQiLCJ0b3RhbFNhbGVzIiwicGFpZEFtb3VudCIsInBlbmRpbmdBbW91bnQiLCJwZXJpb2RzIiwicCIsImF1dGhvcklkcyIsInIiLCJhdXRob3JzIiwiYXV0aG9yc01hcCIsIk1hcCIsImEiLCJyb3lhbHRpZXNCeUF1dGhvciIsInBhY2thZ2VzIiwicHVibGlzaGluZ1BhY2thZ2UiLCJwYWNrYWdlSWQiLCJwa2ciLCJwYWNrYWdlIiwiaXNQdWJsaXNoZWQiLCJwb3N0cyIsImJsb2dQb3N0IiwicHVibGlzaGVkQXQiLCJjb25maWd1cmVkIiwibWVzc2FnZSIsInNlcnZpY2VUeXBlIiwiYWRkT25zIiwic2VydmljZUFkZE9uIiwiZGlzcGxheU9uIiwiZmVhdHVyZWQiLCJpc0FwcHJvdmVkIiwiaXNGZWF0dXJlZCIsInJldmlld3MiLCJyZXZpZXciLCJkaXNwbGF5cyIsInR3ZW50eUZvdXJIb3Vyc0FnbyIsImFudGhvbG9neVN1Ym1pc3Npb24iLCJjb2RlIiwiYXBwbGllc1RvIiwiZGlzY291bnQiLCJ2YWxpZCIsImV4cGlyZXNBdCIsIm1heFVzZXMiLCJ1c2VkQ291bnQiLCJkaXNjb3VudHMiLCJzaG93UmVjZW50UmVsZWFzZXMiLCJzaG93QmVzdFNlbGxlcnMiLCJiZXN0U2VsbGVyc01vZGUiLCJzaG93TGl2ZUNvdW50ZXIiLCJwdWJsaXNoaW5nU3RlcHMiLCJyZWNlbnRSZWxlYXNlcyIsImdlbnJlIiwiYmVzdFNlbGxlcnMiLCJpc0Jlc3RTZWxsZXIiLCJiZXN0U2VsbGVyTWFudWFsIiwic2FsZXNDb3VudCIsImJvb2tzUHVibGlzaGVkIiwic2x1ZyIsImV4Y2VycHQiLCJhdXRob3JOYW1lIiwidGFncyIsInZpZXdzIiwibGlrZXMiLCJwb3N0IiwidXBkYXRlIiwiaW5jcmVtZW50IiwibGlua2VkQm9vayIsImxpbmtlZEJvb2tJZCIsIm5vdCIsImFwcHJvdmVkIiwiYmxvZ0NvbW1lbnQiLCJwb3N0SWQiLCJndWVzdFBvc3RzIiwiZ3Vlc3RQb3N0IiwiZ2V0VGltZSIsInRvZGF5Iiwic3VibWlzc2lvbnMiLCJmaWx0ZXJlZEJvb2tzIiwiYXV0aG9ySWRQYXJhbSIsIm1hbnVzY3JpcHQiLCJ1cGRhdGVkQXQiLCJieVBlcmlvZCIsInJlZHVjZSIsImFjYyIsInBhaWQiLCJwZW5kaW5nIiwicHVzaCIsImxhc3QzMERheXMiLCJieURheSIsImRheSIsInNwbGl0Iiwic3VtIiwiYnlCdWNrZXQiLCJXRUJTSVRFIiwiRUJPT0siLCJFQ09NTUVSQ0UiLCJwcm9maWxlIiwiYWx0ZXJuYXRlRW1haWwiLCJhbHRlcm5hdGVQaG9uZSIsImVtYWlsTm90aWZpY2F0aW9ucyIsInN0YWdlVXBkYXRlcyIsInF1ZXJ5UmVzcG9uc2VzIiwicm95YWx0eUFsZXJ0cyIsIm1hcmtldGluZ0VtYWlscyIsImZpbmRGaXJzdCIsInNhbGVzIiwic2FsZSIsInJveWFsdHlDb25maWdzIiwic2FsZURhdGUiLCJ0b3RhbFVuaXRzIiwicXVhbnRpdHkiLCJ0b3RhbFJveWFsdGllcyIsInBlbmRpbmdSb3lhbHRpZXMiLCJwYWlkUm95YWx0aWVzIiwiaXNQYWlkRmlsdGVyIiwicGxhdGZvcm0iLCJtYXRjaCIsImNvbmZpZ3MiLCJib29rUm95YWx0eUNvbmZpZyIsImNvbnRlbnRzIiwic2l0ZUNvbnRlbnQiLCJpbXBvcnRzIiwiaW1wb3J0QmF0Y2giLCJjb25zb2xlIiwiZGV0YWlscyIsIlBPU1QiLCJmb3JtRGF0YSIsImZpbGUiLCJ2YWxpZFR5cGVzIiwic2l6ZSIsImxhdGVzdE1hbnVzY3JpcHQiLCJmaWxlSWQiLCJleHQiLCJwb3AiLCJzYWZlRmlsZU5hbWUiLCJmaWxlVXJsIiwiZnMiLCJyZXF1aXJlIiwicGF0aE1vZHVsZSIsInVwbG9hZHNEaXIiLCJwcm9jZXNzIiwiY3dkIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJhcnJheUJ1ZmZlciIsIndyaXRlRmlsZVN5bmMiLCJjcmVhdGUiLCJmaWxlTmFtZSIsImZpbGVTaXplIiwiZmlsZVR5cGUiLCJpc1dvcmRVcGxvYWQiLCJib2R5IiwiZSIsImV4aXN0aW5nVXNlciIsImhhc2hlZFBhc3N3b3JkIiwiaGFzaCIsImJhc2VVcmwiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJjb3VudGVyIiwic3VidGl0bGUiLCJsaW5rIiwic3RhZ2VJZCIsImF1dGhvck5vdGVzIiwicHVibGlzaGluZ1N0YWdlIiwiY29tcGxldGVkQXQiLCJuZXh0U3RhZ2UiLCJzdGFydGVkQXQiLCJzdWJqZWN0IiwicHJpb3JpdHkiLCJxdWVyeUlkIiwidXNlck5hbWUiLCJjb21tZW50IiwiaXNJbnRlcm5hbCIsInF1ZXJ5Q29tbWVudCIsInNoaXBwaW5nUGhvbmUiLCJzaGlwcGluZ0FkZHJlc3MiLCJzaGlwcGluZ0NpdHkiLCJzaGlwcGluZ1N0YXRlIiwic2hpcHBpbmdaaXBDb2RlIiwic2hpcHBpbmdDb3VudHJ5Iiwib3JkZXJJdGVtcyIsIml0ZW0iLCJ1bml0UHJpY2UiLCJhdXRob3JDb3B5UHJpY2UiLCJkaXNjb3VudFByaWNlIiwiaXRlbVRvdGFsIiwidG90YWxQcmljZSIsInJhem9ycGF5T3JkZXIiLCJyYXpvcnBheU9yZGVySWQiLCJyYXpvcnBheUtleUlkIiwiZW52IiwiTkVYVF9QVUJMSUNfUkFaT1JQQVlfS0VZX0lEIiwicGF5bWVudERpc2FibGVkIiwicmF6b3JwYXlfb3JkZXJfaWQiLCJyYXpvcnBheV9wYXltZW50X2lkIiwicmF6b3JwYXlfc2lnbmF0dXJlIiwiaXNWYWxpZCIsInJhem9ycGF5UGF5bWVudElkIiwicmF6b3JwYXlTaWduYXR1cmUiLCJwYWlkQXQiLCJyb3lhbHR5UmF0ZSIsInJveWFsdHlBbW91bnQiLCJzdWNjZXNzIiwic291cmNlIiwiaW50ZXJlc3RBcmVhIiwiY3JlYXRlZEJ5SWQiLCJleGlzdGluZyIsImJyYW5jaE5hbWUiLCJ1cHNlcnQiLCJub3RpZmljYXRpb25JZHMiLCJ1cGRhdGVNYW55IiwicmVhZEF0IiwidGFyZ2V0VXNlcklkcyIsInRhcmdldEFsbCIsImN0YVRleHQiLCJ1c2VySWRzIiwiQXJyYXkiLCJpc0FycmF5IiwicmVzdWx0cyIsImsiLCJ2IiwiT2JqZWN0IiwiZW50cmllcyIsInJlc3VsdCIsInNldHRpbmciLCJtZXRhZGF0YSIsImRpc2NvdW50Q29kZSIsImFkZE9uRGV0YWlscyIsImtleXMiLCJhZGRPbklkIiwiYWRkT24iLCJhZGRPblRvdGFsIiwiYmFzZVByaWNlIiwiZGlzY291bnRBbW91bnQiLCJkaXNjb3VudFR5cGUiLCJkaXNjb3VudFZhbHVlIiwiZW5yb2xsbWVudCIsInNlcnZpY2VFbnJvbGxtZW50IiwiZmluYWxBbW91bnQiLCJtYXgiLCJwYXltZW50UmVxdWlyZWQiLCJhbnRoTmFtZSIsImFudGhQaG9uZSIsImlzV2hhdHNBcHAiLCJ3aGF0c0FwcE51bWJlciIsImFudGhFbWFpbCIsImluc3RhZ3JhbVVzZXJuYW1lIiwicG9ldHJ5VGl0bGUiLCJwb2V0cnlDb250ZW50IiwiY29udGFjdFByZWZlcmVuY2UiLCJzdWJtaXNzaW9uIiwidGVtcGxhdGUiLCJtYXhTdGFnZSIsImlzVmlzaWJsZSIsInN0YWdlSWRzIiwidmlzaWJsZSIsInVwZGF0ZWRTdGFnZSIsImlzTG9ja2VkIiwidXNlcnNEYXRhIiwiaW1wb3J0ZWRCeUlkIiwiZXJyb3JzIiwic2tpcHBlZCIsInVzZXJEYXRhIiwicmVhc29uIiwiZXhpc3RpbmdJZCIsImVyciIsInRvdGFsUm93cyIsInN1Y2Nlc3NDb3VudCIsImVycm9yQ291bnQiLCJib29rSWRzIiwibGlua2VkIiwibmV3Q29tbWVudCIsImNvbnRlbnQiLCJ1cGRhdGVkIiwidW5kZWZpbmVkIiwibWFwcGluZyIsIndhcm5pbmdzIiwidmFsaWRDb3VudCIsImkiLCJyb3ciLCJ0ZXN0IiwiYXV0aG9yUmVmIiwiaXNOYU4iLCJwYXJzZUZsb2F0Iiwic2VxIiwiYXV0aG9yVWlkU2VxdWVuY2UiLCJsYXN0VmFsdWUiLCJTdHJpbmciLCJwYWRTdGFydCIsImJhdGNoSWQiLCJkYXRlU3RyIiwiaXNiblVzZWQiLCJpbXBvcnRCYXRjaElkIiwic2xpY2UiLCJtb3ZlZEJ5SWQiLCJjdXJyZW50U3RhZ2VJZCIsIm9yZGVyU3RhZ2VIaXN0b3J5Iiwicm95YWx0eUlkcyIsInBheW1lbnRSZWYiLCJtYXJrZWRCeUlkIiwicm95YWx0aWVzVG9NYXJrIiwiYXV0aG9yR3JvdXBzIiwidG9Mb2NhbGVTdHJpbmciLCJub3RpZmllZCIsImJvb2tJZF9wbGF0Zm9ybSIsImNvbmZpZyIsInJveWFsdHlDb25maWciLCJyb3lhbHR5UGVyVW5pdCIsImhpbnQiLCJiYSIsInNoYXJlIiwicm95YWx0eVNoYXJlIiwic2FsZXNEYXRhIiwicm95YWx0aWVzR2VuZXJhdGVkIiwic2FsZUl0ZW0iLCJpc2JuRWJvb2siLCJzYWxlSWQiLCJjb250cmFjdEFtb3VudCIsImRlYWRsaW5lIiwiZGVhZGxpbmVTZXZlcml0eSIsImNsZWFuQXNzaWduZWRUb0lkIiwidHJpbSIsImNsZWFuQ3JlYXRlZEJ5SWQiLCJsZWFkTm90ZSIsImxlYWRJZCIsImNyZWF0ZWRCeU5hbWUiLCJub3RlIiwidmFsdWVzIiwiYXV0aG9yRW1haWwiLCJhbGxvd1dvcmRVcGxvYWQiLCJhdXRob3JJZGVudGlmaWVycyIsIkJvb2xlYW4iLCJwdWJsaXNoaW5nU3RhZ2VUeXBlcyIsImluZGV4IiwiYm9va3NEYXRhIiwiYm9va0RhdGEiLCJmZWF0dXJlcyIsImlzUG9wdWxhciIsImNhdE5hbWUiLCJjYXREZXNjIiwic2VvVGl0bGUiLCJzZW9EZXNjIiwiYmxvZ1RpdGxlIiwiYmxvZ0NvbnRlbnQiLCJibG9nQXV0aG9ySWQiLCJibG9nQ2F0ZWdvcnkiLCJ0IiwiY29tbWVudEF1dGhvciIsImNvbW1lbnRDb250ZW50IiwidmlzaXRvcklkIiwiZXhpc3RpbmdMaWtlIiwiYmxvZ0xpa2UiLCJwb3N0SWRfdmlzaXRvcklkIiwiZGVsZXRlIiwibGlrZWQiLCJndWVzdFRpdGxlIiwiZ3Vlc3RDb250ZW50Iiwid3JpdGVyTmFtZSIsImd1ZXN0RW1haWwiLCJndWVzdFBob25lIiwiZ3Vlc3RTb2NpYWxMaW5rcyIsImNvbW1lbnRJZCIsImd1ZXN0UG9zdElkIiwicmV2aWV3U3RhdHVzIiwicmVqZWN0UmVhc29uIiwicmV2aWV3ZWRCeSIsInJldmlld2VkQXQiLCJhZGRvbk5hbWUiLCJhZGRvbkRlc2MiLCJhZGRvblNlcnZpY2UiLCJwcmljaW5nVHlwZSIsInByaWNpbmdUaWVycyIsInJldmlld0Jvb2tJZCIsInJldmlld0F1dGhvciIsImJvb2tUaXRsZSIsInJldmlld0Jvb2tUaXRsZSIsInJhdGluZyIsInJldmlld0NvbnRlbnQiLCJkaXNjTmFtZSIsImRpc2NDb2RlIiwic3RhcnRzQXQiLCJzaG93VGltZXIiLCJQVVQiLCJ1cGRhdGVEYXRhIiwibmV3U3RhdHVzIiwiY29udmVydGVkQXQiLCJ1cGRhdGVkTGVhZCIsImNhdGVnb3J5SWQiLCJ0ZW1wbGF0ZUlkIiwic2hpcHBlZEF0IiwiZGVsaXZlcmVkQXQiLCJwYXBlcmJhY2tQcmljZSIsImhhcmRjb3ZlclByaWNlIiwiZWJvb2tQcmljZSIsImhhc1BhcGVyYmFjayIsImhhc0hhcmRjb3ZlciIsImhhc0Vib29rIiwiYXV0aG9yQ29weU1PUSIsImF1dGhvckNvcHlUaWVycyIsInNoaXBwaW5nRW5hYmxlZCIsInN0b3JlRGlzcGxheVRpdGxlIiwic3RvcmVEaXNwbGF5QXV0aG9yIiwic3RvcmVEaXNwbGF5RGVzY3JpcHRpb24iLCJzdG9yZURpc3BsYXlDb3ZlciIsImR1ZURhdGUiLCJmaWxlTGluayIsImNoYW5nZWRCeUlkIiwidmFsaWRDaGFuZ2VkQnlJZCIsImNoYW5nZWRCeVVzZXIiLCJoaXN0b3J5RW50cmllcyIsImFjdGlvbiIsImZyb21TdGF0dXMiLCJ0b1N0YXR1cyIsImZyb21Vc2VySWQiLCJ0b1VzZXJJZCIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInB1Ymxpc2hpbmdTdGFnZUhpc3RvcnkiLCJoaXN0b3J5RXJyb3IiLCJleGlzdGluZ1Bvc3QiLCJERUxFVEUiLCJib29rQ291bnQiLCJib29rQ2F0ZWdvcnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/[[...path]]/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/google-sheets.js":
/*!******************************!*\
  !*** ./lib/google-sheets.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendToSheet: () => (/* binding */ appendToSheet),\n/* harmony export */   getTodaySubmissionsCount: () => (/* binding */ getTodaySubmissionsCount),\n/* harmony export */   isSheetsConfigured: () => (/* binding */ isSheetsConfigured),\n/* harmony export */   syncAnthologyToSheets: () => (/* binding */ syncAnthologyToSheets),\n/* harmony export */   syncLeadToSheets: () => (/* binding */ syncLeadToSheets)\n/* harmony export */ });\n// Google Sheets Integration for Writer's Pocket\n// Currently mocked, designed for Google Sheets API integration\nconst SHEETS_ENABLED = process.env.GOOGLE_SHEETS_ENABLED === \"true\";\nconst SHEETS_CREDENTIALS = process.env.GOOGLE_SHEETS_CREDENTIALS;\nconst LEADS_SHEET_ID = process.env.GOOGLE_SHEETS_LEADS_ID;\nconst ANTHOLOGY_SHEET_ID = process.env.GOOGLE_SHEETS_ANTHOLOGY_ID;\n// Check if Google Sheets is configured\nfunction isSheetsConfigured() {\n    return SHEETS_ENABLED && SHEETS_CREDENTIALS && (LEADS_SHEET_ID || ANTHOLOGY_SHEET_ID);\n}\n// Append row to a sheet\nasync function appendToSheet(sheetId, sheetName, values) {\n    try {\n        if (!SHEETS_ENABLED) {\n            console.log(\"[MOCK SHEETS] Would append to sheet:\", {\n                sheetId,\n                sheetName,\n                values\n            });\n            return {\n                success: true,\n                mocked: true\n            };\n        }\n        if (!isSheetsConfigured()) {\n            console.warn(\"[SHEETS] Not configured, skipping append\");\n            return {\n                success: false,\n                error: \"Sheets not configured\"\n            };\n        }\n        // TODO: Implement actual Google Sheets API\n        // const auth = new google.auth.GoogleAuth({\n        //   credentials: JSON.parse(SHEETS_CREDENTIALS),\n        //   scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n        // });\n        // const sheets = google.sheets({ version: 'v4', auth });\n        // await sheets.spreadsheets.values.append({...});\n        console.log(\"[SHEETS] Would append row:\", {\n            sheetId,\n            sheetName,\n            rowCount: 1\n        });\n        return {\n            success: true,\n            mocked: !SHEETS_ENABLED\n        };\n    } catch (error) {\n        console.error(\"[SHEETS ERROR]\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}\n// Sync lead to Google Sheets\nasync function syncLeadToSheets(lead) {\n    const values = [\n        new Date().toISOString(),\n        lead.name,\n        lead.email,\n        lead.phone || \"\",\n        lead.source,\n        lead.interestArea || \"\",\n        lead.status,\n        lead.notes || \"\"\n    ];\n    return await appendToSheet(LEADS_SHEET_ID, \"Leads\", values);\n}\n// Sync anthology submission to Google Sheets\nasync function syncAnthologyToSheets(submission) {\n    const values = [\n        new Date().toISOString(),\n        submission.name,\n        submission.phone,\n        submission.isWhatsApp ? \"Yes\" : \"No\",\n        submission.whatsAppNumber || submission.phone,\n        submission.email,\n        submission.instagramUsername || \"\",\n        submission.poetryTitle,\n        submission.poetryContent.substring(0, 500) + (submission.poetryContent.length > 500 ? \"...\" : \"\"),\n        submission.bio || \"\",\n        submission.contactPreference\n    ];\n    return await appendToSheet(ANTHOLOGY_SHEET_ID, \"Submissions\", values);\n}\n// Get submissions count for today (for live counter)\nasync function getTodaySubmissionsCount() {\n    if (!isSheetsConfigured()) {\n        // Return from database instead\n        return null; // Will trigger DB fallback\n    }\n    // TODO: Implement actual count from Google Sheets\n    // For now, return null to use DB fallback\n    return null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dGUvLi9saWIvZ29vZ2xlLXNoZWV0cy5qcz9hOTM0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIEdvb2dsZSBTaGVldHMgSW50ZWdyYXRpb24gZm9yIFdyaXRlcidzIFBvY2tldFxuLy8gQ3VycmVudGx5IG1vY2tlZCwgZGVzaWduZWQgZm9yIEdvb2dsZSBTaGVldHMgQVBJIGludGVncmF0aW9uXG5cbmNvbnN0IFNIRUVUU19FTkFCTEVEID0gcHJvY2Vzcy5lbnYuR09PR0xFX1NIRUVUU19FTkFCTEVEID09PSAndHJ1ZSc7XG5jb25zdCBTSEVFVFNfQ1JFREVOVElBTFMgPSBwcm9jZXNzLmVudi5HT09HTEVfU0hFRVRTX0NSRURFTlRJQUxTO1xuY29uc3QgTEVBRFNfU0hFRVRfSUQgPSBwcm9jZXNzLmVudi5HT09HTEVfU0hFRVRTX0xFQURTX0lEO1xuY29uc3QgQU5USE9MT0dZX1NIRUVUX0lEID0gcHJvY2Vzcy5lbnYuR09PR0xFX1NIRUVUU19BTlRIT0xPR1lfSUQ7XG5cbi8vIENoZWNrIGlmIEdvb2dsZSBTaGVldHMgaXMgY29uZmlndXJlZFxuZXhwb3J0IGZ1bmN0aW9uIGlzU2hlZXRzQ29uZmlndXJlZCgpIHtcbiAgcmV0dXJuIFNIRUVUU19FTkFCTEVEICYmIFNIRUVUU19DUkVERU5USUFMUyAmJiAoTEVBRFNfU0hFRVRfSUQgfHwgQU5USE9MT0dZX1NIRUVUX0lEKTtcbn1cblxuLy8gQXBwZW5kIHJvdyB0byBhIHNoZWV0XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kVG9TaGVldChzaGVldElkLCBzaGVldE5hbWUsIHZhbHVlcykge1xuICB0cnkge1xuICAgIGlmICghU0hFRVRTX0VOQUJMRUQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbTU9DSyBTSEVFVFNdIFdvdWxkIGFwcGVuZCB0byBzaGVldDonLCB7IHNoZWV0SWQsIHNoZWV0TmFtZSwgdmFsdWVzIH0pO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgbW9ja2VkOiB0cnVlIH07XG4gICAgfVxuXG4gICAgaWYgKCFpc1NoZWV0c0NvbmZpZ3VyZWQoKSkge1xuICAgICAgY29uc29sZS53YXJuKCdbU0hFRVRTXSBOb3QgY29uZmlndXJlZCwgc2tpcHBpbmcgYXBwZW5kJyk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdTaGVldHMgbm90IGNvbmZpZ3VyZWQnIH07XG4gICAgfVxuXG4gICAgLy8gVE9ETzogSW1wbGVtZW50IGFjdHVhbCBHb29nbGUgU2hlZXRzIEFQSVxuICAgIC8vIGNvbnN0IGF1dGggPSBuZXcgZ29vZ2xlLmF1dGguR29vZ2xlQXV0aCh7XG4gICAgLy8gICBjcmVkZW50aWFsczogSlNPTi5wYXJzZShTSEVFVFNfQ1JFREVOVElBTFMpLFxuICAgIC8vICAgc2NvcGVzOiBbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvc3ByZWFkc2hlZXRzJ10sXG4gICAgLy8gfSk7XG4gICAgLy8gY29uc3Qgc2hlZXRzID0gZ29vZ2xlLnNoZWV0cyh7IHZlcnNpb246ICd2NCcsIGF1dGggfSk7XG4gICAgLy8gYXdhaXQgc2hlZXRzLnNwcmVhZHNoZWV0cy52YWx1ZXMuYXBwZW5kKHsuLi59KTtcblxuICAgIGNvbnNvbGUubG9nKCdbU0hFRVRTXSBXb3VsZCBhcHBlbmQgcm93OicsIHsgc2hlZXRJZCwgc2hlZXROYW1lLCByb3dDb3VudDogMSB9KTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBtb2NrZWQ6ICFTSEVFVFNfRU5BQkxFRCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTSEVFVFMgRVJST1JdJywgZXJyb3IpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICB9XG59XG5cbi8vIFN5bmMgbGVhZCB0byBHb29nbGUgU2hlZXRzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3luY0xlYWRUb1NoZWV0cyhsZWFkKSB7XG4gIGNvbnN0IHZhbHVlcyA9IFtcbiAgICBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgbGVhZC5uYW1lLFxuICAgIGxlYWQuZW1haWwsXG4gICAgbGVhZC5waG9uZSB8fCAnJyxcbiAgICBsZWFkLnNvdXJjZSxcbiAgICBsZWFkLmludGVyZXN0QXJlYSB8fCAnJyxcbiAgICBsZWFkLnN0YXR1cyxcbiAgICBsZWFkLm5vdGVzIHx8ICcnLFxuICBdO1xuXG4gIHJldHVybiBhd2FpdCBhcHBlbmRUb1NoZWV0KExFQURTX1NIRUVUX0lELCAnTGVhZHMnLCB2YWx1ZXMpO1xufVxuXG4vLyBTeW5jIGFudGhvbG9neSBzdWJtaXNzaW9uIHRvIEdvb2dsZSBTaGVldHNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzeW5jQW50aG9sb2d5VG9TaGVldHMoc3VibWlzc2lvbikge1xuICBjb25zdCB2YWx1ZXMgPSBbXG4gICAgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIHN1Ym1pc3Npb24ubmFtZSxcbiAgICBzdWJtaXNzaW9uLnBob25lLFxuICAgIHN1Ym1pc3Npb24uaXNXaGF0c0FwcCA/ICdZZXMnIDogJ05vJyxcbiAgICBzdWJtaXNzaW9uLndoYXRzQXBwTnVtYmVyIHx8IHN1Ym1pc3Npb24ucGhvbmUsXG4gICAgc3VibWlzc2lvbi5lbWFpbCxcbiAgICBzdWJtaXNzaW9uLmluc3RhZ3JhbVVzZXJuYW1lIHx8ICcnLFxuICAgIHN1Ym1pc3Npb24ucG9ldHJ5VGl0bGUsXG4gICAgc3VibWlzc2lvbi5wb2V0cnlDb250ZW50LnN1YnN0cmluZygwLCA1MDApICsgKHN1Ym1pc3Npb24ucG9ldHJ5Q29udGVudC5sZW5ndGggPiA1MDAgPyAnLi4uJyA6ICcnKSxcbiAgICBzdWJtaXNzaW9uLmJpbyB8fCAnJyxcbiAgICBzdWJtaXNzaW9uLmNvbnRhY3RQcmVmZXJlbmNlLFxuICBdO1xuXG4gIHJldHVybiBhd2FpdCBhcHBlbmRUb1NoZWV0KEFOVEhPTE9HWV9TSEVFVF9JRCwgJ1N1Ym1pc3Npb25zJywgdmFsdWVzKTtcbn1cblxuLy8gR2V0IHN1Ym1pc3Npb25zIGNvdW50IGZvciB0b2RheSAoZm9yIGxpdmUgY291bnRlcilcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUb2RheVN1Ym1pc3Npb25zQ291bnQoKSB7XG4gIGlmICghaXNTaGVldHNDb25maWd1cmVkKCkpIHtcbiAgICAvLyBSZXR1cm4gZnJvbSBkYXRhYmFzZSBpbnN0ZWFkXG4gICAgcmV0dXJuIG51bGw7IC8vIFdpbGwgdHJpZ2dlciBEQiBmYWxsYmFja1xuICB9XG5cbiAgLy8gVE9ETzogSW1wbGVtZW50IGFjdHVhbCBjb3VudCBmcm9tIEdvb2dsZSBTaGVldHNcbiAgLy8gRm9yIG5vdywgcmV0dXJuIG51bGwgdG8gdXNlIERCIGZhbGxiYWNrXG4gIHJldHVybiBudWxsO1xufVxuIl0sIm5hbWVzIjpbIlNIRUVUU19FTkFCTEVEIiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9TSEVFVFNfRU5BQkxFRCIsIlNIRUVUU19DUkVERU5USUFMUyIsIkdPT0dMRV9TSEVFVFNfQ1JFREVOVElBTFMiLCJMRUFEU19TSEVFVF9JRCIsIkdPT0dMRV9TSEVFVFNfTEVBRFNfSUQiLCJBTlRIT0xPR1lfU0hFRVRfSUQiLCJHT09HTEVfU0hFRVRTX0FOVEhPTE9HWV9JRCIsImlzU2hlZXRzQ29uZmlndXJlZCIsImFwcGVuZFRvU2hlZXQiLCJzaGVldElkIiwic2hlZXROYW1lIiwidmFsdWVzIiwiY29uc29sZSIsImxvZyIsInN1Y2Nlc3MiLCJtb2NrZWQiLCJ3YXJuIiwiZXJyb3IiLCJyb3dDb3VudCIsIm1lc3NhZ2UiLCJzeW5jTGVhZFRvU2hlZXRzIiwibGVhZCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm5hbWUiLCJlbWFpbCIsInBob25lIiwic291cmNlIiwiaW50ZXJlc3RBcmVhIiwic3RhdHVzIiwibm90ZXMiLCJzeW5jQW50aG9sb2d5VG9TaGVldHMiLCJzdWJtaXNzaW9uIiwiaXNXaGF0c0FwcCIsIndoYXRzQXBwTnVtYmVyIiwiaW5zdGFncmFtVXNlcm5hbWUiLCJwb2V0cnlUaXRsZSIsInBvZXRyeUNvbnRlbnQiLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJiaW8iLCJjb250YWN0UHJlZmVyZW5jZSIsImdldFRvZGF5U3VibWlzc2lvbnNDb3VudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/google-sheets.js\n");

/***/ }),

/***/ "(rsc)/./lib/identity.js":
/*!*************************!*\
  !*** ./lib/identity.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createRoyaltiesForSale: () => (/* binding */ createRoyaltiesForSale),\n/* harmony export */   ensureAuthorUid: () => (/* binding */ ensureAuthorUid),\n/* harmony export */   findBookByIsbn: () => (/* binding */ findBookByIsbn),\n/* harmony export */   generateAuthorUid: () => (/* binding */ generateAuthorUid),\n/* harmony export */   getAuthorBooks: () => (/* binding */ getAuthorBooks),\n/* harmony export */   getBookAuthors: () => (/* binding */ getBookAuthors),\n/* harmony export */   getCanonicalIsbn: () => (/* binding */ getCanonicalIsbn),\n/* harmony export */   getCurrentPeriod: () => (/* binding */ getCurrentPeriod),\n/* harmony export */   getOrCreateAuthorByEmail: () => (/* binding */ getOrCreateAuthorByEmail),\n/* harmony export */   getRoyaltyBucket: () => (/* binding */ getRoyaltyBucket),\n/* harmony export */   linkAuthorsToBook: () => (/* binding */ linkAuthorsToBook),\n/* harmony export */   parsePeriod: () => (/* binding */ parsePeriod)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/prisma.js\");\n// Author UID and Data Identity Utilities\n\n/**\n * Generate a unique Author UID in format: WP-AUTH-XXXXXX\n * Uses a sequence table to ensure uniqueness\n */ async function generateAuthorUid() {\n    // Use upsert to handle the singleton sequence\n    const sequence = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].authorUidSequence.upsert({\n        where: {\n            id: \"singleton\"\n        },\n        update: {\n            lastValue: {\n                increment: 1\n            }\n        },\n        create: {\n            id: \"singleton\",\n            lastValue: 1\n        }\n    });\n    const paddedNumber = String(sequence.lastValue).padStart(6, \"0\");\n    return `WP-AUTH-${paddedNumber}`;\n}\n/**\n * Assign Author UID to a user if they don't have one\n */ async function ensureAuthorUid(userId) {\n    const user = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.findUnique({\n        where: {\n            id: userId\n        },\n        select: {\n            id: true,\n            authorUid: true\n        }\n    });\n    if (!user) return null;\n    if (user.authorUid) return user.authorUid;\n    const authorUid = await generateAuthorUid();\n    await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.update({\n        where: {\n            id: userId\n        },\n        data: {\n            authorUid\n        }\n    });\n    return authorUid;\n}\n/**\n * Get or create Author UID by email\n * Used during CSV imports to match existing authors\n */ async function getOrCreateAuthorByEmail(email, name, options = {}) {\n    const normalizedEmail = email.toLowerCase().trim();\n    // Check if user exists\n    let user = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.findUnique({\n        where: {\n            email: normalizedEmail\n        }\n    });\n    if (user) {\n        // Ensure they have an Author UID\n        if (!user.authorUid) {\n            const authorUid = await generateAuthorUid();\n            user = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.update({\n                where: {\n                    id: user.id\n                },\n                data: {\n                    authorUid\n                }\n            });\n        }\n        return user;\n    }\n    // Create new user with Author UID\n    const authorUid = await generateAuthorUid();\n    user = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.create({\n        data: {\n            email: normalizedEmail,\n            name: name || \"Unknown Author\",\n            password: \"\",\n            authorUid,\n            importSource: options.importSource || \"csv\",\n            phone: options.phone,\n            alternateEmail: options.alternateEmail,\n            alternatePhone: options.alternatePhone\n        }\n    });\n    return user;\n}\n/**\n * Determine royalty bucket from platform name\n * Case-insensitive matching\n */ function getRoyaltyBucket(platform) {\n    if (!platform) return \"ECOMMERCE\";\n    const p = platform.toLowerCase().trim();\n    // Website bucket\n    if (p.includes(\"website\") || p.includes(\"direct\")) {\n        return \"WEBSITE\";\n    }\n    // Ebook bucket\n    if (p.includes(\"ebook\") || p.includes(\"kindle\") || p.includes(\"google books\") || p.includes(\"google play\") || p.includes(\"kobo\") || p.includes(\"apple books\") || p.includes(\"nook\")) {\n        return \"EBOOK\";\n    }\n    // Default to ecommerce\n    return \"ECOMMERCE\";\n}\n/**\n * Find book by ISBN (checks paperback, hardcover, and legacy ISBN)\n */ async function findBookByIsbn(isbn) {\n    if (!isbn) return null;\n    const normalizedIsbn = isbn.replace(/[-\\s]/g, \"\").trim();\n    const book = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].book.findFirst({\n        where: {\n            OR: [\n                {\n                    isbnPaperback: normalizedIsbn\n                },\n                {\n                    isbnHardcover: normalizedIsbn\n                },\n                {\n                    isbn: normalizedIsbn\n                }\n            ]\n        },\n        include: {\n            authors: {\n                include: {\n                    author: true\n                }\n            },\n            author: true\n        }\n    });\n    return book;\n}\n/**\n * Get canonical ISBN for a book (paperback ISBN is the anchor)\n */ function getCanonicalIsbn(book) {\n    return book.isbnPaperback || book.isbn || book.isbnHardcover;\n}\n/**\n * Link multiple authors to a book\n */ async function linkAuthorsToBook(bookId, authorIds, addedBy = null) {\n    const results = [];\n    for(let i = 0; i < authorIds.length; i++){\n        const authorId = authorIds[i];\n        // Get author's UID\n        const author = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].user.findUnique({\n            where: {\n                id: authorId\n            },\n            select: {\n                id: true,\n                authorUid: true\n            }\n        });\n        if (!author) continue;\n        // Create or update book-author link\n        const bookAuthor = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].bookAuthor.upsert({\n            where: {\n                bookId_authorId: {\n                    bookId,\n                    authorId\n                }\n            },\n            update: {\n                authorUid: author.authorUid\n            },\n            create: {\n                bookId,\n                authorId,\n                authorUid: author.authorUid,\n                isPrimary: i === 0,\n                addedBy\n            }\n        });\n        results.push(bookAuthor);\n    }\n    return results;\n}\n/**\n * Get all authors for a book\n */ async function getBookAuthors(bookId) {\n    const bookAuthors = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].bookAuthor.findMany({\n        where: {\n            bookId\n        },\n        include: {\n            author: {\n                select: {\n                    id: true,\n                    authorUid: true,\n                    name: true,\n                    email: true\n                }\n            }\n        },\n        orderBy: [\n            {\n                isPrimary: \"desc\"\n            },\n            {\n                addedAt: \"asc\"\n            }\n        ]\n    });\n    return bookAuthors;\n}\n/**\n * Get all books for an author (via BookAuthor junction)\n */ async function getAuthorBooks(authorId) {\n    const bookAuthors = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].bookAuthor.findMany({\n        where: {\n            authorId\n        },\n        include: {\n            book: true\n        }\n    });\n    return bookAuthors.map((ba)=>ba.book);\n}\n/**\n * Create royalties for all authors of a book\n */ async function createRoyaltiesForSale(bookId, saleAmount, platform, options = {}) {\n    const book = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].book.findUnique({\n        where: {\n            id: bookId\n        },\n        include: {\n            authors: {\n                include: {\n                    author: true\n                }\n            },\n            author: true\n        }\n    });\n    if (!book) return [];\n    const bucket = getRoyaltyBucket(platform);\n    const royaltyRate = options.royaltyRate || 0.10;\n    const royalties = [];\n    // Get all authors (from junction table or legacy)\n    let authors = book.authors.map((ba)=>({\n            id: ba.author.id,\n            authorUid: ba.author.authorUid,\n            share: ba.royaltyShare\n        }));\n    // Fallback to legacy single author if no multi-author setup\n    if (authors.length === 0 && book.author) {\n        authors = [\n            {\n                id: book.author.id,\n                authorUid: book.author.authorUid,\n                share: 100\n            }\n        ];\n    }\n    // Calculate royalty amount per author\n    const totalRoyalty = saleAmount * royaltyRate;\n    const hasCustomShares = authors.some((a)=>a.share !== null && a.share !== undefined);\n    for (const author of authors){\n        let authorShare;\n        if (hasCustomShares && author.share !== null) {\n            authorShare = author.share / 100;\n        } else {\n            authorShare = 1 / authors.length; // Equal split\n        }\n        const authorRoyalty = totalRoyalty * authorShare;\n        const royalty = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].royalty.create({\n            data: {\n                authorId: author.id,\n                authorUid: author.authorUid,\n                bookId,\n                saleId: options.saleId,\n                amount: authorRoyalty,\n                royaltyRate,\n                saleAmount: saleAmount * authorShare,\n                bucket,\n                platform,\n                period: options.period || getCurrentPeriod()\n            }\n        });\n        royalties.push(royalty);\n    }\n    return royalties;\n}\n/**\n * Get current period string (YYYY-MM)\n */ function getCurrentPeriod() {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, \"0\");\n    return `${year}-${month}`;\n}\n/**\n * Parse period string to date range\n */ function parsePeriod(period) {\n    const [year, month] = period.split(\"-\").map(Number);\n    const startDate = new Date(year, month - 1, 1);\n    const endDate = new Date(year, month, 0, 23, 59, 59);\n    return {\n        startDate,\n        endDate\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cGxhdGUvLi9saWIvaWRlbnRpdHkuanM/ZTAyOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBdXRob3IgVUlEIGFuZCBEYXRhIElkZW50aXR5IFV0aWxpdGllc1xuaW1wb3J0IHByaXNtYSBmcm9tICcuL3ByaXNtYSc7XG5cbi8qKlxuICogR2VuZXJhdGUgYSB1bmlxdWUgQXV0aG9yIFVJRCBpbiBmb3JtYXQ6IFdQLUFVVEgtWFhYWFhYXG4gKiBVc2VzIGEgc2VxdWVuY2UgdGFibGUgdG8gZW5zdXJlIHVuaXF1ZW5lc3NcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQXV0aG9yVWlkKCkge1xuICAvLyBVc2UgdXBzZXJ0IHRvIGhhbmRsZSB0aGUgc2luZ2xldG9uIHNlcXVlbmNlXG4gIGNvbnN0IHNlcXVlbmNlID0gYXdhaXQgcHJpc21hLmF1dGhvclVpZFNlcXVlbmNlLnVwc2VydCh7XG4gICAgd2hlcmU6IHsgaWQ6ICdzaW5nbGV0b24nIH0sXG4gICAgdXBkYXRlOiB7IGxhc3RWYWx1ZTogeyBpbmNyZW1lbnQ6IDEgfSB9LFxuICAgIGNyZWF0ZTogeyBpZDogJ3NpbmdsZXRvbicsIGxhc3RWYWx1ZTogMSB9LFxuICB9KTtcblxuICBjb25zdCBwYWRkZWROdW1iZXIgPSBTdHJpbmcoc2VxdWVuY2UubGFzdFZhbHVlKS5wYWRTdGFydCg2LCAnMCcpO1xuICByZXR1cm4gYFdQLUFVVEgtJHtwYWRkZWROdW1iZXJ9YDtcbn1cblxuLyoqXG4gKiBBc3NpZ24gQXV0aG9yIFVJRCB0byBhIHVzZXIgaWYgdGhleSBkb24ndCBoYXZlIG9uZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlQXV0aG9yVWlkKHVzZXJJZCkge1xuICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgYXV0aG9yVWlkOiB0cnVlIH0sXG4gIH0pO1xuXG4gIGlmICghdXNlcikgcmV0dXJuIG51bGw7XG4gIFxuICBpZiAodXNlci5hdXRob3JVaWQpIHJldHVybiB1c2VyLmF1dGhvclVpZDtcblxuICBjb25zdCBhdXRob3JVaWQgPSBhd2FpdCBnZW5lcmF0ZUF1dGhvclVpZCgpO1xuICBcbiAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICB3aGVyZTogeyBpZDogdXNlcklkIH0sXG4gICAgZGF0YTogeyBhdXRob3JVaWQgfSxcbiAgfSk7XG5cbiAgcmV0dXJuIGF1dGhvclVpZDtcbn1cblxuLyoqXG4gKiBHZXQgb3IgY3JlYXRlIEF1dGhvciBVSUQgYnkgZW1haWxcbiAqIFVzZWQgZHVyaW5nIENTViBpbXBvcnRzIHRvIG1hdGNoIGV4aXN0aW5nIGF1dGhvcnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yQ3JlYXRlQXV0aG9yQnlFbWFpbChlbWFpbCwgbmFtZSwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRFbWFpbCA9IGVtYWlsLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICBcbiAgLy8gQ2hlY2sgaWYgdXNlciBleGlzdHNcbiAgbGV0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBlbWFpbDogbm9ybWFsaXplZEVtYWlsIH0sXG4gIH0pO1xuXG4gIGlmICh1c2VyKSB7XG4gICAgLy8gRW5zdXJlIHRoZXkgaGF2ZSBhbiBBdXRob3IgVUlEXG4gICAgaWYgKCF1c2VyLmF1dGhvclVpZCkge1xuICAgICAgY29uc3QgYXV0aG9yVWlkID0gYXdhaXQgZ2VuZXJhdGVBdXRob3JVaWQoKTtcbiAgICAgIHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogdXNlci5pZCB9LFxuICAgICAgICBkYXRhOiB7IGF1dGhvclVpZCB9LFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgLy8gQ3JlYXRlIG5ldyB1c2VyIHdpdGggQXV0aG9yIFVJRFxuICBjb25zdCBhdXRob3JVaWQgPSBhd2FpdCBnZW5lcmF0ZUF1dGhvclVpZCgpO1xuICBcbiAgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XG4gICAgZGF0YToge1xuICAgICAgZW1haWw6IG5vcm1hbGl6ZWRFbWFpbCxcbiAgICAgIG5hbWU6IG5hbWUgfHwgJ1Vua25vd24gQXV0aG9yJyxcbiAgICAgIHBhc3N3b3JkOiAnJywgLy8gRW1wdHkgcGFzc3dvcmQgLSB1c2VyIG5lZWRzIHRvIHNldCB1cCBhY2NvdW50XG4gICAgICBhdXRob3JVaWQsXG4gICAgICBpbXBvcnRTb3VyY2U6IG9wdGlvbnMuaW1wb3J0U291cmNlIHx8ICdjc3YnLFxuICAgICAgcGhvbmU6IG9wdGlvbnMucGhvbmUsXG4gICAgICBhbHRlcm5hdGVFbWFpbDogb3B0aW9ucy5hbHRlcm5hdGVFbWFpbCxcbiAgICAgIGFsdGVybmF0ZVBob25lOiBvcHRpb25zLmFsdGVybmF0ZVBob25lLFxuICAgIH0sXG4gIH0pO1xuXG4gIHJldHVybiB1c2VyO1xufVxuXG4vKipcbiAqIERldGVybWluZSByb3lhbHR5IGJ1Y2tldCBmcm9tIHBsYXRmb3JtIG5hbWVcbiAqIENhc2UtaW5zZW5zaXRpdmUgbWF0Y2hpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJveWFsdHlCdWNrZXQocGxhdGZvcm0pIHtcbiAgaWYgKCFwbGF0Zm9ybSkgcmV0dXJuICdFQ09NTUVSQ0UnO1xuICBcbiAgY29uc3QgcCA9IHBsYXRmb3JtLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICBcbiAgLy8gV2Vic2l0ZSBidWNrZXRcbiAgaWYgKHAuaW5jbHVkZXMoJ3dlYnNpdGUnKSB8fCBwLmluY2x1ZGVzKCdkaXJlY3QnKSkge1xuICAgIHJldHVybiAnV0VCU0lURSc7XG4gIH1cbiAgXG4gIC8vIEVib29rIGJ1Y2tldFxuICBpZiAoXG4gICAgcC5pbmNsdWRlcygnZWJvb2snKSB8fFxuICAgIHAuaW5jbHVkZXMoJ2tpbmRsZScpIHx8XG4gICAgcC5pbmNsdWRlcygnZ29vZ2xlIGJvb2tzJykgfHxcbiAgICBwLmluY2x1ZGVzKCdnb29nbGUgcGxheScpIHx8XG4gICAgcC5pbmNsdWRlcygna29ibycpIHx8XG4gICAgcC5pbmNsdWRlcygnYXBwbGUgYm9va3MnKSB8fFxuICAgIHAuaW5jbHVkZXMoJ25vb2snKVxuICApIHtcbiAgICByZXR1cm4gJ0VCT09LJztcbiAgfVxuICBcbiAgLy8gRGVmYXVsdCB0byBlY29tbWVyY2VcbiAgcmV0dXJuICdFQ09NTUVSQ0UnO1xufVxuXG4vKipcbiAqIEZpbmQgYm9vayBieSBJU0JOIChjaGVja3MgcGFwZXJiYWNrLCBoYXJkY292ZXIsIGFuZCBsZWdhY3kgSVNCTilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRCb29rQnlJc2JuKGlzYm4pIHtcbiAgaWYgKCFpc2JuKSByZXR1cm4gbnVsbDtcbiAgXG4gIGNvbnN0IG5vcm1hbGl6ZWRJc2JuID0gaXNibi5yZXBsYWNlKC9bLVxcc10vZywgJycpLnRyaW0oKTtcbiAgXG4gIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICBPUjogW1xuICAgICAgICB7IGlzYm5QYXBlcmJhY2s6IG5vcm1hbGl6ZWRJc2JuIH0sXG4gICAgICAgIHsgaXNibkhhcmRjb3Zlcjogbm9ybWFsaXplZElzYm4gfSxcbiAgICAgICAgeyBpc2JuOiBub3JtYWxpemVkSXNibiB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIGF1dGhvcnM6IHtcbiAgICAgICAgaW5jbHVkZTogeyBhdXRob3I6IHRydWUgfSxcbiAgICAgIH0sXG4gICAgICBhdXRob3I6IHRydWUsXG4gICAgfSxcbiAgfSk7XG5cbiAgcmV0dXJuIGJvb2s7XG59XG5cbi8qKlxuICogR2V0IGNhbm9uaWNhbCBJU0JOIGZvciBhIGJvb2sgKHBhcGVyYmFjayBJU0JOIGlzIHRoZSBhbmNob3IpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDYW5vbmljYWxJc2JuKGJvb2spIHtcbiAgcmV0dXJuIGJvb2suaXNiblBhcGVyYmFjayB8fCBib29rLmlzYm4gfHwgYm9vay5pc2JuSGFyZGNvdmVyO1xufVxuXG4vKipcbiAqIExpbmsgbXVsdGlwbGUgYXV0aG9ycyB0byBhIGJvb2tcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtBdXRob3JzVG9Cb29rKGJvb2tJZCwgYXV0aG9ySWRzLCBhZGRlZEJ5ID0gbnVsbCkge1xuICBjb25zdCByZXN1bHRzID0gW107XG4gIFxuICBmb3IgKGxldCBpID0gMDsgaSA8IGF1dGhvcklkcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGF1dGhvcklkID0gYXV0aG9ySWRzW2ldO1xuICAgIFxuICAgIC8vIEdldCBhdXRob3IncyBVSURcbiAgICBjb25zdCBhdXRob3IgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBhdXRob3JJZCB9LFxuICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBhdXRob3JVaWQ6IHRydWUgfSxcbiAgICB9KTtcblxuICAgIGlmICghYXV0aG9yKSBjb250aW51ZTtcblxuICAgIC8vIENyZWF0ZSBvciB1cGRhdGUgYm9vay1hdXRob3IgbGlua1xuICAgIGNvbnN0IGJvb2tBdXRob3IgPSBhd2FpdCBwcmlzbWEuYm9va0F1dGhvci51cHNlcnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgYm9va0lkX2F1dGhvcklkOiB7IGJvb2tJZCwgYXV0aG9ySWQgfSxcbiAgICAgIH0sXG4gICAgICB1cGRhdGU6IHtcbiAgICAgICAgYXV0aG9yVWlkOiBhdXRob3IuYXV0aG9yVWlkLFxuICAgICAgfSxcbiAgICAgIGNyZWF0ZToge1xuICAgICAgICBib29rSWQsXG4gICAgICAgIGF1dGhvcklkLFxuICAgICAgICBhdXRob3JVaWQ6IGF1dGhvci5hdXRob3JVaWQsXG4gICAgICAgIGlzUHJpbWFyeTogaSA9PT0gMCwgLy8gRmlyc3QgYXV0aG9yIGlzIHByaW1hcnlcbiAgICAgICAgYWRkZWRCeSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXN1bHRzLnB1c2goYm9va0F1dGhvcik7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0cztcbn1cblxuLyoqXG4gKiBHZXQgYWxsIGF1dGhvcnMgZm9yIGEgYm9va1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Qm9va0F1dGhvcnMoYm9va0lkKSB7XG4gIGNvbnN0IGJvb2tBdXRob3JzID0gYXdhaXQgcHJpc21hLmJvb2tBdXRob3IuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IGJvb2tJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIGF1dGhvcjoge1xuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBhdXRob3JVaWQ6IHRydWUsXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBvcmRlckJ5OiBbXG4gICAgICB7IGlzUHJpbWFyeTogJ2Rlc2MnIH0sXG4gICAgICB7IGFkZGVkQXQ6ICdhc2MnIH0sXG4gICAgXSxcbiAgfSk7XG5cbiAgcmV0dXJuIGJvb2tBdXRob3JzO1xufVxuXG4vKipcbiAqIEdldCBhbGwgYm9va3MgZm9yIGFuIGF1dGhvciAodmlhIEJvb2tBdXRob3IganVuY3Rpb24pXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdXRob3JCb29rcyhhdXRob3JJZCkge1xuICBjb25zdCBib29rQXV0aG9ycyA9IGF3YWl0IHByaXNtYS5ib29rQXV0aG9yLmZpbmRNYW55KHtcbiAgICB3aGVyZTogeyBhdXRob3JJZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIGJvb2s6IHRydWUsXG4gICAgfSxcbiAgfSk7XG5cbiAgcmV0dXJuIGJvb2tBdXRob3JzLm1hcChiYSA9PiBiYS5ib29rKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcm95YWx0aWVzIGZvciBhbGwgYXV0aG9ycyBvZiBhIGJvb2tcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJveWFsdGllc0ZvclNhbGUoYm9va0lkLCBzYWxlQW1vdW50LCBwbGF0Zm9ybSwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogYm9va0lkIH0sXG4gICAgaW5jbHVkZToge1xuICAgICAgYXV0aG9yczoge1xuICAgICAgICBpbmNsdWRlOiB7IGF1dGhvcjogdHJ1ZSB9LFxuICAgICAgfSxcbiAgICAgIGF1dGhvcjogdHJ1ZSwgLy8gTGVnYWN5IHNpbmdsZSBhdXRob3JcbiAgICB9LFxuICB9KTtcblxuICBpZiAoIWJvb2spIHJldHVybiBbXTtcblxuICBjb25zdCBidWNrZXQgPSBnZXRSb3lhbHR5QnVja2V0KHBsYXRmb3JtKTtcbiAgY29uc3Qgcm95YWx0eVJhdGUgPSBvcHRpb25zLnJveWFsdHlSYXRlIHx8IDAuMTA7XG4gIGNvbnN0IHJveWFsdGllcyA9IFtdO1xuXG4gIC8vIEdldCBhbGwgYXV0aG9ycyAoZnJvbSBqdW5jdGlvbiB0YWJsZSBvciBsZWdhY3kpXG4gIGxldCBhdXRob3JzID0gYm9vay5hdXRob3JzLm1hcChiYSA9PiAoe1xuICAgIGlkOiBiYS5hdXRob3IuaWQsXG4gICAgYXV0aG9yVWlkOiBiYS5hdXRob3IuYXV0aG9yVWlkLFxuICAgIHNoYXJlOiBiYS5yb3lhbHR5U2hhcmUsXG4gIH0pKTtcblxuICAvLyBGYWxsYmFjayB0byBsZWdhY3kgc2luZ2xlIGF1dGhvciBpZiBubyBtdWx0aS1hdXRob3Igc2V0dXBcbiAgaWYgKGF1dGhvcnMubGVuZ3RoID09PSAwICYmIGJvb2suYXV0aG9yKSB7XG4gICAgYXV0aG9ycyA9IFt7XG4gICAgICBpZDogYm9vay5hdXRob3IuaWQsXG4gICAgICBhdXRob3JVaWQ6IGJvb2suYXV0aG9yLmF1dGhvclVpZCxcbiAgICAgIHNoYXJlOiAxMDAsXG4gICAgfV07XG4gIH1cblxuICAvLyBDYWxjdWxhdGUgcm95YWx0eSBhbW91bnQgcGVyIGF1dGhvclxuICBjb25zdCB0b3RhbFJveWFsdHkgPSBzYWxlQW1vdW50ICogcm95YWx0eVJhdGU7XG4gIGNvbnN0IGhhc0N1c3RvbVNoYXJlcyA9IGF1dGhvcnMuc29tZShhID0+IGEuc2hhcmUgIT09IG51bGwgJiYgYS5zaGFyZSAhPT0gdW5kZWZpbmVkKTtcbiAgXG4gIGZvciAoY29uc3QgYXV0aG9yIG9mIGF1dGhvcnMpIHtcbiAgICBsZXQgYXV0aG9yU2hhcmU7XG4gICAgaWYgKGhhc0N1c3RvbVNoYXJlcyAmJiBhdXRob3Iuc2hhcmUgIT09IG51bGwpIHtcbiAgICAgIGF1dGhvclNoYXJlID0gYXV0aG9yLnNoYXJlIC8gMTAwO1xuICAgIH0gZWxzZSB7XG4gICAgICBhdXRob3JTaGFyZSA9IDEgLyBhdXRob3JzLmxlbmd0aDsgLy8gRXF1YWwgc3BsaXRcbiAgICB9XG5cbiAgICBjb25zdCBhdXRob3JSb3lhbHR5ID0gdG90YWxSb3lhbHR5ICogYXV0aG9yU2hhcmU7XG5cbiAgICBjb25zdCByb3lhbHR5ID0gYXdhaXQgcHJpc21hLnJveWFsdHkuY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYXV0aG9ySWQ6IGF1dGhvci5pZCxcbiAgICAgICAgYXV0aG9yVWlkOiBhdXRob3IuYXV0aG9yVWlkLFxuICAgICAgICBib29rSWQsXG4gICAgICAgIHNhbGVJZDogb3B0aW9ucy5zYWxlSWQsXG4gICAgICAgIGFtb3VudDogYXV0aG9yUm95YWx0eSxcbiAgICAgICAgcm95YWx0eVJhdGUsXG4gICAgICAgIHNhbGVBbW91bnQ6IHNhbGVBbW91bnQgKiBhdXRob3JTaGFyZSxcbiAgICAgICAgYnVja2V0LFxuICAgICAgICBwbGF0Zm9ybSxcbiAgICAgICAgcGVyaW9kOiBvcHRpb25zLnBlcmlvZCB8fCBnZXRDdXJyZW50UGVyaW9kKCksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcm95YWx0aWVzLnB1c2gocm95YWx0eSk7XG4gIH1cblxuICByZXR1cm4gcm95YWx0aWVzO1xufVxuXG4vKipcbiAqIEdldCBjdXJyZW50IHBlcmlvZCBzdHJpbmcgKFlZWVktTU0pXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50UGVyaW9kKCkge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCB5ZWFyID0gbm93LmdldEZ1bGxZZWFyKCk7XG4gIGNvbnN0IG1vbnRoID0gU3RyaW5nKG5vdy5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9YDtcbn1cblxuLyoqXG4gKiBQYXJzZSBwZXJpb2Qgc3RyaW5nIHRvIGRhdGUgcmFuZ2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUGVyaW9kKHBlcmlvZCkge1xuICBjb25zdCBbeWVhciwgbW9udGhdID0gcGVyaW9kLnNwbGl0KCctJykubWFwKE51bWJlcik7XG4gIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgMSk7XG4gIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCwgMjMsIDU5LCA1OSk7XG4gIHJldHVybiB7IHN0YXJ0RGF0ZSwgZW5kRGF0ZSB9O1xufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImdlbmVyYXRlQXV0aG9yVWlkIiwic2VxdWVuY2UiLCJhdXRob3JVaWRTZXF1ZW5jZSIsInVwc2VydCIsIndoZXJlIiwiaWQiLCJ1cGRhdGUiLCJsYXN0VmFsdWUiLCJpbmNyZW1lbnQiLCJjcmVhdGUiLCJwYWRkZWROdW1iZXIiLCJTdHJpbmciLCJwYWRTdGFydCIsImVuc3VyZUF1dGhvclVpZCIsInVzZXJJZCIsInVzZXIiLCJmaW5kVW5pcXVlIiwic2VsZWN0IiwiYXV0aG9yVWlkIiwiZGF0YSIsImdldE9yQ3JlYXRlQXV0aG9yQnlFbWFpbCIsImVtYWlsIiwibmFtZSIsIm9wdGlvbnMiLCJub3JtYWxpemVkRW1haWwiLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJwYXNzd29yZCIsImltcG9ydFNvdXJjZSIsInBob25lIiwiYWx0ZXJuYXRlRW1haWwiLCJhbHRlcm5hdGVQaG9uZSIsImdldFJveWFsdHlCdWNrZXQiLCJwbGF0Zm9ybSIsInAiLCJpbmNsdWRlcyIsImZpbmRCb29rQnlJc2JuIiwiaXNibiIsIm5vcm1hbGl6ZWRJc2JuIiwicmVwbGFjZSIsImJvb2siLCJmaW5kRmlyc3QiLCJPUiIsImlzYm5QYXBlcmJhY2siLCJpc2JuSGFyZGNvdmVyIiwiaW5jbHVkZSIsImF1dGhvcnMiLCJhdXRob3IiLCJnZXRDYW5vbmljYWxJc2JuIiwibGlua0F1dGhvcnNUb0Jvb2siLCJib29rSWQiLCJhdXRob3JJZHMiLCJhZGRlZEJ5IiwicmVzdWx0cyIsImkiLCJsZW5ndGgiLCJhdXRob3JJZCIsImJvb2tBdXRob3IiLCJib29rSWRfYXV0aG9ySWQiLCJpc1ByaW1hcnkiLCJwdXNoIiwiZ2V0Qm9va0F1dGhvcnMiLCJib29rQXV0aG9ycyIsImZpbmRNYW55Iiwib3JkZXJCeSIsImFkZGVkQXQiLCJnZXRBdXRob3JCb29rcyIsIm1hcCIsImJhIiwiY3JlYXRlUm95YWx0aWVzRm9yU2FsZSIsInNhbGVBbW91bnQiLCJidWNrZXQiLCJyb3lhbHR5UmF0ZSIsInJveWFsdGllcyIsInNoYXJlIiwicm95YWx0eVNoYXJlIiwidG90YWxSb3lhbHR5IiwiaGFzQ3VzdG9tU2hhcmVzIiwic29tZSIsImEiLCJ1bmRlZmluZWQiLCJhdXRob3JTaGFyZSIsImF1dGhvclJveWFsdHkiLCJyb3lhbHR5Iiwic2FsZUlkIiwiYW1vdW50IiwicGVyaW9kIiwiZ2V0Q3VycmVudFBlcmlvZCIsIm5vdyIsIkRhdGUiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJtb250aCIsImdldE1vbnRoIiwicGFyc2VQZXJpb2QiLCJzcGxpdCIsIk51bWJlciIsInN0YXJ0RGF0ZSIsImVuZERhdGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/identity.js\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.js":
/*!***********************!*\
  !*** ./lib/prisma.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _prisma_adapter_pg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @prisma/adapter-pg */ \"(rsc)/./node_modules/@prisma/adapter-pg/dist/index.mjs\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_1__);\n// Prisma Client Singleton for Next.js with PostgreSQL adapter\n\n\n\nconst globalForPrisma = global;\n// Create PostgreSQL pool\nconst pool = new (pg__WEBPACK_IMPORTED_MODULE_1___default().Pool)({\n    connectionString: process.env.DATABASE_URL\n});\n// Create Prisma adapter\nconst adapter = new _prisma_adapter_pg__WEBPACK_IMPORTED_MODULE_2__.PrismaPg(pool);\n// Create Prisma client with adapter\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    adapter,\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) {\n    globalForPrisma.prisma = prisma;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLDhEQUE4RDtBQUNoQjtBQUNBO0FBQzFCO0FBRXBCLE1BQU1HLGtCQUFrQkM7QUFFeEIseUJBQXlCO0FBQ3pCLE1BQU1DLE9BQU8sSUFBSUgsZ0RBQU8sQ0FBQztJQUN2Qkssa0JBQWtCQyxRQUFRQyxHQUFHLENBQUNDLFlBQVk7QUFDNUM7QUFFQSx3QkFBd0I7QUFDeEIsTUFBTUMsVUFBVSxJQUFJVix3REFBUUEsQ0FBQ0k7QUFFN0Isb0NBQW9DO0FBQ3BDLE1BQU1PLFNBQVNULGdCQUFnQlMsTUFBTSxJQUFJLElBQUlaLHdEQUFZQSxDQUFDO0lBQ3hEVztJQUNBRSxLQUFLTCxLQUF5QixHQUFnQjtRQUFDO1FBQVM7S0FBTyxHQUFHLENBQVM7QUFDN0U7QUFFQSxJQUFJQSxJQUF5QixFQUFjO0lBQ3pDTCxnQkFBZ0JTLE1BQU0sR0FBR0E7QUFDM0I7QUFFQSxpRUFBZUEsTUFBTUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy1tb25nby10ZW1wbGF0ZS8uL2xpYi9wcmlzbWEuanM/NzUxNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBQcmlzbWEgQ2xpZW50IFNpbmdsZXRvbiBmb3IgTmV4dC5qcyB3aXRoIFBvc3RncmVTUUwgYWRhcHRlclxuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHsgUHJpc21hUGcgfSBmcm9tICdAcHJpc21hL2FkYXB0ZXItcGcnO1xuaW1wb3J0IHBnIGZyb20gJ3BnJztcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsO1xuXG4vLyBDcmVhdGUgUG9zdGdyZVNRTCBwb29sXG5jb25zdCBwb29sID0gbmV3IHBnLlBvb2woe1xuICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkxcbn0pO1xuXG4vLyBDcmVhdGUgUHJpc21hIGFkYXB0ZXJcbmNvbnN0IGFkYXB0ZXIgPSBuZXcgUHJpc21hUGcocG9vbCk7XG5cbi8vIENyZWF0ZSBQcmlzbWEgY2xpZW50IHdpdGggYWRhcHRlclxuY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fCBuZXcgUHJpc21hQ2xpZW50KHtcbiAgYWRhcHRlcixcbiAgbG9nOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IFsnZXJyb3InLCAnd2FybiddIDogWydlcnJvciddLFxufSk7XG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJQcmlzbWFQZyIsInBnIiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsIiwicG9vbCIsIlBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsImFkYXB0ZXIiLCJwcmlzbWEiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.js\n");

/***/ }),

/***/ "(rsc)/./lib/razorpay.js":
/*!*************************!*\
  !*** ./lib/razorpay.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createOrder: () => (/* binding */ createOrder),\n/* harmony export */   fetchPayment: () => (/* binding */ fetchPayment),\n/* harmony export */   getRazorpay: () => (/* binding */ getRazorpay),\n/* harmony export */   isRazorpayConfigured: () => (/* binding */ isRazorpayConfigured),\n/* harmony export */   refundPayment: () => (/* binding */ refundPayment),\n/* harmony export */   verifyPaymentSignature: () => (/* binding */ verifyPaymentSignature),\n/* harmony export */   verifyWebhookSignature: () => (/* binding */ verifyWebhookSignature)\n/* harmony export */ });\n/* harmony import */ var razorpay__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! razorpay */ \"(rsc)/./node_modules/razorpay/dist/razorpay.js\");\n/* harmony import */ var razorpay__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(razorpay__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n// Razorpay Integration for Writer's Pocket\n\n\n// Initialize Razorpay instance\nlet razorpayInstance = null;\nfunction getRazorpay() {\n    if (!process.env.RAZORPAY_KEY_ID || !process.env.RAZORPAY_KEY_SECRET) {\n        console.warn(\"Razorpay keys not configured. Payment features will be disabled.\");\n        return null;\n    }\n    if (process.env.RAZORPAY_KEY_ID.includes(\"YOUR_KEY\")) {\n        console.warn(\"Razorpay keys are placeholder values. Payment features will be disabled.\");\n        return null;\n    }\n    if (!razorpayInstance) {\n        razorpayInstance = new (razorpay__WEBPACK_IMPORTED_MODULE_0___default())({\n            key_id: process.env.RAZORPAY_KEY_ID,\n            key_secret: process.env.RAZORPAY_KEY_SECRET\n        });\n    }\n    return razorpayInstance;\n}\nfunction isRazorpayConfigured() {\n    return process.env.RAZORPAY_KEY_ID && process.env.RAZORPAY_KEY_SECRET && !process.env.RAZORPAY_KEY_ID.includes(\"YOUR_KEY\");\n}\nfunction verifyPaymentSignature(orderId, paymentId, signature) {\n    if (!process.env.RAZORPAY_KEY_SECRET) {\n        throw new Error(\"Razorpay key secret not configured\");\n    }\n    const body = `${orderId}|${paymentId}`;\n    const expectedSignature = crypto__WEBPACK_IMPORTED_MODULE_1___default().createHmac(\"sha256\", process.env.RAZORPAY_KEY_SECRET).update(body).digest(\"hex\");\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().timingSafeEqual(Buffer.from(expectedSignature), Buffer.from(signature));\n}\nfunction verifyWebhookSignature(body, signature) {\n    if (!process.env.RAZORPAY_WEBHOOK_SECRET) {\n        throw new Error(\"Razorpay webhook secret not configured\");\n    }\n    const expectedSignature = crypto__WEBPACK_IMPORTED_MODULE_1___default().createHmac(\"sha256\", process.env.RAZORPAY_WEBHOOK_SECRET).update(body).digest(\"hex\");\n    return expectedSignature === signature;\n}\nasync function createOrder(amount, currency = \"INR\", receipt, notes = {}) {\n    const razorpay = getRazorpay();\n    if (!razorpay) {\n        throw new Error(\"Razorpay is not configured\");\n    }\n    return await razorpay.orders.create({\n        amount: Math.round(amount * 100),\n        currency,\n        receipt,\n        notes\n    });\n}\nasync function fetchPayment(paymentId) {\n    const razorpay = getRazorpay();\n    if (!razorpay) {\n        throw new Error(\"Razorpay is not configured\");\n    }\n    return await razorpay.payments.fetch(paymentId);\n}\nasync function refundPayment(paymentId, amount = null) {\n    const razorpay = getRazorpay();\n    if (!razorpay) {\n        throw new Error(\"Razorpay is not configured\");\n    }\n    const refundOptions = {\n        payment_id: paymentId\n    };\n    if (amount) {\n        refundOptions.amount = Math.round(amount * 100);\n    }\n    return await razorpay.refunds.create(refundOptions);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1IsU0FBUztJQUM3QztJQUVBLE9BQU8sTUFBTUksU0FBU1csT0FBTyxDQUFDVCxNQUFNLENBQUNPO0FBQ3ZDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLW1vbmdvLXRlbXBsYXRlLy4vbGliL3Jhem9ycGF5LmpzP2I0NDMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gUmF6b3JwYXkgSW50ZWdyYXRpb24gZm9yIFdyaXRlcidzIFBvY2tldFxuaW1wb3J0IFJhem9ycGF5IGZyb20gJ3Jhem9ycGF5JztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuLy8gSW5pdGlhbGl6ZSBSYXpvcnBheSBpbnN0YW5jZVxubGV0IHJhem9ycGF5SW5zdGFuY2UgPSBudWxsO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmF6b3JwYXkoKSB7XG4gIGlmICghcHJvY2Vzcy5lbnYuUkFaT1JQQVlfS0VZX0lEIHx8ICFwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfU0VDUkVUKSB7XG4gICAgY29uc29sZS53YXJuKCdSYXpvcnBheSBrZXlzIG5vdCBjb25maWd1cmVkLiBQYXltZW50IGZlYXR1cmVzIHdpbGwgYmUgZGlzYWJsZWQuJyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAocHJvY2Vzcy5lbnYuUkFaT1JQQVlfS0VZX0lELmluY2x1ZGVzKCdZT1VSX0tFWScpKSB7XG4gICAgY29uc29sZS53YXJuKCdSYXpvcnBheSBrZXlzIGFyZSBwbGFjZWhvbGRlciB2YWx1ZXMuIFBheW1lbnQgZmVhdHVyZXMgd2lsbCBiZSBkaXNhYmxlZC4nKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGlmICghcmF6b3JwYXlJbnN0YW5jZSkge1xuICAgIHJhem9ycGF5SW5zdGFuY2UgPSBuZXcgUmF6b3JwYXkoe1xuICAgICAga2V5X2lkOiBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfSUQsXG4gICAgICBrZXlfc2VjcmV0OiBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfU0VDUkVULFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJhem9ycGF5SW5zdGFuY2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Jhem9ycGF5Q29uZmlndXJlZCgpIHtcbiAgcmV0dXJuIChcbiAgICBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfSUQgJiZcbiAgICBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfU0VDUkVUICYmXG4gICAgIXByb2Nlc3MuZW52LlJBWk9SUEFZX0tFWV9JRC5pbmNsdWRlcygnWU9VUl9LRVknKVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5UGF5bWVudFNpZ25hdHVyZShvcmRlcklkLCBwYXltZW50SWQsIHNpZ25hdHVyZSkge1xuICBpZiAoIXByb2Nlc3MuZW52LlJBWk9SUEFZX0tFWV9TRUNSRVQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jhem9ycGF5IGtleSBzZWNyZXQgbm90IGNvbmZpZ3VyZWQnKTtcbiAgfVxuXG4gIGNvbnN0IGJvZHkgPSBgJHtvcmRlcklkfXwke3BheW1lbnRJZH1gO1xuICBjb25zdCBleHBlY3RlZFNpZ25hdHVyZSA9IGNyeXB0b1xuICAgIC5jcmVhdGVIbWFjKCdzaGEyNTYnLCBwcm9jZXNzLmVudi5SQVpPUlBBWV9LRVlfU0VDUkVUKVxuICAgIC51cGRhdGUoYm9keSlcbiAgICAuZGlnZXN0KCdoZXgnKTtcblxuICByZXR1cm4gY3J5cHRvLnRpbWluZ1NhZmVFcXVhbChcbiAgICBCdWZmZXIuZnJvbShleHBlY3RlZFNpZ25hdHVyZSksXG4gICAgQnVmZmVyLmZyb20oc2lnbmF0dXJlKVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5V2ViaG9va1NpZ25hdHVyZShib2R5LCBzaWduYXR1cmUpIHtcbiAgaWYgKCFwcm9jZXNzLmVudi5SQVpPUlBBWV9XRUJIT09LX1NFQ1JFVCkge1xuICAgIHRocm93IG5ldyBFcnJvcignUmF6b3JwYXkgd2ViaG9vayBzZWNyZXQgbm90IGNvbmZpZ3VyZWQnKTtcbiAgfVxuXG4gIGNvbnN0IGV4cGVjdGVkU2lnbmF0dXJlID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhtYWMoJ3NoYTI1NicsIHByb2Nlc3MuZW52LlJBWk9SUEFZX1dFQkhPT0tfU0VDUkVUKVxuICAgIC51cGRhdGUoYm9keSlcbiAgICAuZGlnZXN0KCdoZXgnKTtcblxuICByZXR1cm4gZXhwZWN0ZWRTaWduYXR1cmUgPT09IHNpZ25hdHVyZTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU9yZGVyKGFtb3VudCwgY3VycmVuY3kgPSAnSU5SJywgcmVjZWlwdCwgbm90ZXMgPSB7fSkge1xuICBjb25zdCByYXpvcnBheSA9IGdldFJhem9ycGF5KCk7XG4gIGlmICghcmF6b3JwYXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jhem9ycGF5IGlzIG5vdCBjb25maWd1cmVkJyk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcmF6b3JwYXkub3JkZXJzLmNyZWF0ZSh7XG4gICAgYW1vdW50OiBNYXRoLnJvdW5kKGFtb3VudCAqIDEwMCksIC8vIENvbnZlcnQgdG8gcGFpc2VcbiAgICBjdXJyZW5jeSxcbiAgICByZWNlaXB0LFxuICAgIG5vdGVzLFxuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoUGF5bWVudChwYXltZW50SWQpIHtcbiAgY29uc3QgcmF6b3JwYXkgPSBnZXRSYXpvcnBheSgpO1xuICBpZiAoIXJhem9ycGF5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdSYXpvcnBheSBpcyBub3QgY29uZmlndXJlZCcpO1xuICB9XG5cbiAgcmV0dXJuIGF3YWl0IHJhem9ycGF5LnBheW1lbnRzLmZldGNoKHBheW1lbnRJZCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWZ1bmRQYXltZW50KHBheW1lbnRJZCwgYW1vdW50ID0gbnVsbCkge1xuICBjb25zdCByYXpvcnBheSA9IGdldFJhem9ycGF5KCk7XG4gIGlmICghcmF6b3JwYXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jhem9ycGF5IGlzIG5vdCBjb25maWd1cmVkJyk7XG4gIH1cblxuICBjb25zdCByZWZ1bmRPcHRpb25zID0geyBwYXltZW50X2lkOiBwYXltZW50SWQgfTtcbiAgaWYgKGFtb3VudCkge1xuICAgIHJlZnVuZE9wdGlvbnMuYW1vdW50ID0gTWF0aC5yb3VuZChhbW91bnQgKiAxMDApO1xuICB9XG5cbiAgcmV0dXJuIGF3YWl0IHJhem9ycGF5LnJlZnVuZHMuY3JlYXRlKHJlZnVuZE9wdGlvbnMpO1xufVxuIl0sIm5hbWVzIjpbIlJhem9ycGF5IiwiY3J5cHRvIiwicmF6b3JwYXlJbnN0YW5jZSIsImdldFJhem9ycGF5IiwicHJvY2VzcyIsImVudiIsIlJBWk9SUEFZX0tFWV9JRCIsIlJBWk9SUEFZX0tFWV9TRUNSRVQiLCJjb25zb2xlIiwid2FybiIsImluY2x1ZGVzIiwia2V5X2lkIiwia2V5X3NlY3JldCIsImlzUmF6b3JwYXlDb25maWd1cmVkIiwidmVyaWZ5UGF5bWVudFNpZ25hdHVyZSIsIm9yZGVySWQiLCJwYXltZW50SWQiLCJzaWduYXR1cmUiLCJFcnJvciIsImJvZHkiLCJleHBlY3RlZFNpZ25hdHVyZSIsImNyZWF0ZUhtYWMiLCJ1cGRhdGUiLCJkaWdlc3QiLCJ0aW1pbmdTYWZlRXF1YWwiLCJCdWZmZXIiLCJmcm9tIiwidmVyaWZ5V2ViaG9va1NpZ25hdHVyZSIsIlJBWk9SUEFZX1dFQkhPT0tfU0VDUkVUIiwiY3JlYXRlT3JkZXIiLCJhbW91bnQiLCJjdXJyZW5jeSIsInJlY2VpcHQiLCJub3RlcyIsInJhem9ycGF5Iiwib3JkZXJzIiwiY3JlYXRlIiwiTWF0aCIsInJvdW5kIiwiZmV0Y2hQYXltZW50IiwicGF5bWVudHMiLCJmZXRjaCIsInJlZnVuZFBheW1lbnQiLCJyZWZ1bmRPcHRpb25zIiwicGF5bWVudF9pZCIsInJlZnVuZHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/razorpay.js\n");

/***/ }),

/***/ "(rsc)/./lib/site-settings.js":
/*!******************************!*\
  !*** ./lib/site-settings.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDefaultSettings: () => (/* binding */ getDefaultSettings),\n/* harmony export */   getSetting: () => (/* binding */ getSetting),\n/* harmony export */   getSettings: () => (/* binding */ getSettings),\n/* harmony export */   getSettingsByCategory: () => (/* binding */ getSettingsByCategory),\n/* harmony export */   setSetting: () => (/* binding */ setSetting),\n/* harmony export */   setSettings: () => (/* binding */ setSettings)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/prisma.js\");\n// Site Settings Helper for Writer's Pocket\n\n// Default settings\nconst DEFAULT_SETTINGS = {\n    // Homepage settings\n    \"homepage.show_recent_releases\": true,\n    \"homepage.show_best_sellers\": true,\n    \"homepage.best_sellers_mode\": \"auto\",\n    \"homepage.show_live_counter\": true,\n    \"homepage.publishing_steps\": [\n        \"Manuscript Upload\",\n        \"Initial Review\",\n        \"Professional Editing\",\n        \"Cover Design\",\n        \"Interior Formatting\",\n        \"ISBN Assignment\",\n        \"Distribution\"\n    ],\n    // Free Publishing settings\n    \"free_publishing.processing_fee\": 999,\n    \"free_publishing.original_fee\": 1499,\n    \"free_publishing.show_discount\": true,\n    \"free_publishing.signup_mode\": \"lead\",\n    \"free_publishing.whatsapp_enabled\": true,\n    \"free_publishing.whatsapp_number\": \"+919876543210\",\n    \"free_publishing.whatsapp_text\": \"Chat with us\",\n    // Writing Challenge settings\n    \"writing_challenge.fee\": 1999,\n    \"writing_challenge.original_fee\": 2999,\n    \"writing_challenge.show_discount\": true,\n    \"writing_challenge.duration_days\": 45,\n    \"writing_challenge.min_submissions\": 30,\n    \"writing_challenge.prompts_count\": 50,\n    // Shop settings\n    \"shop.default_shipping_days\": \"5-7\",\n    \"shop.shipping_message\": \"Standard delivery: 5-7 days\",\n    // General settings\n    \"general.site_name\": \"Writer's Pocket\",\n    \"general.tagline\": \"Your Story Deserves To Be Published\",\n    \"general.contact_email\": \"support@writerspocket.com\",\n    \"general.contact_phone\": \"+91 98765 43210\",\n    \"general.logo_url\": null,\n    \"general.favicon_url\": null\n};\n// Get a setting value\nasync function getSetting(key) {\n    try {\n        const setting = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].siteSetting.findUnique({\n            where: {\n                key\n            }\n        });\n        if (setting) {\n            return setting.value;\n        }\n        // Return default if exists\n        return DEFAULT_SETTINGS[key] ?? null;\n    } catch (error) {\n        console.error(\"Error getting setting:\", key, error);\n        return DEFAULT_SETTINGS[key] ?? null;\n    }\n}\n// Get multiple settings\nasync function getSettings(keys) {\n    try {\n        const settings = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].siteSetting.findMany({\n            where: {\n                key: {\n                    in: keys\n                }\n            }\n        });\n        const result = {};\n        keys.forEach((key)=>{\n            const found = settings.find((s)=>s.key === key);\n            result[key] = found ? found.value : DEFAULT_SETTINGS[key] ?? null;\n        });\n        return result;\n    } catch (error) {\n        console.error(\"Error getting settings:\", error);\n        const result = {};\n        keys.forEach((key)=>{\n            result[key] = DEFAULT_SETTINGS[key] ?? null;\n        });\n        return result;\n    }\n}\n// Get all settings for a category\nasync function getSettingsByCategory(category) {\n    try {\n        const settings = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].siteSetting.findMany({\n            where: {\n                category\n            }\n        });\n        // Merge with defaults\n        const result = {};\n        Object.entries(DEFAULT_SETTINGS).forEach(([key, value])=>{\n            if (key.startsWith(category + \".\")) {\n                result[key] = value;\n            }\n        });\n        settings.forEach((s)=>{\n            result[s.key] = s.value;\n        });\n        return result;\n    } catch (error) {\n        console.error(\"Error getting settings by category:\", error);\n        const result = {};\n        Object.entries(DEFAULT_SETTINGS).forEach(([key, value])=>{\n            if (key.startsWith(category + \".\")) {\n                result[key] = value;\n            }\n        });\n        return result;\n    }\n}\n// Set a setting value\nasync function setSetting(key, value, category = null) {\n    try {\n        const setting = await _prisma__WEBPACK_IMPORTED_MODULE_0__[\"default\"].siteSetting.upsert({\n            where: {\n                key\n            },\n            create: {\n                key,\n                value,\n                category: category || key.split(\".\")[0]\n            },\n            update: {\n                value,\n                category: category || key.split(\".\")[0]\n            }\n        });\n        return setting;\n    } catch (error) {\n        console.error(\"Error setting value:\", key, error);\n        throw error;\n    }\n}\n// Set multiple settings\nasync function setSettings(settings) {\n    const results = [];\n    for (const [key, value] of Object.entries(settings)){\n        const result = await setSetting(key, value);\n        results.push(result);\n    }\n    return results;\n}\n// Get default settings (for initialization)\nfunction getDefaultSettings() {\n    return {\n        ...DEFAULT_SETTINGS\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2l0ZS1zZXR0aW5ncy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsMkNBQTJDO0FBRWI7QUFFOUIsbUJBQW1CO0FBQ25CLE1BQU1DLG1CQUFtQjtJQUN2QixvQkFBb0I7SUFDcEIsaUNBQWlDO0lBQ2pDLDhCQUE4QjtJQUM5Qiw4QkFBOEI7SUFDOUIsOEJBQThCO0lBQzlCLDZCQUE2QjtRQUMzQjtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBRUQsMkJBQTJCO0lBQzNCLGtDQUFrQztJQUNsQyxnQ0FBZ0M7SUFDaEMsaUNBQWlDO0lBQ2pDLCtCQUErQjtJQUMvQixvQ0FBb0M7SUFDcEMsbUNBQW1DO0lBQ25DLGlDQUFpQztJQUVqQyw2QkFBNkI7SUFDN0IseUJBQXlCO0lBQ3pCLGtDQUFrQztJQUNsQyxtQ0FBbUM7SUFDbkMsbUNBQW1DO0lBQ25DLHFDQUFxQztJQUNyQyxtQ0FBbUM7SUFFbkMsZ0JBQWdCO0lBQ2hCLDhCQUE4QjtJQUM5Qix5QkFBeUI7SUFFekIsbUJBQW1CO0lBQ25CLHFCQUFxQjtJQUNyQixtQkFBbUI7SUFDbkIseUJBQXlCO0lBQ3pCLHlCQUF5QjtJQUN6QixvQkFBb0I7SUFDcEIsdUJBQXVCO0FBQ3pCO0FBRUEsc0JBQXNCO0FBQ2YsZUFBZUMsV0FBV0MsR0FBRztJQUNsQyxJQUFJO1FBQ0YsTUFBTUMsVUFBVSxNQUFNSiwrQ0FBTUEsQ0FBQ0ssV0FBVyxDQUFDQyxVQUFVLENBQUM7WUFDbERDLE9BQU87Z0JBQUVKO1lBQUk7UUFDZjtRQUVBLElBQUlDLFNBQVM7WUFDWCxPQUFPQSxRQUFRSSxLQUFLO1FBQ3RCO1FBRUEsMkJBQTJCO1FBQzNCLE9BQU9QLGdCQUFnQixDQUFDRSxJQUFJLElBQUk7SUFDbEMsRUFBRSxPQUFPTSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQywwQkFBMEJOLEtBQUtNO1FBQzdDLE9BQU9SLGdCQUFnQixDQUFDRSxJQUFJLElBQUk7SUFDbEM7QUFDRjtBQUVBLHdCQUF3QjtBQUNqQixlQUFlUSxZQUFZQyxJQUFJO0lBQ3BDLElBQUk7UUFDRixNQUFNQyxXQUFXLE1BQU1iLCtDQUFNQSxDQUFDSyxXQUFXLENBQUNTLFFBQVEsQ0FBQztZQUNqRFAsT0FBTztnQkFBRUosS0FBSztvQkFBRVksSUFBSUg7Z0JBQUs7WUFBRTtRQUM3QjtRQUVBLE1BQU1JLFNBQVMsQ0FBQztRQUNoQkosS0FBS0ssT0FBTyxDQUFDZCxDQUFBQTtZQUNYLE1BQU1lLFFBQVFMLFNBQVNNLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRWpCLEdBQUcsS0FBS0E7WUFDM0NhLE1BQU0sQ0FBQ2IsSUFBSSxHQUFHZSxRQUFRQSxNQUFNVixLQUFLLEdBQUlQLGdCQUFnQixDQUFDRSxJQUFJLElBQUk7UUFDaEU7UUFFQSxPQUFPYTtJQUNULEVBQUUsT0FBT1AsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMkJBQTJCQTtRQUN6QyxNQUFNTyxTQUFTLENBQUM7UUFDaEJKLEtBQUtLLE9BQU8sQ0FBQ2QsQ0FBQUE7WUFDWGEsTUFBTSxDQUFDYixJQUFJLEdBQUdGLGdCQUFnQixDQUFDRSxJQUFJLElBQUk7UUFDekM7UUFDQSxPQUFPYTtJQUNUO0FBQ0Y7QUFFQSxrQ0FBa0M7QUFDM0IsZUFBZUssc0JBQXNCQyxRQUFRO0lBQ2xELElBQUk7UUFDRixNQUFNVCxXQUFXLE1BQU1iLCtDQUFNQSxDQUFDSyxXQUFXLENBQUNTLFFBQVEsQ0FBQztZQUNqRFAsT0FBTztnQkFBRWU7WUFBUztRQUNwQjtRQUVBLHNCQUFzQjtRQUN0QixNQUFNTixTQUFTLENBQUM7UUFDaEJPLE9BQU9DLE9BQU8sQ0FBQ3ZCLGtCQUFrQmdCLE9BQU8sQ0FBQyxDQUFDLENBQUNkLEtBQUtLLE1BQU07WUFDcEQsSUFBSUwsSUFBSXNCLFVBQVUsQ0FBQ0gsV0FBVyxNQUFNO2dCQUNsQ04sTUFBTSxDQUFDYixJQUFJLEdBQUdLO1lBQ2hCO1FBQ0Y7UUFFQUssU0FBU0ksT0FBTyxDQUFDRyxDQUFBQTtZQUNmSixNQUFNLENBQUNJLEVBQUVqQixHQUFHLENBQUMsR0FBR2lCLEVBQUVaLEtBQUs7UUFDekI7UUFFQSxPQUFPUTtJQUNULEVBQUUsT0FBT1AsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsdUNBQXVDQTtRQUNyRCxNQUFNTyxTQUFTLENBQUM7UUFDaEJPLE9BQU9DLE9BQU8sQ0FBQ3ZCLGtCQUFrQmdCLE9BQU8sQ0FBQyxDQUFDLENBQUNkLEtBQUtLLE1BQU07WUFDcEQsSUFBSUwsSUFBSXNCLFVBQVUsQ0FBQ0gsV0FBVyxNQUFNO2dCQUNsQ04sTUFBTSxDQUFDYixJQUFJLEdBQUdLO1lBQ2hCO1FBQ0Y7UUFDQSxPQUFPUTtJQUNUO0FBQ0Y7QUFFQSxzQkFBc0I7QUFDZixlQUFlVSxXQUFXdkIsR0FBRyxFQUFFSyxLQUFLLEVBQUVjLFdBQVcsSUFBSTtJQUMxRCxJQUFJO1FBQ0YsTUFBTWxCLFVBQVUsTUFBTUosK0NBQU1BLENBQUNLLFdBQVcsQ0FBQ3NCLE1BQU0sQ0FBQztZQUM5Q3BCLE9BQU87Z0JBQUVKO1lBQUk7WUFDYnlCLFFBQVE7Z0JBQ056QjtnQkFDQUs7Z0JBQ0FjLFVBQVVBLFlBQVluQixJQUFJMEIsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3pDO1lBQ0FDLFFBQVE7Z0JBQ050QjtnQkFDQWMsVUFBVUEsWUFBWW5CLElBQUkwQixLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDekM7UUFDRjtRQUVBLE9BQU96QjtJQUNULEVBQUUsT0FBT0ssT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsd0JBQXdCTixLQUFLTTtRQUMzQyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSx3QkFBd0I7QUFDakIsZUFBZXNCLFlBQVlsQixRQUFRO0lBQ3hDLE1BQU1tQixVQUFVLEVBQUU7SUFDbEIsS0FBSyxNQUFNLENBQUM3QixLQUFLSyxNQUFNLElBQUllLE9BQU9DLE9BQU8sQ0FBQ1gsVUFBVztRQUNuRCxNQUFNRyxTQUFTLE1BQU1VLFdBQVd2QixLQUFLSztRQUNyQ3dCLFFBQVFDLElBQUksQ0FBQ2pCO0lBQ2Y7SUFDQSxPQUFPZ0I7QUFDVDtBQUVBLDRDQUE0QztBQUNyQyxTQUFTRTtJQUNkLE9BQU87UUFBRSxHQUFHakMsZ0JBQWdCO0lBQUM7QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtbW9uZ28tdGVtcGxhdGUvLi9saWIvc2l0ZS1zZXR0aW5ncy5qcz84YjA3Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNpdGUgU2V0dGluZ3MgSGVscGVyIGZvciBXcml0ZXIncyBQb2NrZXRcblxuaW1wb3J0IHByaXNtYSBmcm9tICcuL3ByaXNtYSc7XG5cbi8vIERlZmF1bHQgc2V0dGluZ3NcbmNvbnN0IERFRkFVTFRfU0VUVElOR1MgPSB7XG4gIC8vIEhvbWVwYWdlIHNldHRpbmdzXG4gICdob21lcGFnZS5zaG93X3JlY2VudF9yZWxlYXNlcyc6IHRydWUsXG4gICdob21lcGFnZS5zaG93X2Jlc3Rfc2VsbGVycyc6IHRydWUsXG4gICdob21lcGFnZS5iZXN0X3NlbGxlcnNfbW9kZSc6ICdhdXRvJywgLy8gJ2F1dG8nIG9yICdtYW51YWwnXG4gICdob21lcGFnZS5zaG93X2xpdmVfY291bnRlcic6IHRydWUsXG4gICdob21lcGFnZS5wdWJsaXNoaW5nX3N0ZXBzJzogW1xuICAgICdNYW51c2NyaXB0IFVwbG9hZCcsXG4gICAgJ0luaXRpYWwgUmV2aWV3JyxcbiAgICAnUHJvZmVzc2lvbmFsIEVkaXRpbmcnLFxuICAgICdDb3ZlciBEZXNpZ24nLFxuICAgICdJbnRlcmlvciBGb3JtYXR0aW5nJyxcbiAgICAnSVNCTiBBc3NpZ25tZW50JyxcbiAgICAnRGlzdHJpYnV0aW9uJyxcbiAgXSxcbiAgXG4gIC8vIEZyZWUgUHVibGlzaGluZyBzZXR0aW5nc1xuICAnZnJlZV9wdWJsaXNoaW5nLnByb2Nlc3NpbmdfZmVlJzogOTk5LFxuICAnZnJlZV9wdWJsaXNoaW5nLm9yaWdpbmFsX2ZlZSc6IDE0OTksXG4gICdmcmVlX3B1Ymxpc2hpbmcuc2hvd19kaXNjb3VudCc6IHRydWUsXG4gICdmcmVlX3B1Ymxpc2hpbmcuc2lnbnVwX21vZGUnOiAnbGVhZCcsIC8vICdsZWFkJyBvciAncGF5bWVudCdcbiAgJ2ZyZWVfcHVibGlzaGluZy53aGF0c2FwcF9lbmFibGVkJzogdHJ1ZSxcbiAgJ2ZyZWVfcHVibGlzaGluZy53aGF0c2FwcF9udW1iZXInOiAnKzkxOTg3NjU0MzIxMCcsXG4gICdmcmVlX3B1Ymxpc2hpbmcud2hhdHNhcHBfdGV4dCc6ICdDaGF0IHdpdGggdXMnLFxuICBcbiAgLy8gV3JpdGluZyBDaGFsbGVuZ2Ugc2V0dGluZ3NcbiAgJ3dyaXRpbmdfY2hhbGxlbmdlLmZlZSc6IDE5OTksXG4gICd3cml0aW5nX2NoYWxsZW5nZS5vcmlnaW5hbF9mZWUnOiAyOTk5LFxuICAnd3JpdGluZ19jaGFsbGVuZ2Uuc2hvd19kaXNjb3VudCc6IHRydWUsXG4gICd3cml0aW5nX2NoYWxsZW5nZS5kdXJhdGlvbl9kYXlzJzogNDUsXG4gICd3cml0aW5nX2NoYWxsZW5nZS5taW5fc3VibWlzc2lvbnMnOiAzMCxcbiAgJ3dyaXRpbmdfY2hhbGxlbmdlLnByb21wdHNfY291bnQnOiA1MCxcbiAgXG4gIC8vIFNob3Agc2V0dGluZ3NcbiAgJ3Nob3AuZGVmYXVsdF9zaGlwcGluZ19kYXlzJzogJzUtNycsXG4gICdzaG9wLnNoaXBwaW5nX21lc3NhZ2UnOiAnU3RhbmRhcmQgZGVsaXZlcnk6IDUtNyBkYXlzJyxcbiAgXG4gIC8vIEdlbmVyYWwgc2V0dGluZ3NcbiAgJ2dlbmVyYWwuc2l0ZV9uYW1lJzogXCJXcml0ZXIncyBQb2NrZXRcIixcbiAgJ2dlbmVyYWwudGFnbGluZSc6ICdZb3VyIFN0b3J5IERlc2VydmVzIFRvIEJlIFB1Ymxpc2hlZCcsXG4gICdnZW5lcmFsLmNvbnRhY3RfZW1haWwnOiAnc3VwcG9ydEB3cml0ZXJzcG9ja2V0LmNvbScsXG4gICdnZW5lcmFsLmNvbnRhY3RfcGhvbmUnOiAnKzkxIDk4NzY1IDQzMjEwJyxcbiAgJ2dlbmVyYWwubG9nb191cmwnOiBudWxsLFxuICAnZ2VuZXJhbC5mYXZpY29uX3VybCc6IG51bGwsXG59O1xuXG4vLyBHZXQgYSBzZXR0aW5nIHZhbHVlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2V0dGluZyhrZXkpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzZXR0aW5nID0gYXdhaXQgcHJpc21hLnNpdGVTZXR0aW5nLmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsga2V5IH0sXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKHNldHRpbmcpIHtcbiAgICAgIHJldHVybiBzZXR0aW5nLnZhbHVlO1xuICAgIH1cbiAgICBcbiAgICAvLyBSZXR1cm4gZGVmYXVsdCBpZiBleGlzdHNcbiAgICByZXR1cm4gREVGQVVMVF9TRVRUSU5HU1trZXldID8/IG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBzZXR0aW5nOicsIGtleSwgZXJyb3IpO1xuICAgIHJldHVybiBERUZBVUxUX1NFVFRJTkdTW2tleV0gPz8gbnVsbDtcbiAgfVxufVxuXG4vLyBHZXQgbXVsdGlwbGUgc2V0dGluZ3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXR0aW5ncyhrZXlzKSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2V0dGluZ3MgPSBhd2FpdCBwcmlzbWEuc2l0ZVNldHRpbmcuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHsga2V5OiB7IGluOiBrZXlzIH0gfSxcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBrZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGNvbnN0IGZvdW5kID0gc2V0dGluZ3MuZmluZChzID0+IHMua2V5ID09PSBrZXkpO1xuICAgICAgcmVzdWx0W2tleV0gPSBmb3VuZCA/IGZvdW5kLnZhbHVlIDogKERFRkFVTFRfU0VUVElOR1Nba2V5XSA/PyBudWxsKTtcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgc2V0dGluZ3M6JywgZXJyb3IpO1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgcmVzdWx0W2tleV0gPSBERUZBVUxUX1NFVFRJTkdTW2tleV0gPz8gbnVsbDtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG5cbi8vIEdldCBhbGwgc2V0dGluZ3MgZm9yIGEgY2F0ZWdvcnlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXR0aW5nc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IHByaXNtYS5zaXRlU2V0dGluZy5maW5kTWFueSh7XG4gICAgICB3aGVyZTogeyBjYXRlZ29yeSB9LFxuICAgIH0pO1xuICAgIFxuICAgIC8vIE1lcmdlIHdpdGggZGVmYXVsdHNcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBPYmplY3QuZW50cmllcyhERUZBVUxUX1NFVFRJTkdTKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmIChrZXkuc3RhcnRzV2l0aChjYXRlZ29yeSArICcuJykpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBzZXR0aW5ncy5mb3JFYWNoKHMgPT4ge1xuICAgICAgcmVzdWx0W3Mua2V5XSA9IHMudmFsdWU7XG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHNldHRpbmdzIGJ5IGNhdGVnb3J5OicsIGVycm9yKTtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBPYmplY3QuZW50cmllcyhERUZBVUxUX1NFVFRJTkdTKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmIChrZXkuc3RhcnRzV2l0aChjYXRlZ29yeSArICcuJykpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG5cbi8vIFNldCBhIHNldHRpbmcgdmFsdWVcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTZXR0aW5nKGtleSwgdmFsdWUsIGNhdGVnb3J5ID0gbnVsbCkge1xuICB0cnkge1xuICAgIGNvbnN0IHNldHRpbmcgPSBhd2FpdCBwcmlzbWEuc2l0ZVNldHRpbmcudXBzZXJ0KHtcbiAgICAgIHdoZXJlOiB7IGtleSB9LFxuICAgICAgY3JlYXRlOiB7XG4gICAgICAgIGtleSxcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSB8fCBrZXkuc3BsaXQoJy4nKVswXSxcbiAgICAgIH0sXG4gICAgICB1cGRhdGU6IHtcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSB8fCBrZXkuc3BsaXQoJy4nKVswXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIHNldHRpbmc7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc2V0dGluZyB2YWx1ZTonLCBrZXksIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyBTZXQgbXVsdGlwbGUgc2V0dGluZ3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTZXR0aW5ncyhzZXR0aW5ncykge1xuICBjb25zdCByZXN1bHRzID0gW107XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHNldHRpbmdzKSkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNldFNldHRpbmcoa2V5LCB2YWx1ZSk7XG4gICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbi8vIEdldCBkZWZhdWx0IHNldHRpbmdzIChmb3IgaW5pdGlhbGl6YXRpb24pXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdFNldHRpbmdzKCkge1xuICByZXR1cm4geyAuLi5ERUZBVUxUX1NFVFRJTkdTIH07XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiREVGQVVMVF9TRVRUSU5HUyIsImdldFNldHRpbmciLCJrZXkiLCJzZXR0aW5nIiwic2l0ZVNldHRpbmciLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJ2YWx1ZSIsImVycm9yIiwiY29uc29sZSIsImdldFNldHRpbmdzIiwia2V5cyIsInNldHRpbmdzIiwiZmluZE1hbnkiLCJpbiIsInJlc3VsdCIsImZvckVhY2giLCJmb3VuZCIsImZpbmQiLCJzIiwiZ2V0U2V0dGluZ3NCeUNhdGVnb3J5IiwiY2F0ZWdvcnkiLCJPYmplY3QiLCJlbnRyaWVzIiwic3RhcnRzV2l0aCIsInNldFNldHRpbmciLCJ1cHNlcnQiLCJjcmVhdGUiLCJzcGxpdCIsInVwZGF0ZSIsInNldFNldHRpbmdzIiwicmVzdWx0cyIsInB1c2giLCJnZXREZWZhdWx0U2V0dGluZ3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/site-settings.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jose","vendor-chunks/next-auth","vendor-chunks/razorpay","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/uuid","vendor-chunks/call-bind-apply-helpers","vendor-chunks/@prisma","vendor-chunks/@panva","vendor-chunks/get-proto","vendor-chunks/preact","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/preact-render-to-string","vendor-chunks/oauth4webapi","vendor-chunks/bcryptjs","vendor-chunks/axios","vendor-chunks/proxy-from-env","vendor-chunks/postgres-array","vendor-chunks/mime-types","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2F%5B%5B...path%5D%5D%2Froute&page=%2Fapi%2F%5B%5B...path%5D%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2F%5B%5B...path%5D%5D%2Froute.js&appDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohitwadhwa%2FDownloads%2Fwriters-pocket-source&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();